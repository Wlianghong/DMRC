PEMS04
--------- DMRCMLP ---------
{
    "num_nodes": 307,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0005,
    "milestones": [
        20,
        35,
        55
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 150,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 20436023,
    "gpu": [
        1
    ],
    "save": false,
    "model_args": {
        "num_nodes": 307,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        390,540
├─Linear: 1-1                                 [16, 12, 307, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 307, 48]         --
│    └─Embedding: 2-1                         [16, 12, 307, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 307, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 307, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 307, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 307, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 307, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 307, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 307, 144]        158,224
├─Predictor: 1-4                              [16, 12, 307, 1]          --
│    └─Linear: 2-5                            [16, 12, 307, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 307, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 307, 144]        41,760
│    └─Linear: 2-7                            [16, 307, 12]             20,748
===============================================================================================
Total params: 1,155,712
Trainable params: 1,155,712
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 0.71
Forward/backward pass size (MB): 2758.11
Params size (MB): 3.06
Estimated Total Size (MB): 2761.88
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS04-2025-01-17-15-41-18.pt
2025-01-17 15:42:26.656690 Epoch 1, Train Y Loss = 29.03880,  Train X Loss = 0.00000, Val Loss = 24.09198
2025-01-17 15:43:34.988591 Epoch 2, Train Y Loss = 22.53728,  Train X Loss = 0.00000, Val Loss = 24.21607
2025-01-17 15:44:43.270695 Epoch 3, Train Y Loss = 21.40785,  Train X Loss = 0.00000, Val Loss = 23.06406
2025-01-17 15:45:51.662373 Epoch 4, Train Y Loss = 20.51522,  Train X Loss = 0.00000, Val Loss = 20.57813
2025-01-17 15:46:59.950091 Epoch 5, Train Y Loss = 19.85259,  Train X Loss = 0.00000, Val Loss = 20.88592
2025-01-17 15:48:08.319119 Epoch 6, Train Y Loss = 19.38138,  Train X Loss = 0.00000, Val Loss = 19.73023
2025-01-17 15:49:16.633499 Epoch 7, Train Y Loss = 19.08733,  Train X Loss = 0.00000, Val Loss = 19.71020
2025-01-17 15:50:25.030311 Epoch 8, Train Y Loss = 18.76062,  Train X Loss = 0.00000, Val Loss = 19.74728
2025-01-17 15:51:33.300241 Epoch 9, Train Y Loss = 18.46512,  Train X Loss = 0.00000, Val Loss = 19.36756
2025-01-17 15:52:41.703668 Epoch 10, Train Y Loss = 18.32168,  Train X Loss = 0.00000, Val Loss = 18.56561
2025-01-17 15:53:50.017711 Epoch 11, Train Y Loss = 18.00461,  Train X Loss = 0.00000, Val Loss = 18.65454
2025-01-17 15:54:58.435964 Epoch 12, Train Y Loss = 18.02783,  Train X Loss = 0.00000, Val Loss = 18.53977
2025-01-17 15:56:06.747708 Epoch 13, Train Y Loss = 17.79996,  Train X Loss = 0.00000, Val Loss = 18.50049
2025-01-17 15:57:15.197865 Epoch 14, Train Y Loss = 17.70411,  Train X Loss = 0.00000, Val Loss = 18.47009
2025-01-17 15:58:23.524457 Epoch 15, Train Y Loss = 17.63090,  Train X Loss = 0.00000, Val Loss = 18.43776
2025-01-17 15:59:31.960984 Epoch 16, Train Y Loss = 17.47082,  Train X Loss = 0.00000, Val Loss = 18.77249
2025-01-17 16:00:40.266906 Epoch 17, Train Y Loss = 17.43332,  Train X Loss = 0.00000, Val Loss = 19.10226
2025-01-17 16:01:48.709122 Epoch 18, Train Y Loss = 17.31837,  Train X Loss = 0.00000, Val Loss = 18.23781
2025-01-17 16:02:57.039052 Epoch 19, Train Y Loss = 17.28248,  Train X Loss = 0.00000, Val Loss = 18.43011
2025-01-17 16:04:05.421216 Epoch 20, Train Y Loss = 17.19530,  Train X Loss = 0.00000, Val Loss = 18.06572
2025-01-17 16:05:13.725395 Epoch 21, Train Y Loss = 16.59061,  Train X Loss = 0.00000, Val Loss = 17.72718
2025-01-17 16:06:22.110925 Epoch 22, Train Y Loss = 16.49414,  Train X Loss = 0.00000, Val Loss = 17.68985
2025-01-17 16:07:30.496454 Epoch 23, Train Y Loss = 16.45583,  Train X Loss = 0.00000, Val Loss = 17.69708
2025-01-17 16:08:38.863145 Epoch 24, Train Y Loss = 16.42914,  Train X Loss = 0.00000, Val Loss = 17.68821
2025-01-17 16:09:47.230393 Epoch 25, Train Y Loss = 16.39629,  Train X Loss = 0.00000, Val Loss = 17.72798
2025-01-17 16:10:55.574436 Epoch 26, Train Y Loss = 16.38002,  Train X Loss = 0.00000, Val Loss = 17.70491
2025-01-17 16:12:03.951362 Epoch 27, Train Y Loss = 16.35188,  Train X Loss = 0.00000, Val Loss = 17.67584
2025-01-17 16:13:12.221207 Epoch 28, Train Y Loss = 16.33192,  Train X Loss = 0.00000, Val Loss = 17.76451
2025-01-17 16:14:20.577106 Epoch 29, Train Y Loss = 16.31836,  Train X Loss = 0.00000, Val Loss = 17.73365
2025-01-17 16:15:28.843957 Epoch 30, Train Y Loss = 16.29198,  Train X Loss = 0.00000, Val Loss = 17.72705
2025-01-17 16:16:37.195634 Epoch 31, Train Y Loss = 16.26277,  Train X Loss = 0.00000, Val Loss = 17.75840
2025-01-17 16:17:45.433369 Epoch 32, Train Y Loss = 16.25062,  Train X Loss = 0.00000, Val Loss = 17.68468
2025-01-17 16:18:53.812142 Epoch 33, Train Y Loss = 16.23599,  Train X Loss = 0.00000, Val Loss = 17.76692
2025-01-17 16:20:02.086034 Epoch 34, Train Y Loss = 16.22651,  Train X Loss = 0.00000, Val Loss = 17.78508
2025-01-17 16:21:10.442544 Epoch 35, Train Y Loss = 16.20800,  Train X Loss = 0.00000, Val Loss = 17.78078
Change mask ratio: 0.075
2025-01-17 16:22:17.300604 Epoch 36, Train Y Loss = 16.06595,  Train X Loss = 0.00000, Val Loss = 17.65838
2025-01-17 16:23:24.271446 Epoch 37, Train Y Loss = 16.05392,  Train X Loss = 0.00000, Val Loss = 17.67631
2025-01-17 16:24:31.177222 Epoch 38, Train Y Loss = 16.04468,  Train X Loss = 0.00000, Val Loss = 17.66525
2025-01-17 16:25:38.141035 Epoch 39, Train Y Loss = 16.04893,  Train X Loss = 0.00000, Val Loss = 17.67449
2025-01-17 16:26:44.975583 Epoch 40, Train Y Loss = 16.04164,  Train X Loss = 0.00000, Val Loss = 17.68602
2025-01-17 16:27:51.905228 Epoch 41, Train Y Loss = 16.03932,  Train X Loss = 0.00000, Val Loss = 17.66608
2025-01-17 16:28:58.775049 Epoch 42, Train Y Loss = 16.03453,  Train X Loss = 0.00000, Val Loss = 17.68293
2025-01-17 16:30:05.692024 Epoch 43, Train Y Loss = 16.03636,  Train X Loss = 0.00000, Val Loss = 17.67659
2025-01-17 16:31:12.550782 Epoch 44, Train Y Loss = 16.03145,  Train X Loss = 0.00000, Val Loss = 17.67366
Change mask ratio: 0.0375
2025-01-17 16:32:18.884143 Epoch 45, Train Y Loss = 15.99530,  Train X Loss = 0.00000, Val Loss = 17.65945
2025-01-17 16:33:25.145633 Epoch 46, Train Y Loss = 15.98929,  Train X Loss = 0.00000, Val Loss = 17.67715
2025-01-17 16:34:31.469768 Epoch 47, Train Y Loss = 15.98986,  Train X Loss = 0.00000, Val Loss = 17.67216
2025-01-17 16:35:37.748900 Epoch 48, Train Y Loss = 15.98551,  Train X Loss = 0.00000, Val Loss = 17.66454
2025-01-17 16:36:44.090707 Epoch 49, Train Y Loss = 15.97998,  Train X Loss = 0.00000, Val Loss = 17.66384
2025-01-17 16:37:50.378994 Epoch 50, Train Y Loss = 15.98534,  Train X Loss = 0.00000, Val Loss = 17.68177
2025-01-17 16:38:56.728960 Epoch 51, Train Y Loss = 15.97493,  Train X Loss = 0.00000, Val Loss = 17.66947
2025-01-17 16:40:03.080000 Epoch 52, Train Y Loss = 15.97237,  Train X Loss = 0.00000, Val Loss = 17.66359
Change mask ratio: 0.0
2025-01-17 16:41:01.130994 Epoch 53, Train Y Loss = 15.94410,  Train X Loss = 0.00000, Val Loss = 17.65685
2025-01-17 16:41:59.276282 Epoch 54, Train Y Loss = 15.94246,  Train X Loss = 0.00000, Val Loss = 17.63808
2025-01-17 16:42:57.134183 Epoch 55, Train Y Loss = 15.94018,  Train X Loss = 0.00000, Val Loss = 17.67332
2025-01-17 16:43:55.080437 Epoch 56, Train Y Loss = 15.92879,  Train X Loss = 0.00000, Val Loss = 17.65493
2025-01-17 16:44:53.129435 Epoch 57, Train Y Loss = 15.92987,  Train X Loss = 0.00000, Val Loss = 17.65459
2025-01-17 16:45:51.084049 Epoch 58, Train Y Loss = 15.93330,  Train X Loss = 0.00000, Val Loss = 17.65289
2025-01-17 16:46:49.091463 Epoch 59, Train Y Loss = 15.92655,  Train X Loss = 0.00000, Val Loss = 17.65518
2025-01-17 16:47:47.081066 Epoch 60, Train Y Loss = 15.92625,  Train X Loss = 0.00000, Val Loss = 17.65592
2025-01-17 16:48:45.042784 Epoch 61, Train Y Loss = 15.92711,  Train X Loss = 0.00000, Val Loss = 17.65762
2025-01-17 16:49:43.024044 Epoch 62, Train Y Loss = 15.93039,  Train X Loss = 0.00000, Val Loss = 17.65639
Change mask ratio: 0.0
2025-01-17 16:50:40.949025 Epoch 63, Train Y Loss = 15.91913,  Train X Loss = 0.00000, Val Loss = 17.65505
2025-01-17 16:51:38.914424 Epoch 64, Train Y Loss = 15.92441,  Train X Loss = 0.00000, Val Loss = 17.65906
2025-01-17 16:52:36.825897 Epoch 65, Train Y Loss = 15.92212,  Train X Loss = 0.00000, Val Loss = 17.65762
2025-01-17 16:53:34.773435 Epoch 66, Train Y Loss = 15.91722,  Train X Loss = 0.00000, Val Loss = 17.64851
2025-01-17 16:54:32.709373 Epoch 67, Train Y Loss = 15.92581,  Train X Loss = 0.00000, Val Loss = 17.66124
2025-01-17 16:55:30.601568 Epoch 68, Train Y Loss = 15.92346,  Train X Loss = 0.00000, Val Loss = 17.65551
2025-01-17 16:56:28.537007 Epoch 69, Train Y Loss = 15.92156,  Train X Loss = 0.00000, Val Loss = 17.65566
2025-01-17 16:57:26.439609 Epoch 70, Train Y Loss = 15.92538,  Train X Loss = 0.00000, Val Loss = 17.65057
Change mask ratio: 0.0
2025-01-17 16:58:24.398376 Epoch 71, Train Y Loss = 15.91655,  Train X Loss = 0.00000, Val Loss = 17.65691
2025-01-17 16:59:22.257522 Epoch 72, Train Y Loss = 15.92323,  Train X Loss = 0.00000, Val Loss = 17.65752
2025-01-17 17:00:20.182745 Epoch 73, Train Y Loss = 15.92075,  Train X Loss = 0.00000, Val Loss = 17.66261
2025-01-17 17:01:17.890535 Epoch 74, Train Y Loss = 15.92326,  Train X Loss = 0.00000, Val Loss = 17.65802
2025-01-17 17:02:15.536877 Epoch 75, Train Y Loss = 15.92445,  Train X Loss = 0.00000, Val Loss = 17.65619
2025-01-17 17:03:13.535867 Epoch 76, Train Y Loss = 15.92283,  Train X Loss = 0.00000, Val Loss = 17.65647
2025-01-17 17:04:11.481144 Epoch 77, Train Y Loss = 15.91905,  Train X Loss = 0.00000, Val Loss = 17.66065
2025-01-17 17:05:09.600742 Epoch 78, Train Y Loss = 15.91995,  Train X Loss = 0.00000, Val Loss = 17.65603
Change mask ratio: 0.0
2025-01-17 17:06:07.370774 Epoch 79, Train Y Loss = 15.92008,  Train X Loss = 0.00000, Val Loss = 17.66259
2025-01-17 17:07:05.173252 Epoch 80, Train Y Loss = 15.91858,  Train X Loss = 0.00000, Val Loss = 17.65475
2025-01-17 17:08:03.252285 Epoch 81, Train Y Loss = 15.90921,  Train X Loss = 0.00000, Val Loss = 17.65630
2025-01-17 17:09:01.194664 Epoch 82, Train Y Loss = 15.91356,  Train X Loss = 0.00000, Val Loss = 17.65623
2025-01-17 17:09:59.183227 Epoch 83, Train Y Loss = 15.91741,  Train X Loss = 0.00000, Val Loss = 17.66134
2025-01-17 17:10:57.036831 Epoch 84, Train Y Loss = 15.91967,  Train X Loss = 0.00000, Val Loss = 17.65645
Early stopping at epoch: 84
Best at epoch 54:
Train Loss = 15.94246
Train RMSE = 27.49406, MAE = 16.43640, MAPE = 11.71481
Val Loss = 17.63808
Val RMSE = 30.79241, MAE = 18.29477, MAPE = 11.69621
--------- Test ---------
All Steps RMSE = 30.71721, MAE = 18.26741, MAPE = 11.99330
Step 1 RMSE = 27.08764, MAE = 16.60013, MAPE = 10.92728
Step 2 RMSE = 28.22487, MAE = 17.10991, MAPE = 11.30960
Step 3 RMSE = 29.10616, MAE = 17.51722, MAPE = 11.56484
Step 4 RMSE = 29.80444, MAE = 17.83289, MAPE = 11.74668
Step 5 RMSE = 30.38199, MAE = 18.09636, MAPE = 11.88293
Step 6 RMSE = 30.84054, MAE = 18.30938, MAPE = 12.01109
Step 7 RMSE = 31.27514, MAE = 18.51607, MAPE = 12.13434
Step 8 RMSE = 31.63970, MAE = 18.69309, MAPE = 12.24212
Step 9 RMSE = 31.97459, MAE = 18.87191, MAPE = 12.34726
Step 10 RMSE = 32.26297, MAE = 19.03716, MAPE = 12.46470
Step 11 RMSE = 32.55692, MAE = 19.21170, MAPE = 12.57474
Step 12 RMSE = 32.86395, MAE = 19.41296, MAPE = 12.71392
Inference time: 5.80 s
