PEMS07
--------- DMRCMLP ---------
{
    "num_nodes": 883,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.001,
    "milestones": [
        20,
        40,
        55
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 120,
    "early_stop": 25,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 6,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 93048409,
    "gpu": [
        4,
        5
    ],
    "save": false,
    "model_args": {
        "num_nodes": 883,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        888,204
├─Linear: 1-1                                 [16, 12, 883, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 883, 48]         --
│    └─Embedding: 2-1                         [16, 12, 883, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 883, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 883, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 883, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 883, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 883, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 883, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 883, 144]        158,224
├─Predictor: 1-4                              [16, 12, 883, 1]          --
│    └─Linear: 2-5                            [16, 12, 883, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 883, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 883, 144]        41,760
│    └─Linear: 2-7                            [16, 883, 12]             20,748
===============================================================================================
Total params: 1,653,376
Trainable params: 1,653,376
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 2.03
Forward/backward pass size (MB): 7932.93
Params size (MB): 3.06
Estimated Total Size (MB): 7938.02
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS07-2025-01-17-23-10-43.pt
2025-01-17 23:16:04.043656 Epoch 1, Train Y Loss = 31.24271,  Train X Loss = 22.32947, Val Loss = 24.68508
2025-01-17 23:21:25.252803 Epoch 2, Train Y Loss = 24.38309,  Train X Loss = 17.62867, Val Loss = 22.34402
2025-01-17 23:26:46.193813 Epoch 3, Train Y Loss = 22.82557,  Train X Loss = 17.21428, Val Loss = 23.35892
2025-01-17 23:32:07.315958 Epoch 4, Train Y Loss = 21.89836,  Train X Loss = 16.70652, Val Loss = 22.10930
2025-01-17 23:37:28.856417 Epoch 5, Train Y Loss = 21.51331,  Train X Loss = 14.09660, Val Loss = 21.71149
2025-01-17 23:42:46.506395 Epoch 6, Train Y Loss = 20.99533,  Train X Loss = 12.31545, Val Loss = 21.92226
2025-01-17 23:48:04.078350 Epoch 7, Train Y Loss = 20.59652,  Train X Loss = 11.86911, Val Loss = 20.96385
2025-01-17 23:53:25.061463 Epoch 8, Train Y Loss = 20.24521,  Train X Loss = 11.64207, Val Loss = 20.05407
2025-01-17 23:58:47.738652 Epoch 9, Train Y Loss = 20.07801,  Train X Loss = 11.46634, Val Loss = 19.83955
2025-01-18 00:04:11.048458 Epoch 10, Train Y Loss = 19.79328,  Train X Loss = 11.30733, Val Loss = 20.19452
2025-01-18 00:09:35.156900 Epoch 11, Train Y Loss = 19.68423,  Train X Loss = 11.20970, Val Loss = 19.77891
2025-01-18 00:14:56.882089 Epoch 12, Train Y Loss = 19.44873,  Train X Loss = 11.07494, Val Loss = 19.52111
2025-01-18 00:20:20.793881 Epoch 13, Train Y Loss = 19.34215,  Train X Loss = 11.00707, Val Loss = 19.88112
2025-01-18 00:25:42.875027 Epoch 14, Train Y Loss = 19.22502,  Train X Loss = 10.93065, Val Loss = 20.01165
2025-01-18 00:31:06.189651 Epoch 15, Train Y Loss = 19.13088,  Train X Loss = 10.86444, Val Loss = 19.44315
2025-01-18 00:36:29.706085 Epoch 16, Train Y Loss = 19.00098,  Train X Loss = 10.84330, Val Loss = 19.46317
2025-01-18 00:41:52.092460 Epoch 17, Train Y Loss = 18.91407,  Train X Loss = 10.79613, Val Loss = 19.20847
2025-01-18 00:47:16.645614 Epoch 18, Train Y Loss = 18.81012,  Train X Loss = 10.76674, Val Loss = 19.37798
2025-01-18 00:52:41.009136 Epoch 19, Train Y Loss = 18.75277,  Train X Loss = 10.70240, Val Loss = 19.04512
2025-01-18 00:58:04.869507 Epoch 20, Train Y Loss = 18.64005,  Train X Loss = 10.67247, Val Loss = 19.00147
2025-01-18 01:03:29.094821 Epoch 21, Train Y Loss = 17.83705,  Train X Loss = 10.27897, Val Loss = 18.48345
2025-01-18 01:08:52.488608 Epoch 22, Train Y Loss = 17.72573,  Train X Loss = 10.23770, Val Loss = 18.48463
2025-01-18 01:14:16.041400 Epoch 23, Train Y Loss = 17.68444,  Train X Loss = 10.21787, Val Loss = 18.46232
2025-01-18 01:19:37.061775 Epoch 24, Train Y Loss = 17.64860,  Train X Loss = 10.19824, Val Loss = 18.42070
2025-01-18 01:24:58.252322 Epoch 25, Train Y Loss = 17.62071,  Train X Loss = 10.18699, Val Loss = 18.30237
2025-01-18 01:30:22.021100 Epoch 26, Train Y Loss = 17.58975,  Train X Loss = 10.17512, Val Loss = 18.34861
2025-01-18 01:35:46.183928 Epoch 27, Train Y Loss = 17.56691,  Train X Loss = 10.16657, Val Loss = 18.30251
2025-01-18 01:41:09.217786 Epoch 28, Train Y Loss = 17.54138,  Train X Loss = 10.15321, Val Loss = 18.34157
2025-01-18 01:46:32.110615 Epoch 29, Train Y Loss = 17.51891,  Train X Loss = 10.14506, Val Loss = 18.30622
2025-01-18 01:51:55.336191 Epoch 30, Train Y Loss = 17.50002,  Train X Loss = 10.13789, Val Loss = 18.27999
2025-01-18 01:57:19.100546 Epoch 31, Train Y Loss = 17.48278,  Train X Loss = 10.13197, Val Loss = 18.29044
2025-01-18 02:02:42.699771 Epoch 32, Train Y Loss = 17.46592,  Train X Loss = 10.12826, Val Loss = 18.23818
2025-01-18 02:08:08.831142 Epoch 33, Train Y Loss = 17.44467,  Train X Loss = 10.11719, Val Loss = 18.19101
2025-01-18 02:13:34.449808 Epoch 34, Train Y Loss = 17.42693,  Train X Loss = 10.11437, Val Loss = 18.13165
2025-01-18 02:18:57.481742 Epoch 35, Train Y Loss = 17.41157,  Train X Loss = 10.10580, Val Loss = 18.14951
2025-01-18 02:24:20.028876 Epoch 36, Train Y Loss = 17.39878,  Train X Loss = 10.10240, Val Loss = 18.22269
2025-01-18 02:29:43.019142 Epoch 37, Train Y Loss = 17.38258,  Train X Loss = 10.09582, Val Loss = 18.17220
2025-01-18 02:35:05.342116 Epoch 38, Train Y Loss = 17.36885,  Train X Loss = 10.08910, Val Loss = 18.24483
2025-01-18 02:40:30.150660 Epoch 39, Train Y Loss = 17.35759,  Train X Loss = 10.09093, Val Loss = 18.12953
2025-01-18 02:45:52.229908 Epoch 40, Train Y Loss = 17.34080,  Train X Loss = 10.08582, Val Loss = 18.11833
2025-01-18 02:51:15.589667 Epoch 41, Train Y Loss = 17.23533,  Train X Loss = 10.04959, Val Loss = 18.08843
2025-01-18 02:56:38.365830 Epoch 42, Train Y Loss = 17.22137,  Train X Loss = 10.04395, Val Loss = 18.11092
2025-01-18 03:02:00.797763 Epoch 43, Train Y Loss = 17.21909,  Train X Loss = 10.04739, Val Loss = 18.10140
2025-01-18 03:07:24.237674 Epoch 44, Train Y Loss = 17.21445,  Train X Loss = 10.04347, Val Loss = 18.09846
2025-01-18 03:12:42.305935 Epoch 45, Train Y Loss = 17.21215,  Train X Loss = 10.03908, Val Loss = 18.12344
2025-01-18 03:18:05.168702 Epoch 46, Train Y Loss = 17.21027,  Train X Loss = 10.03761, Val Loss = 18.10384
2025-01-18 03:23:31.517546 Epoch 47, Train Y Loss = 17.20609,  Train X Loss = 10.03950, Val Loss = 18.08846
Change mask ratio: 0.075
2025-01-18 03:28:58.994625 Epoch 48, Train Y Loss = 17.16518,  Train X Loss = 4.85870, Val Loss = 17.99660
2025-01-18 03:34:27.341015 Epoch 49, Train Y Loss = 17.15746,  Train X Loss = 4.85707, Val Loss = 17.97334
2025-01-18 03:39:55.476415 Epoch 50, Train Y Loss = 17.14981,  Train X Loss = 4.85745, Val Loss = 17.96818
2025-01-18 03:45:22.930153 Epoch 51, Train Y Loss = 17.14632,  Train X Loss = 4.86050, Val Loss = 17.99581
2025-01-18 03:50:50.334520 Epoch 52, Train Y Loss = 17.14089,  Train X Loss = 4.85806, Val Loss = 17.97716
2025-01-18 03:56:17.630569 Epoch 53, Train Y Loss = 17.13873,  Train X Loss = 4.85886, Val Loss = 17.98971
2025-01-18 04:01:45.968343 Epoch 54, Train Y Loss = 17.13392,  Train X Loss = 4.86428, Val Loss = 17.97400
2025-01-18 04:07:12.700390 Epoch 55, Train Y Loss = 17.13121,  Train X Loss = 4.86161, Val Loss = 17.97520
2025-01-18 04:12:39.818700 Epoch 56, Train Y Loss = 17.11728,  Train X Loss = 4.86408, Val Loss = 17.97123
Change mask ratio: 0.0375
2025-01-18 04:18:03.842933 Epoch 57, Train Y Loss = 17.10003,  Train X Loss = 2.39627, Val Loss = 17.94565
2025-01-18 04:23:27.464523 Epoch 58, Train Y Loss = 17.09637,  Train X Loss = 2.39726, Val Loss = 17.94281
2025-01-18 04:28:52.868222 Epoch 59, Train Y Loss = 17.09546,  Train X Loss = 2.39702, Val Loss = 17.93890
2025-01-18 04:34:18.613021 Epoch 60, Train Y Loss = 17.09572,  Train X Loss = 2.39481, Val Loss = 17.93991
2025-01-18 04:39:43.042358 Epoch 61, Train Y Loss = 17.09532,  Train X Loss = 2.39633, Val Loss = 17.94044
2025-01-18 04:45:07.549587 Epoch 62, Train Y Loss = 17.09320,  Train X Loss = 2.40058, Val Loss = 17.93383
2025-01-18 04:50:31.090790 Epoch 63, Train Y Loss = 17.09204,  Train X Loss = 2.39701, Val Loss = 17.93089
2025-01-18 04:55:56.505539 Epoch 64, Train Y Loss = 17.08873,  Train X Loss = 2.39637, Val Loss = 17.93829
2025-01-18 05:01:22.780675 Epoch 65, Train Y Loss = 17.08844,  Train X Loss = 2.39701, Val Loss = 17.93985
2025-01-18 05:06:48.314982 Epoch 66, Train Y Loss = 17.08793,  Train X Loss = 2.39785, Val Loss = 17.94018
2025-01-18 05:12:13.585822 Epoch 67, Train Y Loss = 17.08842,  Train X Loss = 2.39474, Val Loss = 17.94302
2025-01-18 05:17:38.773565 Epoch 68, Train Y Loss = 17.08739,  Train X Loss = 2.40066, Val Loss = 17.93606
2025-01-18 05:23:02.141623 Epoch 69, Train Y Loss = 17.08819,  Train X Loss = 2.39795, Val Loss = 17.93929
Change mask ratio: 0.0
2025-01-18 05:27:35.702540 Epoch 70, Train Y Loss = 17.07643,  Train X Loss = 0.00000, Val Loss = 17.93388
2025-01-18 05:32:17.552113 Epoch 71, Train Y Loss = 17.07165,  Train X Loss = 0.00000, Val Loss = 17.93568
2025-01-18 05:36:59.055870 Epoch 72, Train Y Loss = 17.06973,  Train X Loss = 0.00000, Val Loss = 17.92842
2025-01-18 05:41:41.091668 Epoch 73, Train Y Loss = 17.06632,  Train X Loss = 0.00000, Val Loss = 17.93143
2025-01-18 05:46:15.105051 Epoch 74, Train Y Loss = 17.06582,  Train X Loss = 0.00000, Val Loss = 17.92307
2025-01-18 05:50:57.158405 Epoch 75, Train Y Loss = 17.06385,  Train X Loss = 0.00000, Val Loss = 17.93077
2025-01-18 05:55:41.110740 Epoch 76, Train Y Loss = 17.06113,  Train X Loss = 0.00000, Val Loss = 17.93069
2025-01-18 06:00:23.161689 Epoch 77, Train Y Loss = 17.06043,  Train X Loss = 0.00000, Val Loss = 17.92869
2025-01-18 06:04:57.496129 Epoch 78, Train Y Loss = 17.05889,  Train X Loss = 0.00000, Val Loss = 17.93388
2025-01-18 06:09:36.001742 Epoch 79, Train Y Loss = 17.05676,  Train X Loss = 0.00000, Val Loss = 17.93497
2025-01-18 06:14:17.766319 Epoch 80, Train Y Loss = 17.05469,  Train X Loss = 0.00000, Val Loss = 17.93148
Change mask ratio: 0.0
2025-01-18 06:18:58.717317 Epoch 81, Train Y Loss = 17.05476,  Train X Loss = 0.00000, Val Loss = 17.93703
2025-01-18 06:23:36.727757 Epoch 82, Train Y Loss = 17.05383,  Train X Loss = 0.00000, Val Loss = 17.92239
2025-01-18 06:28:10.509390 Epoch 83, Train Y Loss = 17.05188,  Train X Loss = 0.00000, Val Loss = 17.92643
2025-01-18 06:32:52.822324 Epoch 84, Train Y Loss = 17.05026,  Train X Loss = 0.00000, Val Loss = 17.92961
2025-01-18 06:37:35.774051 Epoch 85, Train Y Loss = 17.04928,  Train X Loss = 0.00000, Val Loss = 17.92603
2025-01-18 06:42:16.620437 Epoch 86, Train Y Loss = 17.04720,  Train X Loss = 0.00000, Val Loss = 17.92009
2025-01-18 06:46:50.747301 Epoch 87, Train Y Loss = 17.04595,  Train X Loss = 0.00000, Val Loss = 17.92547
2025-01-18 06:51:34.871525 Epoch 88, Train Y Loss = 17.04610,  Train X Loss = 0.00000, Val Loss = 17.92362
2025-01-18 06:56:19.019839 Epoch 89, Train Y Loss = 17.04486,  Train X Loss = 0.00000, Val Loss = 17.92547
2025-01-18 07:01:01.266751 Epoch 90, Train Y Loss = 17.04496,  Train X Loss = 0.00000, Val Loss = 17.92260
2025-01-18 07:05:36.323738 Epoch 91, Train Y Loss = 17.04163,  Train X Loss = 0.00000, Val Loss = 17.93063
2025-01-18 07:10:20.636519 Epoch 92, Train Y Loss = 17.04196,  Train X Loss = 0.00000, Val Loss = 17.92051
Change mask ratio: 0.0
2025-01-18 07:15:03.876265 Epoch 93, Train Y Loss = 17.03916,  Train X Loss = 0.00000, Val Loss = 17.92272
2025-01-18 07:19:47.015024 Epoch 94, Train Y Loss = 17.03983,  Train X Loss = 0.00000, Val Loss = 17.92918
2025-01-18 07:24:26.646263 Epoch 95, Train Y Loss = 17.03818,  Train X Loss = 0.00000, Val Loss = 17.92274
2025-01-18 07:29:01.471079 Epoch 96, Train Y Loss = 17.03582,  Train X Loss = 0.00000, Val Loss = 17.93090
2025-01-18 07:33:45.344681 Epoch 97, Train Y Loss = 17.03469,  Train X Loss = 0.00000, Val Loss = 17.91891
2025-01-18 07:38:29.321879 Epoch 98, Train Y Loss = 17.03313,  Train X Loss = 0.00000, Val Loss = 17.92236
2025-01-18 07:43:09.137251 Epoch 99, Train Y Loss = 17.03246,  Train X Loss = 0.00000, Val Loss = 17.93255
2025-01-18 07:47:44.399348 Epoch 100, Train Y Loss = 17.03292,  Train X Loss = 0.00000, Val Loss = 17.92485
2025-01-18 07:52:31.457495 Epoch 101, Train Y Loss = 17.03310,  Train X Loss = 0.00000, Val Loss = 17.91759
2025-01-18 07:57:15.634943 Epoch 102, Train Y Loss = 17.03031,  Train X Loss = 0.00000, Val Loss = 17.92980
2025-01-18 08:01:59.090855 Epoch 103, Train Y Loss = 17.02916,  Train X Loss = 0.00000, Val Loss = 17.91847
2025-01-18 08:06:33.988511 Epoch 104, Train Y Loss = 17.03046,  Train X Loss = 0.00000, Val Loss = 17.92898
2025-01-18 08:11:17.222027 Epoch 105, Train Y Loss = 17.02933,  Train X Loss = 0.00000, Val Loss = 17.92496
2025-01-18 08:15:59.775250 Epoch 106, Train Y Loss = 17.02707,  Train X Loss = 0.00000, Val Loss = 17.92565
2025-01-18 08:20:42.641404 Epoch 107, Train Y Loss = 17.02681,  Train X Loss = 0.00000, Val Loss = 17.92154
Change mask ratio: 0.0
2025-01-18 08:25:20.570756 Epoch 108, Train Y Loss = 17.02509,  Train X Loss = 0.00000, Val Loss = 17.92854
2025-01-18 08:29:56.077793 Epoch 109, Train Y Loss = 17.02506,  Train X Loss = 0.00000, Val Loss = 17.92484
2025-01-18 08:34:38.286089 Epoch 110, Train Y Loss = 17.02258,  Train X Loss = 0.00000, Val Loss = 17.92382
2025-01-18 08:39:21.494857 Epoch 111, Train Y Loss = 17.02301,  Train X Loss = 0.00000, Val Loss = 17.92062
2025-01-18 08:44:01.450236 Epoch 112, Train Y Loss = 17.02166,  Train X Loss = 0.00000, Val Loss = 17.91831
2025-01-18 08:48:36.647389 Epoch 113, Train Y Loss = 17.02127,  Train X Loss = 0.00000, Val Loss = 17.92262
Change mask ratio: 0.0
2025-01-18 08:53:23.600877 Epoch 114, Train Y Loss = 17.01958,  Train X Loss = 0.00000, Val Loss = 17.92004
2025-01-18 08:58:06.001166 Epoch 115, Train Y Loss = 17.01936,  Train X Loss = 0.00000, Val Loss = 17.91847
2025-01-18 09:02:38.637790 Epoch 116, Train Y Loss = 17.01771,  Train X Loss = 0.00000, Val Loss = 17.91981
2025-01-18 09:06:18.481956 Epoch 117, Train Y Loss = 17.01829,  Train X Loss = 0.00000, Val Loss = 17.92067
2025-01-18 09:09:58.171846 Epoch 118, Train Y Loss = 17.01648,  Train X Loss = 0.00000, Val Loss = 17.91365
2025-01-18 09:13:37.576418 Epoch 119, Train Y Loss = 17.01439,  Train X Loss = 0.00000, Val Loss = 17.91636
2025-01-18 09:17:15.834570 Epoch 120, Train Y Loss = 17.01474,  Train X Loss = 0.00000, Val Loss = 17.92117
Early stopping at epoch: 120
Best at epoch 118:
Train Loss = 17.01648
Train RMSE = 29.91802, MAE = 17.30812, MAPE = 7.56846
Val Loss = 17.91365
Val RMSE = 31.65292, MAE = 18.43515, MAPE = 8.02648
--------- Test ---------
All Steps RMSE = 32.23296, MAE = 18.95317, MAPE = 7.85703
Step 1 RMSE = 26.16654, MAE = 15.95871, MAPE = 6.70538
Step 2 RMSE = 28.46404, MAE = 17.03340, MAPE = 7.14259
Step 3 RMSE = 29.80054, MAE = 17.68264, MAPE = 7.38255
Step 4 RMSE = 30.81078, MAE = 18.19102, MAPE = 7.56975
Step 5 RMSE = 31.64039, MAE = 18.61432, MAPE = 7.72202
Step 6 RMSE = 32.35990, MAE = 18.99401, MAPE = 7.86243
Step 7 RMSE = 32.99675, MAE = 19.33863, MAPE = 7.98852
Step 8 RMSE = 33.58239, MAE = 19.66394, MAPE = 8.10839
Step 9 RMSE = 34.10497, MAE = 19.96111, MAPE = 8.23080
Step 10 RMSE = 34.59639, MAE = 20.25850, MAPE = 8.34921
Step 11 RMSE = 35.07563, MAE = 20.57053, MAPE = 8.48566
Step 12 RMSE = 35.77622, MAE = 21.16880, MAPE = 8.73620
Inference time: 28.05 s
