PEMS03
--------- DMRCMLP ---------
{
    "num_nodes": 358,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0005,
    "milestones": [
        20,
        35,
        50
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 120,
    "early_stop": 20,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 93048409,
    "gpu": [
        3
    ],
    "save": false,
    "model_args": {
        "num_nodes": 358,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        434,604
├─Linear: 1-1                                 [16, 12, 358, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 358, 48]         --
│    └─Embedding: 2-1                         [16, 12, 358, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 358, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 358, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 358, 144]        158,224
├─Predictor: 1-4                              [16, 12, 358, 1]          --
│    └─Linear: 2-5                            [16, 12, 358, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 358, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 358, 144]        41,760
│    └─Linear: 2-7                            [16, 358, 12]             20,748
===============================================================================================
Total params: 1,199,776
Trainable params: 1,199,776
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 0.82
Forward/backward pass size (MB): 3216.29
Params size (MB): 3.06
Estimated Total Size (MB): 3220.18
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS03-2025-01-18-09-38-18.pt
2025-01-18 09:40:25.231542 Epoch 1, Train Y Loss = 21.44231,  Train X Loss = 0.00000, Val Loss = 16.90172
2025-01-18 09:42:31.797299 Epoch 2, Train Y Loss = 16.78273,  Train X Loss = 0.00000, Val Loss = 15.95772
2025-01-18 09:44:38.685763 Epoch 3, Train Y Loss = 15.63775,  Train X Loss = 0.00000, Val Loss = 15.03994
2025-01-18 09:46:45.022517 Epoch 4, Train Y Loss = 15.09487,  Train X Loss = 0.00000, Val Loss = 15.30621
2025-01-18 09:48:52.612747 Epoch 5, Train Y Loss = 14.59094,  Train X Loss = 0.00000, Val Loss = 14.33941
2025-01-18 09:51:00.939635 Epoch 6, Train Y Loss = 14.28944,  Train X Loss = 0.00000, Val Loss = 14.57554
2025-01-18 09:53:08.689433 Epoch 7, Train Y Loss = 14.02193,  Train X Loss = 0.00000, Val Loss = 14.42514
2025-01-18 09:55:15.071286 Epoch 8, Train Y Loss = 13.92436,  Train X Loss = 0.00000, Val Loss = 14.10292
2025-01-18 09:57:20.772660 Epoch 9, Train Y Loss = 13.70920,  Train X Loss = 0.00000, Val Loss = 14.14399
2025-01-18 09:59:27.011841 Epoch 10, Train Y Loss = 13.50964,  Train X Loss = 0.00000, Val Loss = 13.67144
2025-01-18 10:01:33.473472 Epoch 11, Train Y Loss = 13.42135,  Train X Loss = 0.00000, Val Loss = 13.74647
2025-01-18 10:03:39.382331 Epoch 12, Train Y Loss = 13.31356,  Train X Loss = 0.00000, Val Loss = 13.66284
2025-01-18 10:05:46.009810 Epoch 13, Train Y Loss = 13.26742,  Train X Loss = 0.00000, Val Loss = 13.72788
2025-01-18 10:07:52.650693 Epoch 14, Train Y Loss = 13.15216,  Train X Loss = 0.00000, Val Loss = 13.51805
2025-01-18 10:09:58.917894 Epoch 15, Train Y Loss = 13.07305,  Train X Loss = 0.00000, Val Loss = 13.48770
2025-01-18 10:12:04.833700 Epoch 16, Train Y Loss = 12.99911,  Train X Loss = 0.00000, Val Loss = 13.63063
2025-01-18 10:14:09.356839 Epoch 17, Train Y Loss = 12.95628,  Train X Loss = 0.00000, Val Loss = 13.40171
2025-01-18 10:16:15.529454 Epoch 18, Train Y Loss = 12.89522,  Train X Loss = 0.00000, Val Loss = 13.35170
2025-01-18 10:18:21.761536 Epoch 19, Train Y Loss = 12.85142,  Train X Loss = 0.00000, Val Loss = 13.38357
2025-01-18 10:20:28.400905 Epoch 20, Train Y Loss = 12.79685,  Train X Loss = 0.00000, Val Loss = 13.28345
2025-01-18 10:22:34.818291 Epoch 21, Train Y Loss = 12.27049,  Train X Loss = 0.00000, Val Loss = 13.02602
2025-01-18 10:24:40.563465 Epoch 22, Train Y Loss = 12.20435,  Train X Loss = 0.00000, Val Loss = 13.02545
2025-01-18 10:26:47.995718 Epoch 23, Train Y Loss = 12.18064,  Train X Loss = 0.00000, Val Loss = 13.02488
2025-01-18 10:28:54.122710 Epoch 24, Train Y Loss = 12.15875,  Train X Loss = 0.00000, Val Loss = 13.04903
2025-01-18 10:31:01.037785 Epoch 25, Train Y Loss = 12.14308,  Train X Loss = 0.00000, Val Loss = 13.09436
2025-01-18 10:33:07.900366 Epoch 26, Train Y Loss = 12.12679,  Train X Loss = 0.00000, Val Loss = 13.08290
2025-01-18 10:35:14.409521 Epoch 27, Train Y Loss = 12.11122,  Train X Loss = 0.00000, Val Loss = 13.02520
2025-01-18 10:37:21.119398 Epoch 28, Train Y Loss = 12.09659,  Train X Loss = 0.00000, Val Loss = 13.00265
2025-01-18 10:39:27.104415 Epoch 29, Train Y Loss = 12.08415,  Train X Loss = 0.00000, Val Loss = 13.07025
2025-01-18 10:41:33.795913 Epoch 30, Train Y Loss = 12.07331,  Train X Loss = 0.00000, Val Loss = 13.09021
2025-01-18 10:43:39.961905 Epoch 31, Train Y Loss = 12.05979,  Train X Loss = 0.00000, Val Loss = 13.03623
2025-01-18 10:45:46.032273 Epoch 32, Train Y Loss = 12.05024,  Train X Loss = 0.00000, Val Loss = 13.04732
2025-01-18 10:47:52.802916 Epoch 33, Train Y Loss = 12.03841,  Train X Loss = 0.00000, Val Loss = 13.02629
2025-01-18 10:50:00.860539 Epoch 34, Train Y Loss = 12.02768,  Train X Loss = 0.00000, Val Loss = 13.04195
2025-01-18 10:52:08.133912 Epoch 35, Train Y Loss = 12.01733,  Train X Loss = 0.00000, Val Loss = 13.01015
2025-01-18 10:54:14.188222 Epoch 36, Train Y Loss = 11.95561,  Train X Loss = 0.00000, Val Loss = 13.05118
Change mask ratio: 0.075
2025-01-18 10:56:18.476549 Epoch 37, Train Y Loss = 11.91875,  Train X Loss = 0.00000, Val Loss = 12.97059
2025-01-18 10:58:21.968426 Epoch 38, Train Y Loss = 11.91364,  Train X Loss = 0.00000, Val Loss = 13.00617
2025-01-18 11:00:25.712273 Epoch 39, Train Y Loss = 11.91154,  Train X Loss = 0.00000, Val Loss = 12.98142
2025-01-18 11:02:29.666458 Epoch 40, Train Y Loss = 11.90859,  Train X Loss = 0.00000, Val Loss = 13.00219
2025-01-18 11:04:33.926976 Epoch 41, Train Y Loss = 11.90720,  Train X Loss = 0.00000, Val Loss = 12.99945
2025-01-18 11:06:38.065521 Epoch 42, Train Y Loss = 11.90437,  Train X Loss = 0.00000, Val Loss = 13.01124
2025-01-18 11:08:41.454027 Epoch 43, Train Y Loss = 11.90342,  Train X Loss = 0.00000, Val Loss = 13.00216
2025-01-18 11:10:45.493214 Epoch 44, Train Y Loss = 11.90173,  Train X Loss = 0.00000, Val Loss = 12.99515
2025-01-18 11:12:49.897149 Epoch 45, Train Y Loss = 11.89935,  Train X Loss = 0.00000, Val Loss = 13.01639
Change mask ratio: 0.0375
2025-01-18 11:14:52.854032 Epoch 46, Train Y Loss = 11.88406,  Train X Loss = 0.00000, Val Loss = 12.97467
2025-01-18 11:16:55.592552 Epoch 47, Train Y Loss = 11.88293,  Train X Loss = 0.00000, Val Loss = 12.99043
2025-01-18 11:18:58.588850 Epoch 48, Train Y Loss = 11.88042,  Train X Loss = 0.00000, Val Loss = 12.99357
2025-01-18 11:21:01.377336 Epoch 49, Train Y Loss = 11.87892,  Train X Loss = 0.00000, Val Loss = 12.99696
2025-01-18 11:23:03.539317 Epoch 50, Train Y Loss = 11.87785,  Train X Loss = 0.00000, Val Loss = 12.98457
2025-01-18 11:25:06.924669 Epoch 51, Train Y Loss = 11.86977,  Train X Loss = 0.00000, Val Loss = 12.97904
2025-01-18 11:27:09.935038 Epoch 52, Train Y Loss = 11.86852,  Train X Loss = 0.00000, Val Loss = 12.98119
2025-01-18 11:29:12.325498 Epoch 53, Train Y Loss = 11.86767,  Train X Loss = 0.00000, Val Loss = 12.98675
Change mask ratio: 0.0
2025-01-18 11:31:00.761024 Epoch 54, Train Y Loss = 11.86563,  Train X Loss = 0.00000, Val Loss = 12.95939
2025-01-18 11:32:49.293011 Epoch 55, Train Y Loss = 11.86065,  Train X Loss = 0.00000, Val Loss = 12.95927
2025-01-18 11:34:37.760779 Epoch 56, Train Y Loss = 11.85886,  Train X Loss = 0.00000, Val Loss = 12.95238
2025-01-18 11:36:26.135050 Epoch 57, Train Y Loss = 11.85745,  Train X Loss = 0.00000, Val Loss = 12.95265
2025-01-18 11:38:14.654980 Epoch 58, Train Y Loss = 11.85705,  Train X Loss = 0.00000, Val Loss = 12.95791
2025-01-18 11:40:02.885176 Epoch 59, Train Y Loss = 11.85674,  Train X Loss = 0.00000, Val Loss = 12.96286
2025-01-18 11:41:51.509788 Epoch 60, Train Y Loss = 11.85533,  Train X Loss = 0.00000, Val Loss = 12.95260
2025-01-18 11:43:39.858782 Epoch 61, Train Y Loss = 11.85513,  Train X Loss = 0.00000, Val Loss = 12.95520
2025-01-18 11:45:28.592275 Epoch 62, Train Y Loss = 11.85521,  Train X Loss = 0.00000, Val Loss = 12.95547
2025-01-18 11:47:17.420895 Epoch 63, Train Y Loss = 11.85472,  Train X Loss = 0.00000, Val Loss = 12.95829
2025-01-18 11:49:06.059180 Epoch 64, Train Y Loss = 11.85543,  Train X Loss = 0.00000, Val Loss = 12.96096
Change mask ratio: 0.0
2025-01-18 11:50:55.235975 Epoch 65, Train Y Loss = 11.85389,  Train X Loss = 0.00000, Val Loss = 12.95654
2025-01-18 11:52:43.329027 Epoch 66, Train Y Loss = 11.85391,  Train X Loss = 0.00000, Val Loss = 12.95471
2025-01-18 11:54:31.585272 Epoch 67, Train Y Loss = 11.85317,  Train X Loss = 0.00000, Val Loss = 12.95517
2025-01-18 11:56:19.985353 Epoch 68, Train Y Loss = 11.85367,  Train X Loss = 0.00000, Val Loss = 12.95534
2025-01-18 11:58:08.374233 Epoch 69, Train Y Loss = 11.85384,  Train X Loss = 0.00000, Val Loss = 12.95472
2025-01-18 11:59:57.035180 Epoch 70, Train Y Loss = 11.85343,  Train X Loss = 0.00000, Val Loss = 12.95757
2025-01-18 12:01:45.805823 Epoch 71, Train Y Loss = 11.85289,  Train X Loss = 0.00000, Val Loss = 12.95913
2025-01-18 12:03:34.259064 Epoch 72, Train Y Loss = 11.85255,  Train X Loss = 0.00000, Val Loss = 12.95235
2025-01-18 12:05:22.817668 Epoch 73, Train Y Loss = 11.85271,  Train X Loss = 0.00000, Val Loss = 12.95776
2025-01-18 12:07:11.027405 Epoch 74, Train Y Loss = 11.85193,  Train X Loss = 0.00000, Val Loss = 12.95555
2025-01-18 12:08:59.601958 Epoch 75, Train Y Loss = 11.85164,  Train X Loss = 0.00000, Val Loss = 12.95205
2025-01-18 12:10:47.793174 Epoch 76, Train Y Loss = 11.85066,  Train X Loss = 0.00000, Val Loss = 12.96285
2025-01-18 12:12:36.088735 Epoch 77, Train Y Loss = 11.85091,  Train X Loss = 0.00000, Val Loss = 12.95405
2025-01-18 12:14:24.592923 Epoch 78, Train Y Loss = 11.85053,  Train X Loss = 0.00000, Val Loss = 12.96458
2025-01-18 12:16:13.334823 Epoch 79, Train Y Loss = 11.85057,  Train X Loss = 0.00000, Val Loss = 12.95660
2025-01-18 12:18:01.718049 Epoch 80, Train Y Loss = 11.84982,  Train X Loss = 0.00000, Val Loss = 12.96112
2025-01-18 12:19:50.213097 Epoch 81, Train Y Loss = 11.84990,  Train X Loss = 0.00000, Val Loss = 12.95415
2025-01-18 12:21:38.546852 Epoch 82, Train Y Loss = 11.84976,  Train X Loss = 0.00000, Val Loss = 12.95731
2025-01-18 12:23:26.799422 Epoch 83, Train Y Loss = 11.84965,  Train X Loss = 0.00000, Val Loss = 12.96076
Change mask ratio: 0.0
2025-01-18 12:25:15.272209 Epoch 84, Train Y Loss = 11.84900,  Train X Loss = 0.00000, Val Loss = 12.95427
2025-01-18 12:27:03.973817 Epoch 85, Train Y Loss = 11.84930,  Train X Loss = 0.00000, Val Loss = 12.95845
2025-01-18 12:28:52.311692 Epoch 86, Train Y Loss = 11.84848,  Train X Loss = 0.00000, Val Loss = 12.95276
2025-01-18 12:30:40.769328 Epoch 87, Train Y Loss = 11.84861,  Train X Loss = 0.00000, Val Loss = 12.95508
2025-01-18 12:32:29.094479 Epoch 88, Train Y Loss = 11.84845,  Train X Loss = 0.00000, Val Loss = 12.95538
2025-01-18 12:34:17.480000 Epoch 89, Train Y Loss = 11.84778,  Train X Loss = 0.00000, Val Loss = 12.95153
2025-01-18 12:36:06.085828 Epoch 90, Train Y Loss = 11.84827,  Train X Loss = 0.00000, Val Loss = 12.95466
2025-01-18 12:37:54.741477 Epoch 91, Train Y Loss = 11.84748,  Train X Loss = 0.00000, Val Loss = 12.96192
2025-01-18 12:39:43.411689 Epoch 92, Train Y Loss = 11.84770,  Train X Loss = 0.00000, Val Loss = 12.95883
2025-01-18 12:41:31.824629 Epoch 93, Train Y Loss = 11.84742,  Train X Loss = 0.00000, Val Loss = 12.95173
2025-01-18 12:43:20.570810 Epoch 94, Train Y Loss = 11.84660,  Train X Loss = 0.00000, Val Loss = 12.95555
2025-01-18 12:45:09.648343 Epoch 95, Train Y Loss = 11.84651,  Train X Loss = 0.00000, Val Loss = 12.95518
2025-01-18 12:46:58.819385 Epoch 96, Train Y Loss = 11.84646,  Train X Loss = 0.00000, Val Loss = 12.95517
2025-01-18 12:48:47.672170 Epoch 97, Train Y Loss = 11.84687,  Train X Loss = 0.00000, Val Loss = 12.95897
Change mask ratio: 0.0
2025-01-18 12:50:35.701647 Epoch 98, Train Y Loss = 11.84667,  Train X Loss = 0.00000, Val Loss = 12.95372
2025-01-18 12:52:23.943438 Epoch 99, Train Y Loss = 11.84618,  Train X Loss = 0.00000, Val Loss = 12.95686
2025-01-18 12:54:11.975964 Epoch 100, Train Y Loss = 11.84546,  Train X Loss = 0.00000, Val Loss = 12.95738
2025-01-18 12:56:00.153366 Epoch 101, Train Y Loss = 11.84581,  Train X Loss = 0.00000, Val Loss = 12.95415
2025-01-18 12:57:48.189889 Epoch 102, Train Y Loss = 11.84498,  Train X Loss = 0.00000, Val Loss = 12.96156
2025-01-18 12:59:36.748415 Epoch 103, Train Y Loss = 11.84473,  Train X Loss = 0.00000, Val Loss = 12.95889
2025-01-18 13:01:25.180312 Epoch 104, Train Y Loss = 11.84483,  Train X Loss = 0.00000, Val Loss = 12.95621
2025-01-18 13:03:13.607406 Epoch 105, Train Y Loss = 11.84492,  Train X Loss = 0.00000, Val Loss = 12.95373
Change mask ratio: 0.0
2025-01-18 13:05:02.030936 Epoch 106, Train Y Loss = 11.84528,  Train X Loss = 0.00000, Val Loss = 12.96207
2025-01-18 13:06:50.058655 Epoch 107, Train Y Loss = 11.84425,  Train X Loss = 0.00000, Val Loss = 12.95421
2025-01-18 13:08:38.523128 Epoch 108, Train Y Loss = 11.84455,  Train X Loss = 0.00000, Val Loss = 12.95743
2025-01-18 13:10:26.986330 Epoch 109, Train Y Loss = 11.84427,  Train X Loss = 0.00000, Val Loss = 12.95457
Early stopping at epoch: 109
Best at epoch 89:
Train Loss = 11.84778
Train RMSE = 20.25988, MAE = 12.23739, MAPE = 11.33854
Val Loss = 12.95153
Val RMSE = 21.90086, MAE = 13.47688, MAPE = 12.75601
--------- Test ---------
All Steps RMSE = 26.13566, MAE = 15.05974, MAPE = 15.27224
Step 1 RMSE = 20.04142, MAE = 12.47427, MAPE = 13.05431
Step 2 RMSE = 22.01963, MAE = 13.20106, MAPE = 13.76420
Step 3 RMSE = 23.53818, MAE = 13.79781, MAPE = 14.28695
Step 4 RMSE = 24.73818, MAE = 14.30600, MAPE = 14.64916
Step 5 RMSE = 25.65215, MAE = 14.72351, MAPE = 14.97602
Step 6 RMSE = 26.35466, MAE = 15.08700, MAPE = 15.24668
Step 7 RMSE = 26.98618, MAE = 15.43486, MAPE = 15.54188
Step 8 RMSE = 27.53471, MAE = 15.75229, MAPE = 15.81219
Step 9 RMSE = 28.03102, MAE = 16.05088, MAPE = 16.07774
Step 10 RMSE = 28.50790, MAE = 16.33955, MAPE = 16.34740
Step 11 RMSE = 28.98090, MAE = 16.62724, MAPE = 16.61427
Step 12 RMSE = 29.44455, MAE = 16.92231, MAPE = 16.89611
Inference time: 11.22 s
