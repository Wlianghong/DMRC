PEMS07
--------- DMRCMLP ---------
{
    "num_nodes": 883,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.001,
    "milestones": [
        20,
        40,
        55
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 120,
    "early_stop": 25,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 6,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 74418540,
    "gpu": [
        4,
        5
    ],
    "save": false,
    "model_args": {
        "num_nodes": 883,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        888,204
├─Linear: 1-1                                 [16, 12, 883, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 883, 48]         --
│    └─Embedding: 2-1                         [16, 12, 883, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 883, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 883, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 883, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 883, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 883, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 883, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 883, 144]        158,224
├─Predictor: 1-4                              [16, 12, 883, 1]          --
│    └─Linear: 2-5                            [16, 12, 883, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 883, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 883, 144]        41,760
│    └─Linear: 2-7                            [16, 883, 12]             20,748
===============================================================================================
Total params: 1,653,376
Trainable params: 1,653,376
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 2.03
Forward/backward pass size (MB): 7932.93
Params size (MB): 3.06
Estimated Total Size (MB): 7938.02
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS07-2025-01-19-18-04-10.pt
2025-01-19 18:08:11.231632 Epoch 1, Train Y Loss = 30.88414,  Train X Loss = 0.00000, Val Loss = 26.72811
2025-01-19 18:12:12.843090 Epoch 2, Train Y Loss = 24.32345,  Train X Loss = 0.00000, Val Loss = 23.78485
2025-01-19 18:16:14.279539 Epoch 3, Train Y Loss = 22.89921,  Train X Loss = 0.00000, Val Loss = 22.09405
2025-01-19 18:20:15.151895 Epoch 4, Train Y Loss = 21.94204,  Train X Loss = 0.00000, Val Loss = 21.84484
2025-01-19 18:24:16.294257 Epoch 5, Train Y Loss = 21.31665,  Train X Loss = 0.00000, Val Loss = 21.08957
2025-01-19 18:28:17.813483 Epoch 6, Train Y Loss = 20.80888,  Train X Loss = 0.00000, Val Loss = 20.73125
2025-01-19 18:32:19.281921 Epoch 7, Train Y Loss = 20.54646,  Train X Loss = 0.00000, Val Loss = 20.65074
2025-01-19 18:36:20.693869 Epoch 8, Train Y Loss = 20.22109,  Train X Loss = 0.00000, Val Loss = 20.57803
2025-01-19 18:40:21.900348 Epoch 9, Train Y Loss = 20.02851,  Train X Loss = 0.00000, Val Loss = 20.25326
2025-01-19 18:44:23.528248 Epoch 10, Train Y Loss = 19.75685,  Train X Loss = 0.00000, Val Loss = 19.97021
2025-01-19 18:48:24.629578 Epoch 11, Train Y Loss = 19.57372,  Train X Loss = 0.00000, Val Loss = 20.14863
2025-01-19 18:52:26.100258 Epoch 12, Train Y Loss = 19.44290,  Train X Loss = 0.00000, Val Loss = 19.84588
2025-01-19 18:56:27.305755 Epoch 13, Train Y Loss = 19.32982,  Train X Loss = 0.00000, Val Loss = 19.88081
2025-01-19 19:00:28.840252 Epoch 14, Train Y Loss = 19.18565,  Train X Loss = 0.00000, Val Loss = 19.61992
2025-01-19 19:04:25.340940 Epoch 15, Train Y Loss = 19.04836,  Train X Loss = 0.00000, Val Loss = 19.47752
2025-01-19 19:08:20.104290 Epoch 16, Train Y Loss = 18.96658,  Train X Loss = 0.00000, Val Loss = 19.27592
2025-01-19 19:12:20.448576 Epoch 17, Train Y Loss = 18.91950,  Train X Loss = 0.00000, Val Loss = 19.48061
2025-01-19 19:16:21.756827 Epoch 18, Train Y Loss = 18.78214,  Train X Loss = 0.00000, Val Loss = 19.24909
2025-01-19 19:20:23.007025 Epoch 19, Train Y Loss = 18.69581,  Train X Loss = 0.00000, Val Loss = 19.38384
2025-01-19 19:24:24.052222 Epoch 20, Train Y Loss = 18.59460,  Train X Loss = 0.00000, Val Loss = 19.19233
2025-01-19 19:28:20.957656 Epoch 21, Train Y Loss = 17.84381,  Train X Loss = 0.00000, Val Loss = 18.64417
2025-01-19 19:32:22.094676 Epoch 22, Train Y Loss = 17.74556,  Train X Loss = 0.00000, Val Loss = 18.72365
2025-01-19 19:36:23.042631 Epoch 23, Train Y Loss = 17.70099,  Train X Loss = 0.00000, Val Loss = 18.59557
2025-01-19 19:40:24.222532 Epoch 24, Train Y Loss = 17.66566,  Train X Loss = 0.00000, Val Loss = 18.65240
2025-01-19 19:44:25.543925 Epoch 25, Train Y Loss = 17.63419,  Train X Loss = 0.00000, Val Loss = 18.62021
2025-01-19 19:48:26.900394 Epoch 26, Train Y Loss = 17.60371,  Train X Loss = 0.00000, Val Loss = 18.66514
2025-01-19 19:52:27.953507 Epoch 27, Train Y Loss = 17.57679,  Train X Loss = 0.00000, Val Loss = 18.65348
2025-01-19 19:56:29.361137 Epoch 28, Train Y Loss = 17.55492,  Train X Loss = 0.00000, Val Loss = 18.57445
2025-01-19 20:00:30.632474 Epoch 29, Train Y Loss = 17.52975,  Train X Loss = 0.00000, Val Loss = 18.71290
2025-01-19 20:04:31.840318 Epoch 30, Train Y Loss = 17.50771,  Train X Loss = 0.00000, Val Loss = 18.67593
2025-01-19 20:08:32.900164 Epoch 31, Train Y Loss = 17.48815,  Train X Loss = 0.00000, Val Loss = 18.60271
2025-01-19 20:12:34.019076 Epoch 32, Train Y Loss = 17.46780,  Train X Loss = 0.00000, Val Loss = 18.72787
2025-01-19 20:16:34.909554 Epoch 33, Train Y Loss = 17.44673,  Train X Loss = 0.00000, Val Loss = 18.66171
2025-01-19 20:20:36.146690 Epoch 34, Train Y Loss = 17.43035,  Train X Loss = 0.00000, Val Loss = 18.75581
Change mask ratio: 0.075
2025-01-19 20:24:33.823867 Epoch 35, Train Y Loss = 17.34391,  Train X Loss = 0.00000, Val Loss = 18.53520
2025-01-19 20:28:30.511416 Epoch 36, Train Y Loss = 17.32432,  Train X Loss = 0.00000, Val Loss = 18.44366
2025-01-19 20:32:22.292254 Epoch 37, Train Y Loss = 17.30295,  Train X Loss = 0.00000, Val Loss = 18.42787
2025-01-19 20:36:12.563881 Epoch 38, Train Y Loss = 17.28279,  Train X Loss = 0.00000, Val Loss = 18.52929
2025-01-19 20:40:07.453288 Epoch 39, Train Y Loss = 17.26328,  Train X Loss = 0.00000, Val Loss = 18.53835
2025-01-19 20:43:58.848110 Epoch 40, Train Y Loss = 17.24761,  Train X Loss = 0.00000, Val Loss = 18.63719
2025-01-19 20:47:52.521366 Epoch 41, Train Y Loss = 17.15435,  Train X Loss = 0.00000, Val Loss = 18.51790
2025-01-19 20:51:46.515718 Epoch 42, Train Y Loss = 17.14269,  Train X Loss = 0.00000, Val Loss = 18.46985
2025-01-19 20:55:35.915813 Epoch 43, Train Y Loss = 17.13881,  Train X Loss = 0.00000, Val Loss = 18.46545
Change mask ratio: 0.0375
2025-01-19 20:59:28.987899 Epoch 44, Train Y Loss = 17.09522,  Train X Loss = 0.00000, Val Loss = 18.41493
2025-01-19 21:03:25.051437 Epoch 45, Train Y Loss = 17.08832,  Train X Loss = 0.00000, Val Loss = 18.42840
2025-01-19 21:07:20.892679 Epoch 46, Train Y Loss = 17.08780,  Train X Loss = 0.00000, Val Loss = 18.41675
2025-01-19 21:11:11.660278 Epoch 47, Train Y Loss = 17.08185,  Train X Loss = 0.00000, Val Loss = 18.40781
2025-01-19 21:15:03.282698 Epoch 48, Train Y Loss = 17.07856,  Train X Loss = 0.00000, Val Loss = 18.41372
2025-01-19 21:18:59.653213 Epoch 49, Train Y Loss = 17.07673,  Train X Loss = 0.00000, Val Loss = 18.40596
2025-01-19 21:22:55.991290 Epoch 50, Train Y Loss = 17.07301,  Train X Loss = 0.00000, Val Loss = 18.42969
2025-01-19 21:26:52.287721 Epoch 51, Train Y Loss = 17.06976,  Train X Loss = 0.00000, Val Loss = 18.39697
2025-01-19 21:30:48.626224 Epoch 52, Train Y Loss = 17.06605,  Train X Loss = 0.00000, Val Loss = 18.42066
2025-01-19 21:34:44.915651 Epoch 53, Train Y Loss = 17.06373,  Train X Loss = 0.00000, Val Loss = 18.40706
2025-01-19 21:38:41.328183 Epoch 54, Train Y Loss = 17.06086,  Train X Loss = 0.00000, Val Loss = 18.39048
2025-01-19 21:42:37.682387 Epoch 55, Train Y Loss = 17.05864,  Train X Loss = 0.00000, Val Loss = 18.43421
2025-01-19 21:46:34.236486 Epoch 56, Train Y Loss = 17.04613,  Train X Loss = 0.00000, Val Loss = 18.42510
2025-01-19 21:50:30.417897 Epoch 57, Train Y Loss = 17.04505,  Train X Loss = 0.00000, Val Loss = 18.41896
2025-01-19 21:54:27.099820 Epoch 58, Train Y Loss = 17.04629,  Train X Loss = 0.00000, Val Loss = 18.41043
2025-01-19 21:58:23.329436 Epoch 59, Train Y Loss = 17.04389,  Train X Loss = 0.00000, Val Loss = 18.40763
2025-01-19 22:02:19.588611 Epoch 60, Train Y Loss = 17.04356,  Train X Loss = 0.00000, Val Loss = 18.41374
Change mask ratio: 0.0
2025-01-19 22:05:53.722140 Epoch 61, Train Y Loss = 17.02775,  Train X Loss = 0.00000, Val Loss = 18.35537
2025-01-19 22:09:27.685946 Epoch 62, Train Y Loss = 17.01693,  Train X Loss = 0.00000, Val Loss = 18.35461
2025-01-19 22:13:01.333735 Epoch 63, Train Y Loss = 17.01387,  Train X Loss = 0.00000, Val Loss = 18.33985
2025-01-19 22:16:35.167343 Epoch 64, Train Y Loss = 17.01166,  Train X Loss = 0.00000, Val Loss = 18.34428
2025-01-19 22:20:08.932291 Epoch 65, Train Y Loss = 17.00856,  Train X Loss = 0.00000, Val Loss = 18.33828
2025-01-19 22:23:42.957765 Epoch 66, Train Y Loss = 17.00905,  Train X Loss = 0.00000, Val Loss = 18.34126
2025-01-19 22:27:16.874540 Epoch 67, Train Y Loss = 17.00763,  Train X Loss = 0.00000, Val Loss = 18.33558
2025-01-19 22:30:50.779001 Epoch 68, Train Y Loss = 17.00696,  Train X Loss = 0.00000, Val Loss = 18.34759
2025-01-19 22:34:24.450152 Epoch 69, Train Y Loss = 17.00543,  Train X Loss = 0.00000, Val Loss = 18.34297
2025-01-19 22:37:58.253624 Epoch 70, Train Y Loss = 17.00388,  Train X Loss = 0.00000, Val Loss = 18.33925
2025-01-19 22:41:31.854781 Epoch 71, Train Y Loss = 17.00328,  Train X Loss = 0.00000, Val Loss = 18.34236
2025-01-19 22:45:05.535624 Epoch 72, Train Y Loss = 17.00329,  Train X Loss = 0.00000, Val Loss = 18.33549
2025-01-19 22:48:39.303579 Epoch 73, Train Y Loss = 17.00266,  Train X Loss = 0.00000, Val Loss = 18.34452
2025-01-19 22:52:13.254984 Epoch 74, Train Y Loss = 17.00151,  Train X Loss = 0.00000, Val Loss = 18.34259
2025-01-19 22:55:47.089304 Epoch 75, Train Y Loss = 16.99926,  Train X Loss = 0.00000, Val Loss = 18.34747
2025-01-19 22:59:21.106075 Epoch 76, Train Y Loss = 16.99983,  Train X Loss = 0.00000, Val Loss = 18.34404
2025-01-19 23:02:55.103035 Epoch 77, Train Y Loss = 16.99946,  Train X Loss = 0.00000, Val Loss = 18.34036
2025-01-19 23:06:28.612474 Epoch 78, Train Y Loss = 16.99671,  Train X Loss = 0.00000, Val Loss = 18.34338
Change mask ratio: 0.0
2025-01-19 23:10:02.033300 Epoch 79, Train Y Loss = 16.99828,  Train X Loss = 0.00000, Val Loss = 18.34363
2025-01-19 23:13:35.639730 Epoch 80, Train Y Loss = 16.99905,  Train X Loss = 0.00000, Val Loss = 18.34716
2025-01-19 23:17:09.320537 Epoch 81, Train Y Loss = 16.99661,  Train X Loss = 0.00000, Val Loss = 18.34970
2025-01-19 23:20:43.278907 Epoch 82, Train Y Loss = 16.99697,  Train X Loss = 0.00000, Val Loss = 18.34774
2025-01-19 23:24:16.871649 Epoch 83, Train Y Loss = 16.99607,  Train X Loss = 0.00000, Val Loss = 18.33903
2025-01-19 23:27:50.725820 Epoch 84, Train Y Loss = 16.99590,  Train X Loss = 0.00000, Val Loss = 18.34820
Change mask ratio: 0.0
2025-01-19 23:31:24.274574 Epoch 85, Train Y Loss = 16.99526,  Train X Loss = 0.00000, Val Loss = 18.34615
2025-01-19 23:34:57.952650 Epoch 86, Train Y Loss = 16.99556,  Train X Loss = 0.00000, Val Loss = 18.34015
2025-01-19 23:38:31.716757 Epoch 87, Train Y Loss = 16.99504,  Train X Loss = 0.00000, Val Loss = 18.34876
2025-01-19 23:42:05.658572 Epoch 88, Train Y Loss = 16.99228,  Train X Loss = 0.00000, Val Loss = 18.34433
2025-01-19 23:45:39.566688 Epoch 89, Train Y Loss = 16.99279,  Train X Loss = 0.00000, Val Loss = 18.33385
2025-01-19 23:49:13.614589 Epoch 90, Train Y Loss = 16.99403,  Train X Loss = 0.00000, Val Loss = 18.34024
2025-01-19 23:52:47.369574 Epoch 91, Train Y Loss = 16.99198,  Train X Loss = 0.00000, Val Loss = 18.34005
2025-01-19 23:56:21.284464 Epoch 92, Train Y Loss = 16.99332,  Train X Loss = 0.00000, Val Loss = 18.34118
2025-01-19 23:59:54.816176 Epoch 93, Train Y Loss = 16.99183,  Train X Loss = 0.00000, Val Loss = 18.34028
2025-01-20 00:03:28.385386 Epoch 94, Train Y Loss = 16.99059,  Train X Loss = 0.00000, Val Loss = 18.34357
2025-01-20 00:07:01.854784 Epoch 95, Train Y Loss = 16.99061,  Train X Loss = 0.00000, Val Loss = 18.34483
Change mask ratio: 0.0
2025-01-20 00:10:35.551984 Epoch 96, Train Y Loss = 16.99024,  Train X Loss = 0.00000, Val Loss = 18.35037
2025-01-20 00:14:09.343927 Epoch 97, Train Y Loss = 16.98966,  Train X Loss = 0.00000, Val Loss = 18.34031
2025-01-20 00:17:43.205639 Epoch 98, Train Y Loss = 16.98901,  Train X Loss = 0.00000, Val Loss = 18.34055
2025-01-20 00:21:16.937507 Epoch 99, Train Y Loss = 16.98894,  Train X Loss = 0.00000, Val Loss = 18.34100
2025-01-20 00:24:50.921312 Epoch 100, Train Y Loss = 16.98858,  Train X Loss = 0.00000, Val Loss = 18.34508
2025-01-20 00:28:24.309628 Epoch 101, Train Y Loss = 16.98791,  Train X Loss = 0.00000, Val Loss = 18.34659
Change mask ratio: 0.0
2025-01-20 00:31:58.149606 Epoch 102, Train Y Loss = 16.98825,  Train X Loss = 0.00000, Val Loss = 18.34456
2025-01-20 00:35:32.001551 Epoch 103, Train Y Loss = 16.98803,  Train X Loss = 0.00000, Val Loss = 18.34675
2025-01-20 00:39:05.917616 Epoch 104, Train Y Loss = 16.98647,  Train X Loss = 0.00000, Val Loss = 18.33768
2025-01-20 00:42:39.600683 Epoch 105, Train Y Loss = 16.98555,  Train X Loss = 0.00000, Val Loss = 18.34525
2025-01-20 00:46:13.607920 Epoch 106, Train Y Loss = 16.98586,  Train X Loss = 0.00000, Val Loss = 18.34328
2025-01-20 00:49:47.226867 Epoch 107, Train Y Loss = 16.98671,  Train X Loss = 0.00000, Val Loss = 18.33759
Change mask ratio: 0.0
2025-01-20 00:53:20.876429 Epoch 108, Train Y Loss = 16.98500,  Train X Loss = 0.00000, Val Loss = 18.33349
2025-01-20 00:56:54.415468 Epoch 109, Train Y Loss = 16.98548,  Train X Loss = 0.00000, Val Loss = 18.34247
2025-01-20 01:00:28.153850 Epoch 110, Train Y Loss = 16.98504,  Train X Loss = 0.00000, Val Loss = 18.34161
2025-01-20 01:04:01.705371 Epoch 111, Train Y Loss = 16.98356,  Train X Loss = 0.00000, Val Loss = 18.34206
2025-01-20 01:07:35.609924 Epoch 112, Train Y Loss = 16.98471,  Train X Loss = 0.00000, Val Loss = 18.33848
2025-01-20 01:11:09.497166 Epoch 113, Train Y Loss = 16.98364,  Train X Loss = 0.00000, Val Loss = 18.33826
2025-01-20 01:14:42.147245 Epoch 114, Train Y Loss = 16.98358,  Train X Loss = 0.00000, Val Loss = 18.34166
Change mask ratio: 0.0
2025-01-20 01:18:13.311916 Epoch 115, Train Y Loss = 16.98258,  Train X Loss = 0.00000, Val Loss = 18.33904
2025-01-20 01:21:42.916859 Epoch 116, Train Y Loss = 16.98321,  Train X Loss = 0.00000, Val Loss = 18.34224
2025-01-20 01:25:12.549829 Epoch 117, Train Y Loss = 16.98171,  Train X Loss = 0.00000, Val Loss = 18.34255
2025-01-20 01:28:42.253448 Epoch 118, Train Y Loss = 16.97877,  Train X Loss = 0.00000, Val Loss = 18.33771
2025-01-20 01:32:12.440441 Epoch 119, Train Y Loss = 16.98161,  Train X Loss = 0.00000, Val Loss = 18.33805
2025-01-20 01:35:43.121989 Epoch 120, Train Y Loss = 16.97954,  Train X Loss = 0.00000, Val Loss = 18.33693
Change mask ratio: 0.0
Early stopping at epoch: 120
Best at epoch 108:
Train Loss = 16.98500
Train RMSE = 29.87201, MAE = 17.27048, MAPE = 7.54822
Val Loss = 18.33349
Val RMSE = 32.35349, MAE = 18.85609, MAPE = 8.21439
--------- Test ---------
All Steps RMSE = 32.59361, MAE = 19.10277, MAPE = 7.97137
Step 1 RMSE = 26.90248, MAE = 16.41809, MAPE = 6.89288
Step 2 RMSE = 28.87153, MAE = 17.27858, MAPE = 7.23709
Step 3 RMSE = 30.17680, MAE = 17.90039, MAPE = 7.47512
Step 4 RMSE = 31.18071, MAE = 18.38851, MAPE = 7.66409
Step 5 RMSE = 32.01427, MAE = 18.80332, MAPE = 7.83004
Step 6 RMSE = 32.73255, MAE = 19.16922, MAPE = 7.97598
Step 7 RMSE = 33.36782, MAE = 19.50223, MAPE = 8.11191
Step 8 RMSE = 33.92794, MAE = 19.80012, MAPE = 8.23829
Step 9 RMSE = 34.45045, MAE = 20.07948, MAPE = 8.36386
Step 10 RMSE = 34.92916, MAE = 20.34594, MAPE = 8.48140
Step 11 RMSE = 35.40272, MAE = 20.62437, MAPE = 8.61828
Step 12 RMSE = 35.87116, MAE = 20.92067, MAPE = 8.76654
Inference time: 27.37 s
