PEMS04
--------- DMRCMLP ---------
{
    "num_nodes": 307,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0005,
    "milestones": [
        20,
        35,
        55
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 150,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 93048409,
    "gpu": [
        1
    ],
    "save": false,
    "model_args": {
        "num_nodes": 307,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        390,540
├─Linear: 1-1                                 [16, 12, 307, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 307, 48]         --
│    └─Embedding: 2-1                         [16, 12, 307, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 307, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 307, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 307, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 307, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 307, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 307, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 307, 144]        158,224
├─Predictor: 1-4                              [16, 12, 307, 1]          --
│    └─Linear: 2-5                            [16, 12, 307, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 307, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 307, 144]        41,760
│    └─Linear: 2-7                            [16, 307, 12]             20,748
===============================================================================================
Total params: 1,155,712
Trainable params: 1,155,712
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 0.71
Forward/backward pass size (MB): 2758.11
Params size (MB): 3.06
Estimated Total Size (MB): 2761.88
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS04-2025-01-17-17-11-30.pt
2025-01-17 17:12:39.738882 Epoch 1, Train Y Loss = 28.63281,  Train X Loss = 0.00000, Val Loss = 24.79732
2025-01-17 17:13:49.197576 Epoch 2, Train Y Loss = 22.51633,  Train X Loss = 0.00000, Val Loss = 22.63926
2025-01-17 17:14:58.072161 Epoch 3, Train Y Loss = 21.17914,  Train X Loss = 0.00000, Val Loss = 21.28951
2025-01-17 17:16:07.640742 Epoch 4, Train Y Loss = 20.30124,  Train X Loss = 0.00000, Val Loss = 20.47647
2025-01-17 17:17:16.773879 Epoch 5, Train Y Loss = 19.89457,  Train X Loss = 0.00000, Val Loss = 19.74233
2025-01-17 17:18:26.232808 Epoch 6, Train Y Loss = 19.19443,  Train X Loss = 0.00000, Val Loss = 19.30327
2025-01-17 17:19:34.541165 Epoch 7, Train Y Loss = 18.92373,  Train X Loss = 0.00000, Val Loss = 20.12913
2025-01-17 17:20:42.927464 Epoch 8, Train Y Loss = 18.72109,  Train X Loss = 0.00000, Val Loss = 19.85392
2025-01-17 17:21:52.033594 Epoch 9, Train Y Loss = 18.41672,  Train X Loss = 0.00000, Val Loss = 18.96480
2025-01-17 17:23:01.544198 Epoch 10, Train Y Loss = 18.13471,  Train X Loss = 0.00000, Val Loss = 19.06149
2025-01-17 17:24:11.075909 Epoch 11, Train Y Loss = 18.06654,  Train X Loss = 0.00000, Val Loss = 18.76702
2025-01-17 17:25:19.510765 Epoch 12, Train Y Loss = 17.87829,  Train X Loss = 0.00000, Val Loss = 19.06041
2025-01-17 17:26:28.155114 Epoch 13, Train Y Loss = 17.79904,  Train X Loss = 0.00000, Val Loss = 18.46679
2025-01-17 17:27:37.643328 Epoch 14, Train Y Loss = 17.66594,  Train X Loss = 0.00000, Val Loss = 18.35877
2025-01-17 17:28:47.456532 Epoch 15, Train Y Loss = 17.52750,  Train X Loss = 0.00000, Val Loss = 18.26681
2025-01-17 17:29:57.017510 Epoch 16, Train Y Loss = 17.62821,  Train X Loss = 0.00000, Val Loss = 18.54167
2025-01-17 17:31:06.186113 Epoch 17, Train Y Loss = 17.28626,  Train X Loss = 0.00000, Val Loss = 18.39833
2025-01-17 17:32:15.655715 Epoch 18, Train Y Loss = 17.34068,  Train X Loss = 0.00000, Val Loss = 18.51154
2025-01-17 17:33:25.405153 Epoch 19, Train Y Loss = 17.16067,  Train X Loss = 0.00000, Val Loss = 18.57173
2025-01-17 17:34:34.199501 Epoch 20, Train Y Loss = 17.13589,  Train X Loss = 0.00000, Val Loss = 18.33304
2025-01-17 17:35:43.472490 Epoch 21, Train Y Loss = 16.53838,  Train X Loss = 0.00000, Val Loss = 17.77857
2025-01-17 17:36:53.228309 Epoch 22, Train Y Loss = 16.43151,  Train X Loss = 0.00000, Val Loss = 17.74066
2025-01-17 17:38:01.362214 Epoch 23, Train Y Loss = 16.38556,  Train X Loss = 0.00000, Val Loss = 17.70730
2025-01-17 17:39:10.395278 Epoch 24, Train Y Loss = 16.36142,  Train X Loss = 0.00000, Val Loss = 17.71920
2025-01-17 17:40:19.267143 Epoch 25, Train Y Loss = 16.33061,  Train X Loss = 0.00000, Val Loss = 17.80317
2025-01-17 17:41:28.108322 Epoch 26, Train Y Loss = 16.31053,  Train X Loss = 0.00000, Val Loss = 17.78384
2025-01-17 17:42:37.414844 Epoch 27, Train Y Loss = 16.28635,  Train X Loss = 0.00000, Val Loss = 17.77221
2025-01-17 17:43:46.487161 Epoch 28, Train Y Loss = 16.25633,  Train X Loss = 0.00000, Val Loss = 17.71483
2025-01-17 17:44:55.280241 Epoch 29, Train Y Loss = 16.23067,  Train X Loss = 0.00000, Val Loss = 17.73885
2025-01-17 17:46:03.360585 Epoch 30, Train Y Loss = 16.21699,  Train X Loss = 0.00000, Val Loss = 17.67079
2025-01-17 17:47:12.516685 Epoch 31, Train Y Loss = 16.19413,  Train X Loss = 0.00000, Val Loss = 17.77272
2025-01-17 17:48:20.824394 Epoch 32, Train Y Loss = 16.18137,  Train X Loss = 0.00000, Val Loss = 17.70243
2025-01-17 17:49:29.530920 Epoch 33, Train Y Loss = 16.16479,  Train X Loss = 0.00000, Val Loss = 17.81247
2025-01-17 17:50:39.275797 Epoch 34, Train Y Loss = 16.14633,  Train X Loss = 0.00000, Val Loss = 17.72959
2025-01-17 17:51:47.702288 Epoch 35, Train Y Loss = 16.12106,  Train X Loss = 0.00000, Val Loss = 17.77382
2025-01-17 17:52:57.402226 Epoch 36, Train Y Loss = 16.05034,  Train X Loss = 0.00000, Val Loss = 17.70574
2025-01-17 17:54:06.460791 Epoch 37, Train Y Loss = 16.04630,  Train X Loss = 0.00000, Val Loss = 17.71652
2025-01-17 17:55:15.210882 Epoch 38, Train Y Loss = 16.03965,  Train X Loss = 0.00000, Val Loss = 17.71102
Change mask ratio: 0.075
2025-01-17 17:56:22.268332 Epoch 39, Train Y Loss = 15.95742,  Train X Loss = 0.00000, Val Loss = 17.60973
2025-01-17 17:57:30.022238 Epoch 40, Train Y Loss = 15.94999,  Train X Loss = 0.00000, Val Loss = 17.61384
2025-01-17 17:58:37.796467 Epoch 41, Train Y Loss = 15.95282,  Train X Loss = 0.00000, Val Loss = 17.61414
2025-01-17 17:59:45.451978 Epoch 42, Train Y Loss = 15.94445,  Train X Loss = 0.00000, Val Loss = 17.61363
2025-01-17 18:00:53.063906 Epoch 43, Train Y Loss = 15.94044,  Train X Loss = 0.00000, Val Loss = 17.60970
2025-01-17 18:02:00.826158 Epoch 44, Train Y Loss = 15.94142,  Train X Loss = 0.00000, Val Loss = 17.62034
2025-01-17 18:03:08.831886 Epoch 45, Train Y Loss = 15.93293,  Train X Loss = 0.00000, Val Loss = 17.63330
2025-01-17 18:04:15.557293 Epoch 46, Train Y Loss = 15.93602,  Train X Loss = 0.00000, Val Loss = 17.62683
2025-01-17 18:05:23.691552 Epoch 47, Train Y Loss = 15.92852,  Train X Loss = 0.00000, Val Loss = 17.62540
2025-01-17 18:06:31.142124 Epoch 48, Train Y Loss = 15.92615,  Train X Loss = 0.00000, Val Loss = 17.63117
2025-01-17 18:07:39.458671 Epoch 49, Train Y Loss = 15.93067,  Train X Loss = 0.00000, Val Loss = 17.63162
2025-01-17 18:08:47.661433 Epoch 50, Train Y Loss = 15.92054,  Train X Loss = 0.00000, Val Loss = 17.64232
2025-01-17 18:09:55.520704 Epoch 51, Train Y Loss = 15.92163,  Train X Loss = 0.00000, Val Loss = 17.63459
Change mask ratio: 0.0375
2025-01-17 18:11:02.860183 Epoch 52, Train Y Loss = 15.87794,  Train X Loss = 0.00000, Val Loss = 17.60787
2025-01-17 18:12:10.363098 Epoch 53, Train Y Loss = 15.87095,  Train X Loss = 0.00000, Val Loss = 17.62132
2025-01-17 18:13:18.038089 Epoch 54, Train Y Loss = 15.87227,  Train X Loss = 0.00000, Val Loss = 17.60744
2025-01-17 18:14:25.949103 Epoch 55, Train Y Loss = 15.87108,  Train X Loss = 0.00000, Val Loss = 17.61676
2025-01-17 18:15:33.369499 Epoch 56, Train Y Loss = 15.86373,  Train X Loss = 0.00000, Val Loss = 17.61512
2025-01-17 18:16:40.919171 Epoch 57, Train Y Loss = 15.86397,  Train X Loss = 0.00000, Val Loss = 17.61352
2025-01-17 18:17:48.392442 Epoch 58, Train Y Loss = 15.86606,  Train X Loss = 0.00000, Val Loss = 17.61801
2025-01-17 18:18:56.294030 Epoch 59, Train Y Loss = 15.85785,  Train X Loss = 0.00000, Val Loss = 17.61171
2025-01-17 18:20:03.889660 Epoch 60, Train Y Loss = 15.85910,  Train X Loss = 0.00000, Val Loss = 17.61521
2025-01-17 18:21:11.294553 Epoch 61, Train Y Loss = 15.86391,  Train X Loss = 0.00000, Val Loss = 17.61435
2025-01-17 18:22:18.347269 Epoch 62, Train Y Loss = 15.86038,  Train X Loss = 0.00000, Val Loss = 17.61178
Change mask ratio: 0.0
2025-01-17 18:23:17.495774 Epoch 63, Train Y Loss = 15.82575,  Train X Loss = 0.00000, Val Loss = 17.59544
2025-01-17 18:24:16.764873 Epoch 64, Train Y Loss = 15.82683,  Train X Loss = 0.00000, Val Loss = 17.59012
2025-01-17 18:25:15.953895 Epoch 65, Train Y Loss = 15.82658,  Train X Loss = 0.00000, Val Loss = 17.59541
2025-01-17 18:26:15.070532 Epoch 66, Train Y Loss = 15.82718,  Train X Loss = 0.00000, Val Loss = 17.58932
2025-01-17 18:27:14.386286 Epoch 67, Train Y Loss = 15.82436,  Train X Loss = 0.00000, Val Loss = 17.59429
2025-01-17 18:28:13.675038 Epoch 68, Train Y Loss = 15.82635,  Train X Loss = 0.00000, Val Loss = 17.59760
2025-01-17 18:29:12.787604 Epoch 69, Train Y Loss = 15.82449,  Train X Loss = 0.00000, Val Loss = 17.59538
2025-01-17 18:30:11.786294 Epoch 70, Train Y Loss = 15.82494,  Train X Loss = 0.00000, Val Loss = 17.59494
2025-01-17 18:31:10.657461 Epoch 71, Train Y Loss = 15.82426,  Train X Loss = 0.00000, Val Loss = 17.59541
2025-01-17 18:32:09.995535 Epoch 72, Train Y Loss = 15.82375,  Train X Loss = 0.00000, Val Loss = 17.59555
2025-01-17 18:33:09.347728 Epoch 73, Train Y Loss = 15.82109,  Train X Loss = 0.00000, Val Loss = 17.59201
2025-01-17 18:34:08.411835 Epoch 74, Train Y Loss = 15.82251,  Train X Loss = 0.00000, Val Loss = 17.59827
Change mask ratio: 0.0
2025-01-17 18:35:07.420028 Epoch 75, Train Y Loss = 15.81791,  Train X Loss = 0.00000, Val Loss = 17.59224
2025-01-17 18:36:06.536666 Epoch 76, Train Y Loss = 15.82041,  Train X Loss = 0.00000, Val Loss = 17.59767
2025-01-17 18:37:05.766238 Epoch 77, Train Y Loss = 15.82338,  Train X Loss = 0.00000, Val Loss = 17.59247
2025-01-17 18:38:04.802306 Epoch 78, Train Y Loss = 15.82218,  Train X Loss = 0.00000, Val Loss = 17.59643
2025-01-17 18:39:03.942834 Epoch 79, Train Y Loss = 15.81829,  Train X Loss = 0.00000, Val Loss = 17.59928
2025-01-17 18:40:03.202403 Epoch 80, Train Y Loss = 15.81693,  Train X Loss = 0.00000, Val Loss = 17.60056
2025-01-17 18:41:02.468805 Epoch 81, Train Y Loss = 15.81966,  Train X Loss = 0.00000, Val Loss = 17.59982
2025-01-17 18:42:01.694022 Epoch 82, Train Y Loss = 15.81986,  Train X Loss = 0.00000, Val Loss = 17.59596
Change mask ratio: 0.0
2025-01-17 18:43:00.936959 Epoch 83, Train Y Loss = 15.81312,  Train X Loss = 0.00000, Val Loss = 17.59523
2025-01-17 18:44:00.217570 Epoch 84, Train Y Loss = 15.81763,  Train X Loss = 0.00000, Val Loss = 17.60292
2025-01-17 18:44:59.584473 Epoch 85, Train Y Loss = 15.81055,  Train X Loss = 0.00000, Val Loss = 17.59707
2025-01-17 18:45:58.867980 Epoch 86, Train Y Loss = 15.81616,  Train X Loss = 0.00000, Val Loss = 17.59742
2025-01-17 18:46:57.674459 Epoch 87, Train Y Loss = 15.81664,  Train X Loss = 0.00000, Val Loss = 17.59821
2025-01-17 18:47:57.024829 Epoch 88, Train Y Loss = 15.81938,  Train X Loss = 0.00000, Val Loss = 17.60116
2025-01-17 18:48:55.827124 Epoch 89, Train Y Loss = 15.81403,  Train X Loss = 0.00000, Val Loss = 17.60108
2025-01-17 18:49:55.087854 Epoch 90, Train Y Loss = 15.81443,  Train X Loss = 0.00000, Val Loss = 17.59922
Change mask ratio: 0.0
2025-01-17 18:50:54.367731 Epoch 91, Train Y Loss = 15.81172,  Train X Loss = 0.00000, Val Loss = 17.59854
2025-01-17 18:51:53.281769 Epoch 92, Train Y Loss = 15.81335,  Train X Loss = 0.00000, Val Loss = 17.60125
2025-01-17 18:52:52.406210 Epoch 93, Train Y Loss = 15.81283,  Train X Loss = 0.00000, Val Loss = 17.60009
2025-01-17 18:53:51.605000 Epoch 94, Train Y Loss = 15.80665,  Train X Loss = 0.00000, Val Loss = 17.60454
2025-01-17 18:54:50.623668 Epoch 95, Train Y Loss = 15.80880,  Train X Loss = 0.00000, Val Loss = 17.60245
2025-01-17 18:55:49.521698 Epoch 96, Train Y Loss = 15.81323,  Train X Loss = 0.00000, Val Loss = 17.60640
Early stopping at epoch: 96
Best at epoch 66:
Train Loss = 15.82718
Train RMSE = 27.36075, MAE = 16.34332, MAPE = 11.69956
Val Loss = 17.58932
Val RMSE = 30.64294, MAE = 18.25082, MAPE = 11.70909
--------- Test ---------
All Steps RMSE = 30.40799, MAE = 18.28230, MAPE = 11.95276
Step 1 RMSE = 27.06139, MAE = 16.60280, MAPE = 10.94869
Step 2 RMSE = 28.16281, MAE = 17.12699, MAPE = 11.31429
Step 3 RMSE = 29.00020, MAE = 17.53790, MAPE = 11.55576
Step 4 RMSE = 29.63368, MAE = 17.85113, MAPE = 11.72425
Step 5 RMSE = 30.14361, MAE = 18.10566, MAPE = 11.85441
Step 6 RMSE = 30.55769, MAE = 18.32463, MAPE = 11.96302
Step 7 RMSE = 30.93608, MAE = 18.53032, MAPE = 12.07694
Step 8 RMSE = 31.25171, MAE = 18.70971, MAPE = 12.17583
Step 9 RMSE = 31.53114, MAE = 18.88323, MAPE = 12.28598
Step 10 RMSE = 31.77861, MAE = 19.05185, MAPE = 12.38806
Step 11 RMSE = 32.03740, MAE = 19.22780, MAPE = 12.50382
Step 12 RMSE = 32.31836, MAE = 19.43528, MAPE = 12.64205
Inference time: 6.15 s
