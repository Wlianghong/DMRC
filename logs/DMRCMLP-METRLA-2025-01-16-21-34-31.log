METRLA
--------- DMRCMLP ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0003,
    "milestones": [
        25,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 20436023,
    "gpu": [
        0
    ],
    "save": false,
    "model_args": {
        "num_nodes": 207,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        283,260
├─Linear: 1-1                                 [16, 12, 207, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 207, 48]         --
│    └─Embedding: 2-1                         [16, 12, 207, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 207, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 207, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 207, 144]        158,224
├─Predictor: 1-4                              [16, 12, 207, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 207, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 207, 144]        41,760
│    └─Linear: 2-6                            [16, 207, 12]             20,748
===============================================================================================
Total params: 1,027,552
Trainable params: 1,027,552
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.48
Forward/backward pass size (MB): 1813.92
Params size (MB): 2.98
Estimated Total Size (MB): 1817.37
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-METRLA-2025-01-16-21-34-31.pt
2025-01-16 21:36:17.300976 Epoch 1, Train Y Loss = 4.11408,  Train X Loss = 2.65981, Val Loss = 3.27742
2025-01-16 21:37:52.257879 Epoch 2, Train Y Loss = 3.42537,  Train X Loss = 2.27012, Val Loss = 3.18813
2025-01-16 21:39:38.721577 Epoch 3, Train Y Loss = 3.27008,  Train X Loss = 2.21746, Val Loss = 3.00071
2025-01-16 21:41:24.424900 Epoch 4, Train Y Loss = 3.15476,  Train X Loss = 2.19201, Val Loss = 2.97612
2025-01-16 21:42:56.992525 Epoch 5, Train Y Loss = 3.08429,  Train X Loss = 2.16962, Val Loss = 2.89306
2025-01-16 21:44:30.439994 Epoch 6, Train Y Loss = 3.04533,  Train X Loss = 2.05359, Val Loss = 2.86943
2025-01-16 21:46:16.832378 Epoch 7, Train Y Loss = 2.99318,  Train X Loss = 1.97802, Val Loss = 2.87123
2025-01-16 21:48:03.031149 Epoch 8, Train Y Loss = 2.96731,  Train X Loss = 1.95390, Val Loss = 2.87319
2025-01-16 21:49:36.476575 Epoch 9, Train Y Loss = 2.94474,  Train X Loss = 1.94171, Val Loss = 2.80060
2025-01-16 21:51:22.760587 Epoch 10, Train Y Loss = 2.92988,  Train X Loss = 1.93179, Val Loss = 2.78456
2025-01-16 21:53:09.261553 Epoch 11, Train Y Loss = 2.91514,  Train X Loss = 1.92133, Val Loss = 2.78430
2025-01-16 21:54:43.884656 Epoch 12, Train Y Loss = 2.90548,  Train X Loss = 1.91351, Val Loss = 2.76532
2025-01-16 21:56:30.609137 Epoch 13, Train Y Loss = 2.89369,  Train X Loss = 1.90494, Val Loss = 2.75230
2025-01-16 21:58:17.398566 Epoch 14, Train Y Loss = 2.88822,  Train X Loss = 1.90331, Val Loss = 2.73913
2025-01-16 21:59:52.160613 Epoch 15, Train Y Loss = 2.88079,  Train X Loss = 1.89728, Val Loss = 2.75960
2025-01-16 22:01:38.578521 Epoch 16, Train Y Loss = 2.87353,  Train X Loss = 1.89247, Val Loss = 2.77963
2025-01-16 22:03:24.977330 Epoch 17, Train Y Loss = 2.86633,  Train X Loss = 1.88826, Val Loss = 2.74580
2025-01-16 22:04:59.605738 Epoch 18, Train Y Loss = 2.85871,  Train X Loss = 1.88230, Val Loss = 2.75385
2025-01-16 22:06:46.420648 Epoch 19, Train Y Loss = 2.85341,  Train X Loss = 1.88200, Val Loss = 2.75919
2025-01-16 22:08:33.216103 Epoch 20, Train Y Loss = 2.85099,  Train X Loss = 1.87830, Val Loss = 2.74034
2025-01-16 22:10:06.756696 Epoch 21, Train Y Loss = 2.84441,  Train X Loss = 1.87297, Val Loss = 2.73579
2025-01-16 22:11:41.531968 Epoch 22, Train Y Loss = 2.83976,  Train X Loss = 1.87150, Val Loss = 2.73999
2025-01-16 22:13:28.289079 Epoch 23, Train Y Loss = 2.83615,  Train X Loss = 1.87081, Val Loss = 2.74477
2025-01-16 22:15:08.925016 Epoch 24, Train Y Loss = 2.83176,  Train X Loss = 1.86652, Val Loss = 2.71008
2025-01-16 22:16:49.500391 Epoch 25, Train Y Loss = 2.82739,  Train X Loss = 1.86635, Val Loss = 2.71815
2025-01-16 22:18:36.158816 Epoch 26, Train Y Loss = 2.74918,  Train X Loss = 1.82699, Val Loss = 2.67264
2025-01-16 22:20:15.129820 Epoch 27, Train Y Loss = 2.73850,  Train X Loss = 1.82031, Val Loss = 2.67037
2025-01-16 22:21:57.609957 Epoch 28, Train Y Loss = 2.73289,  Train X Loss = 1.81863, Val Loss = 2.67029
2025-01-16 22:23:44.256038 Epoch 29, Train Y Loss = 2.72812,  Train X Loss = 1.81668, Val Loss = 2.66491
2025-01-16 22:25:22.126766 Epoch 30, Train Y Loss = 2.72631,  Train X Loss = 1.81454, Val Loss = 2.67046
2025-01-16 22:27:05.589549 Epoch 31, Train Y Loss = 2.72226,  Train X Loss = 1.81499, Val Loss = 2.66726
2025-01-16 22:28:52.257757 Epoch 32, Train Y Loss = 2.72012,  Train X Loss = 1.81283, Val Loss = 2.66971
2025-01-16 22:30:29.675617 Epoch 33, Train Y Loss = 2.71814,  Train X Loss = 1.81291, Val Loss = 2.67308
2025-01-16 22:32:13.538514 Epoch 34, Train Y Loss = 2.71664,  Train X Loss = 1.81135, Val Loss = 2.66672
2025-01-16 22:34:00.453000 Epoch 35, Train Y Loss = 2.71463,  Train X Loss = 1.81184, Val Loss = 2.67152
2025-01-16 22:35:36.753086 Epoch 36, Train Y Loss = 2.70286,  Train X Loss = 1.80750, Val Loss = 2.66123
2025-01-16 22:37:20.790342 Epoch 37, Train Y Loss = 2.70031,  Train X Loss = 1.80668, Val Loss = 2.66310
2025-01-16 22:38:54.577805 Epoch 38, Train Y Loss = 2.70085,  Train X Loss = 1.80661, Val Loss = 2.66111
2025-01-16 22:40:41.834611 Epoch 39, Train Y Loss = 2.70075,  Train X Loss = 1.80569, Val Loss = 2.66181
2025-01-16 22:42:16.073920 Epoch 40, Train Y Loss = 2.69949,  Train X Loss = 1.80620, Val Loss = 2.66269
2025-01-16 22:44:02.837443 Epoch 41, Train Y Loss = 2.69854,  Train X Loss = 1.80467, Val Loss = 2.66037
2025-01-16 22:45:49.455839 Epoch 42, Train Y Loss = 2.69807,  Train X Loss = 1.80568, Val Loss = 2.66022
2025-01-16 22:47:23.591608 Epoch 43, Train Y Loss = 2.69863,  Train X Loss = 1.80538, Val Loss = 2.65974
2025-01-16 22:49:10.615199 Epoch 44, Train Y Loss = 2.69780,  Train X Loss = 1.80431, Val Loss = 2.66016
2025-01-16 22:50:57.470729 Epoch 45, Train Y Loss = 2.69695,  Train X Loss = 1.80550, Val Loss = 2.66055
2025-01-16 22:52:31.624995 Epoch 46, Train Y Loss = 2.69662,  Train X Loss = 1.80416, Val Loss = 2.66066
2025-01-16 22:54:17.633934 Epoch 47, Train Y Loss = 2.69664,  Train X Loss = 1.80607, Val Loss = 2.65891
2025-01-16 22:56:03.917041 Epoch 48, Train Y Loss = 2.69718,  Train X Loss = 1.80562, Val Loss = 2.66002
2025-01-16 22:57:40.560701 Epoch 49, Train Y Loss = 2.69583,  Train X Loss = 1.80561, Val Loss = 2.66126
2025-01-16 22:59:26.905899 Epoch 50, Train Y Loss = 2.69537,  Train X Loss = 1.80240, Val Loss = 2.66096
2025-01-16 23:01:11.540872 Epoch 51, Train Y Loss = 2.69522,  Train X Loss = 1.80412, Val Loss = 2.65809
2025-01-16 23:02:48.550582 Epoch 52, Train Y Loss = 2.69511,  Train X Loss = 1.80572, Val Loss = 2.66080
2025-01-16 23:04:34.525267 Epoch 53, Train Y Loss = 2.69529,  Train X Loss = 1.80426, Val Loss = 2.66091
2025-01-16 23:06:08.201510 Epoch 54, Train Y Loss = 2.69486,  Train X Loss = 1.80307, Val Loss = 2.65821
2025-01-16 23:07:48.233388 Epoch 55, Train Y Loss = 2.69487,  Train X Loss = 1.80354, Val Loss = 2.65851
2025-01-16 23:09:29.313293 Epoch 56, Train Y Loss = 2.69504,  Train X Loss = 1.80452, Val Loss = 2.66013
2025-01-16 23:11:15.233791 Epoch 57, Train Y Loss = 2.69384,  Train X Loss = 1.80521, Val Loss = 2.65784
2025-01-16 23:12:54.930284 Epoch 58, Train Y Loss = 2.69414,  Train X Loss = 1.80277, Val Loss = 2.66118
2025-01-16 23:14:36.181280 Epoch 59, Train Y Loss = 2.69311,  Train X Loss = 1.80411, Val Loss = 2.66065
2025-01-16 23:16:22.649578 Epoch 60, Train Y Loss = 2.69316,  Train X Loss = 1.80253, Val Loss = 2.65869
2025-01-16 23:18:01.567605 Epoch 61, Train Y Loss = 2.69378,  Train X Loss = 1.80467, Val Loss = 2.66212
2025-01-16 23:19:44.743750 Epoch 62, Train Y Loss = 2.69170,  Train X Loss = 1.80372, Val Loss = 2.65997
2025-01-16 23:21:31.183603 Epoch 63, Train Y Loss = 2.69128,  Train X Loss = 1.80249, Val Loss = 2.66002
2025-01-16 23:23:08.110576 Epoch 64, Train Y Loss = 2.69131,  Train X Loss = 1.80164, Val Loss = 2.65877
2025-01-16 23:24:52.185415 Epoch 65, Train Y Loss = 2.69186,  Train X Loss = 1.80338, Val Loss = 2.66064
Change mask ratio: 0.075
2025-01-16 23:26:38.081988 Epoch 66, Train Y Loss = 2.67808,  Train X Loss = 0.88169, Val Loss = 2.65402
2025-01-16 23:28:12.900501 Epoch 67, Train Y Loss = 2.67760,  Train X Loss = 0.88138, Val Loss = 2.65478
2025-01-16 23:29:57.781706 Epoch 68, Train Y Loss = 2.67704,  Train X Loss = 0.88177, Val Loss = 2.65422
2025-01-16 23:31:43.849735 Epoch 69, Train Y Loss = 2.67731,  Train X Loss = 0.88214, Val Loss = 2.65402
2025-01-16 23:33:16.621913 Epoch 70, Train Y Loss = 2.67564,  Train X Loss = 0.88381, Val Loss = 2.65172
2025-01-16 23:34:49.755419 Epoch 71, Train Y Loss = 2.67565,  Train X Loss = 0.88251, Val Loss = 2.65103
2025-01-16 23:36:35.950419 Epoch 72, Train Y Loss = 2.67373,  Train X Loss = 0.88357, Val Loss = 2.65329
2025-01-16 23:38:21.378580 Epoch 73, Train Y Loss = 2.67438,  Train X Loss = 0.88325, Val Loss = 2.64970
2025-01-16 23:39:55.669980 Epoch 74, Train Y Loss = 2.67306,  Train X Loss = 0.88268, Val Loss = 2.65176
2025-01-16 23:41:41.686649 Epoch 75, Train Y Loss = 2.67282,  Train X Loss = 0.88277, Val Loss = 2.65269
2025-01-16 23:43:24.559272 Epoch 76, Train Y Loss = 2.67343,  Train X Loss = 0.88291, Val Loss = 2.65306
2025-01-16 23:45:01.235609 Epoch 77, Train Y Loss = 2.67271,  Train X Loss = 0.88230, Val Loss = 2.65077
2025-01-16 23:46:47.755964 Epoch 78, Train Y Loss = 2.67238,  Train X Loss = 0.88316, Val Loss = 2.65196
2025-01-16 23:48:30.230606 Epoch 79, Train Y Loss = 2.67194,  Train X Loss = 0.88321, Val Loss = 2.65132
2025-01-16 23:50:07.585548 Epoch 80, Train Y Loss = 2.67110,  Train X Loss = 0.88461, Val Loss = 2.65194
2025-01-16 23:51:53.190581 Epoch 81, Train Y Loss = 2.67107,  Train X Loss = 0.88271, Val Loss = 2.65165
Change mask ratio: 0.0375
2025-01-16 23:53:31.298893 Epoch 82, Train Y Loss = 2.66322,  Train X Loss = 0.43752, Val Loss = 2.65047
2025-01-16 23:55:12.267054 Epoch 83, Train Y Loss = 2.66379,  Train X Loss = 0.43707, Val Loss = 2.64731
2025-01-16 23:56:58.673093 Epoch 84, Train Y Loss = 2.66188,  Train X Loss = 0.43777, Val Loss = 2.64797
2025-01-16 23:58:33.134286 Epoch 85, Train Y Loss = 2.66196,  Train X Loss = 0.43791, Val Loss = 2.64948
2025-01-17 00:00:17.424658 Epoch 86, Train Y Loss = 2.66093,  Train X Loss = 0.43764, Val Loss = 2.64808
2025-01-17 00:01:51.160121 Epoch 87, Train Y Loss = 2.66030,  Train X Loss = 0.43839, Val Loss = 2.64769
2025-01-17 00:03:36.647595 Epoch 88, Train Y Loss = 2.65998,  Train X Loss = 0.43817, Val Loss = 2.64843
2025-01-17 00:05:11.110739 Epoch 89, Train Y Loss = 2.65918,  Train X Loss = 0.43810, Val Loss = 2.64922
2025-01-17 00:06:56.499391 Epoch 90, Train Y Loss = 2.65878,  Train X Loss = 0.43730, Val Loss = 2.64968
2025-01-17 00:08:37.861369 Epoch 91, Train Y Loss = 2.65897,  Train X Loss = 0.43913, Val Loss = 2.64757
Change mask ratio: 0.0
2025-01-17 00:10:08.122173 Epoch 92, Train Y Loss = 2.65071,  Train X Loss = 0.00000, Val Loss = 2.64519
2025-01-17 00:11:43.501039 Epoch 93, Train Y Loss = 2.65074,  Train X Loss = 0.00000, Val Loss = 2.64401
2025-01-17 00:13:14.290870 Epoch 94, Train Y Loss = 2.64871,  Train X Loss = 0.00000, Val Loss = 2.64555
2025-01-17 00:14:49.245499 Epoch 95, Train Y Loss = 2.64836,  Train X Loss = 0.00000, Val Loss = 2.64734
2025-01-17 00:16:19.648646 Epoch 96, Train Y Loss = 2.64700,  Train X Loss = 0.00000, Val Loss = 2.64467
2025-01-17 00:17:55.469230 Epoch 97, Train Y Loss = 2.64671,  Train X Loss = 0.00000, Val Loss = 2.64475
2025-01-17 00:19:24.780833 Epoch 98, Train Y Loss = 2.64481,  Train X Loss = 0.00000, Val Loss = 2.64373
2025-01-17 00:21:00.842403 Epoch 99, Train Y Loss = 2.64431,  Train X Loss = 0.00000, Val Loss = 2.64700
2025-01-17 00:22:29.798991 Epoch 100, Train Y Loss = 2.64438,  Train X Loss = 0.00000, Val Loss = 2.64552
Early stopping at epoch: 100
Best at epoch 98:
Train Loss = 2.64481
Train RMSE = 5.24070, MAE = 2.61404, MAPE = 6.81455
Val Loss = 2.64373
Val RMSE = 5.56343, MAE = 2.69531, MAPE = 7.30287
--------- Test ---------
All Steps RMSE = 5.88724, MAE = 2.89280, MAPE = 7.85844
Step 1 RMSE = 3.71556, MAE = 2.13912, MAPE = 5.03433
Step 2 RMSE = 4.47082, MAE = 2.42267, MAPE = 5.97336
Step 3 RMSE = 4.98271, MAE = 2.60471, MAPE = 6.64018
Step 4 RMSE = 5.36564, MAE = 2.73911, MAPE = 7.16829
Step 5 RMSE = 5.67329, MAE = 2.84571, MAPE = 7.61423
Step 6 RMSE = 5.93691, MAE = 2.93629, MAPE = 7.98662
Step 7 RMSE = 6.16790, MAE = 3.01571, MAPE = 8.32227
Step 8 RMSE = 6.36617, MAE = 3.08500, MAPE = 8.62019
Step 9 RMSE = 6.53909, MAE = 3.14902, MAPE = 8.88653
Step 10 RMSE = 6.69160, MAE = 3.20616, MAPE = 9.13191
Step 11 RMSE = 6.82505, MAE = 3.25790, MAPE = 9.35211
Step 12 RMSE = 6.95576, MAE = 3.31222, MAPE = 9.57150
Inference time: 7.74 s
