PEMSBAY
--------- DMRCMLP ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        15,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 34110658,
    "gpu": [
        6
    ],
    "save": false,
    "model_args": {
        "num_nodes": 325,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        385,212
├─Linear: 1-1                                 [16, 12, 325, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 325, 48]         --
│    └─Embedding: 2-1                         [16, 12, 325, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 325, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 325, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 325, 144]        158,224
├─Predictor: 1-4                              [16, 12, 325, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 325, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 325, 144]        41,760
│    └─Linear: 2-6                            [16, 325, 12]             20,748
===============================================================================================
Total params: 1,129,504
Trainable params: 1,129,504
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.75
Forward/backward pass size (MB): 2847.94
Params size (MB): 2.98
Estimated Total Size (MB): 2851.66
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMSBAY-2025-01-18-23-12-07.pt
2025-01-18 23:15:46.064097 Epoch 1, Train Y Loss = 2.04875,  Train X Loss = 1.00371, Val Loss = 1.99704
2025-01-18 23:19:24.719316 Epoch 2, Train Y Loss = 1.71859,  Train X Loss = 0.81201, Val Loss = 1.77117
2025-01-18 23:23:03.055766 Epoch 3, Train Y Loss = 1.63031,  Train X Loss = 0.78081, Val Loss = 1.78197
2025-01-18 23:26:40.862306 Epoch 4, Train Y Loss = 1.58198,  Train X Loss = 0.76684, Val Loss = 1.70899
2025-01-18 23:30:19.378853 Epoch 5, Train Y Loss = 1.55447,  Train X Loss = 0.72303, Val Loss = 1.74681
2025-01-18 23:33:58.047312 Epoch 6, Train Y Loss = 1.53241,  Train X Loss = 0.67841, Val Loss = 1.65768
2025-01-18 23:37:36.092273 Epoch 7, Train Y Loss = 1.51002,  Train X Loss = 0.66345, Val Loss = 1.62251
2025-01-18 23:41:14.261048 Epoch 8, Train Y Loss = 1.49612,  Train X Loss = 0.65431, Val Loss = 1.61405
2025-01-18 23:44:51.871462 Epoch 9, Train Y Loss = 1.48482,  Train X Loss = 0.65011, Val Loss = 1.60798
2025-01-18 23:48:29.516640 Epoch 10, Train Y Loss = 1.47695,  Train X Loss = 0.64767, Val Loss = 1.59855
2025-01-18 23:52:07.237030 Epoch 11, Train Y Loss = 1.46836,  Train X Loss = 0.64466, Val Loss = 1.59708
2025-01-18 23:55:44.824863 Epoch 12, Train Y Loss = 1.46074,  Train X Loss = 0.64167, Val Loss = 1.61793
2025-01-18 23:59:22.055114 Epoch 13, Train Y Loss = 1.45488,  Train X Loss = 0.63989, Val Loss = 1.60842
2025-01-19 00:02:59.618569 Epoch 14, Train Y Loss = 1.44967,  Train X Loss = 0.63755, Val Loss = 1.57642
2025-01-19 00:06:37.332511 Epoch 15, Train Y Loss = 1.44595,  Train X Loss = 0.63590, Val Loss = 1.58013
2025-01-19 00:10:14.237563 Epoch 16, Train Y Loss = 1.39634,  Train X Loss = 0.61824, Val Loss = 1.52723
2025-01-19 00:13:51.599310 Epoch 17, Train Y Loss = 1.38620,  Train X Loss = 0.61605, Val Loss = 1.52445
2025-01-19 00:17:29.221225 Epoch 18, Train Y Loss = 1.38162,  Train X Loss = 0.61432, Val Loss = 1.52711
2025-01-19 00:21:06.897678 Epoch 19, Train Y Loss = 1.37844,  Train X Loss = 0.61334, Val Loss = 1.52512
2025-01-19 00:24:44.936285 Epoch 20, Train Y Loss = 1.37583,  Train X Loss = 0.61356, Val Loss = 1.52471
2025-01-19 00:28:23.137576 Epoch 21, Train Y Loss = 1.37333,  Train X Loss = 0.61253, Val Loss = 1.52349
2025-01-19 00:32:01.431385 Epoch 22, Train Y Loss = 1.37241,  Train X Loss = 0.61245, Val Loss = 1.52775
2025-01-19 00:35:39.351479 Epoch 23, Train Y Loss = 1.36940,  Train X Loss = 0.61143, Val Loss = 1.52584
2025-01-19 00:39:17.551532 Epoch 24, Train Y Loss = 1.36839,  Train X Loss = 0.61176, Val Loss = 1.52510
2025-01-19 00:42:55.623953 Epoch 25, Train Y Loss = 1.36622,  Train X Loss = 0.61110, Val Loss = 1.51946
2025-01-19 00:46:33.350805 Epoch 26, Train Y Loss = 1.36425,  Train X Loss = 0.61085, Val Loss = 1.51828
2025-01-19 00:50:10.662071 Epoch 27, Train Y Loss = 1.36260,  Train X Loss = 0.61070, Val Loss = 1.51358
2025-01-19 00:53:48.932716 Epoch 28, Train Y Loss = 1.36081,  Train X Loss = 0.61052, Val Loss = 1.51910
2025-01-19 00:57:27.332261 Epoch 29, Train Y Loss = 1.35950,  Train X Loss = 0.60970, Val Loss = 1.51991
2025-01-19 01:01:06.143252 Epoch 30, Train Y Loss = 1.35888,  Train X Loss = 0.60953, Val Loss = 1.51887
2025-01-19 01:04:44.163028 Epoch 31, Train Y Loss = 1.35671,  Train X Loss = 0.60929, Val Loss = 1.51852
2025-01-19 01:08:22.057404 Epoch 32, Train Y Loss = 1.35486,  Train X Loss = 0.60894, Val Loss = 1.51667
2025-01-19 01:11:59.707015 Epoch 33, Train Y Loss = 1.35394,  Train X Loss = 0.60846, Val Loss = 1.51507
2025-01-19 01:15:37.530402 Epoch 34, Train Y Loss = 1.35212,  Train X Loss = 0.60848, Val Loss = 1.51416
2025-01-19 01:19:15.713143 Epoch 35, Train Y Loss = 1.35066,  Train X Loss = 0.60794, Val Loss = 1.51796
Change mask ratio: 0.075
2025-01-19 01:22:51.546070 Epoch 36, Train Y Loss = 1.33575,  Train X Loss = 0.29033, Val Loss = 1.50789
2025-01-19 01:26:27.611372 Epoch 37, Train Y Loss = 1.33529,  Train X Loss = 0.29021, Val Loss = 1.50831
2025-01-19 01:30:03.813983 Epoch 38, Train Y Loss = 1.33331,  Train X Loss = 0.29037, Val Loss = 1.50692
2025-01-19 01:33:39.797617 Epoch 39, Train Y Loss = 1.33330,  Train X Loss = 0.29062, Val Loss = 1.50684
2025-01-19 01:37:15.280712 Epoch 40, Train Y Loss = 1.33275,  Train X Loss = 0.29072, Val Loss = 1.50668
2025-01-19 01:40:50.667430 Epoch 41, Train Y Loss = 1.33125,  Train X Loss = 0.29067, Val Loss = 1.50686
2025-01-19 01:44:26.321553 Epoch 42, Train Y Loss = 1.33211,  Train X Loss = 0.29045, Val Loss = 1.50616
2025-01-19 01:48:01.865646 Epoch 43, Train Y Loss = 1.33050,  Train X Loss = 0.29084, Val Loss = 1.50704
2025-01-19 01:51:37.267287 Epoch 44, Train Y Loss = 1.33024,  Train X Loss = 0.29073, Val Loss = 1.50707
2025-01-19 01:55:12.730766 Epoch 45, Train Y Loss = 1.33002,  Train X Loss = 0.29085, Val Loss = 1.50624
2025-01-19 01:58:48.356991 Epoch 46, Train Y Loss = 1.32970,  Train X Loss = 0.29074, Val Loss = 1.50429
2025-01-19 02:02:24.282102 Epoch 47, Train Y Loss = 1.32921,  Train X Loss = 0.29102, Val Loss = 1.50567
2025-01-19 02:06:00.068919 Epoch 48, Train Y Loss = 1.32890,  Train X Loss = 0.29117, Val Loss = 1.50671
2025-01-19 02:09:36.101917 Epoch 49, Train Y Loss = 1.32873,  Train X Loss = 0.29107, Val Loss = 1.50450
2025-01-19 02:13:12.091296 Epoch 50, Train Y Loss = 1.32850,  Train X Loss = 0.29113, Val Loss = 1.50650
2025-01-19 02:16:47.936807 Epoch 51, Train Y Loss = 1.32787,  Train X Loss = 0.29139, Val Loss = 1.50633
2025-01-19 02:20:23.477048 Epoch 52, Train Y Loss = 1.32754,  Train X Loss = 0.29111, Val Loss = 1.50516
2025-01-19 02:23:59.016383 Epoch 53, Train Y Loss = 1.32776,  Train X Loss = 0.29115, Val Loss = 1.50550
2025-01-19 02:27:34.609596 Epoch 54, Train Y Loss = 1.32716,  Train X Loss = 0.29142, Val Loss = 1.50470
Change mask ratio: 0.0375
2025-01-19 02:31:08.949253 Epoch 55, Train Y Loss = 1.32332,  Train X Loss = 0.14256, Val Loss = 1.50518
2025-01-19 02:34:43.650010 Epoch 56, Train Y Loss = 1.32276,  Train X Loss = 0.14266, Val Loss = 1.50498
2025-01-19 02:38:18.125222 Epoch 57, Train Y Loss = 1.32266,  Train X Loss = 0.14308, Val Loss = 1.50444
2025-01-19 02:41:52.772892 Epoch 58, Train Y Loss = 1.32230,  Train X Loss = 0.14311, Val Loss = 1.50364
2025-01-19 02:45:27.591433 Epoch 59, Train Y Loss = 1.32147,  Train X Loss = 0.14300, Val Loss = 1.50193
2025-01-19 02:49:02.191611 Epoch 60, Train Y Loss = 1.32081,  Train X Loss = 0.14319, Val Loss = 1.50368
2025-01-19 02:52:36.867807 Epoch 61, Train Y Loss = 1.32072,  Train X Loss = 0.14329, Val Loss = 1.50423
2025-01-19 02:56:11.410411 Epoch 62, Train Y Loss = 1.32054,  Train X Loss = 0.14311, Val Loss = 1.50463
2025-01-19 02:59:45.914203 Epoch 63, Train Y Loss = 1.32007,  Train X Loss = 0.14317, Val Loss = 1.50325
2025-01-19 03:03:20.779417 Epoch 64, Train Y Loss = 1.31966,  Train X Loss = 0.14337, Val Loss = 1.50481
2025-01-19 03:06:55.630611 Epoch 65, Train Y Loss = 1.31868,  Train X Loss = 0.14365, Val Loss = 1.50376
2025-01-19 03:10:30.419955 Epoch 66, Train Y Loss = 1.31915,  Train X Loss = 0.14362, Val Loss = 1.50375
2025-01-19 03:14:05.146054 Epoch 67, Train Y Loss = 1.31799,  Train X Loss = 0.14367, Val Loss = 1.50373
Change mask ratio: 0.0
2025-01-19 03:17:23.339092 Epoch 68, Train Y Loss = 1.31414,  Train X Loss = 0.00000, Val Loss = 1.50354
2025-01-19 03:20:41.524416 Epoch 69, Train Y Loss = 1.31362,  Train X Loss = 0.00000, Val Loss = 1.50296
2025-01-19 03:23:59.817366 Epoch 70, Train Y Loss = 1.31326,  Train X Loss = 0.00000, Val Loss = 1.50164
2025-01-19 03:27:18.093134 Epoch 71, Train Y Loss = 1.31235,  Train X Loss = 0.00000, Val Loss = 1.50354
2025-01-19 03:30:36.258389 Epoch 72, Train Y Loss = 1.31189,  Train X Loss = 0.00000, Val Loss = 1.50256
2025-01-19 03:33:54.470822 Epoch 73, Train Y Loss = 1.31123,  Train X Loss = 0.00000, Val Loss = 1.50259
2025-01-19 03:37:12.682434 Epoch 74, Train Y Loss = 1.31123,  Train X Loss = 0.00000, Val Loss = 1.50354
2025-01-19 03:40:30.848112 Epoch 75, Train Y Loss = 1.31010,  Train X Loss = 0.00000, Val Loss = 1.50271
2025-01-19 03:43:48.989190 Epoch 76, Train Y Loss = 1.31017,  Train X Loss = 0.00000, Val Loss = 1.50287
2025-01-19 03:47:07.270502 Epoch 77, Train Y Loss = 1.30890,  Train X Loss = 0.00000, Val Loss = 1.50255
2025-01-19 03:50:25.654945 Epoch 78, Train Y Loss = 1.30882,  Train X Loss = 0.00000, Val Loss = 1.50191
Change mask ratio: 0.0
2025-01-19 03:53:44.154476 Epoch 79, Train Y Loss = 1.30941,  Train X Loss = 0.00000, Val Loss = 1.50296
2025-01-19 03:57:02.718996 Epoch 80, Train Y Loss = 1.30832,  Train X Loss = 0.00000, Val Loss = 1.50172
2025-01-19 04:00:21.377085 Epoch 81, Train Y Loss = 1.30729,  Train X Loss = 0.00000, Val Loss = 1.50164
2025-01-19 04:03:39.937700 Epoch 82, Train Y Loss = 1.30689,  Train X Loss = 0.00000, Val Loss = 1.50196
2025-01-19 04:06:58.557900 Epoch 83, Train Y Loss = 1.30694,  Train X Loss = 0.00000, Val Loss = 1.50075
2025-01-19 04:10:17.233369 Epoch 84, Train Y Loss = 1.30608,  Train X Loss = 0.00000, Val Loss = 1.50299
2025-01-19 04:13:35.901262 Epoch 85, Train Y Loss = 1.30625,  Train X Loss = 0.00000, Val Loss = 1.50161
2025-01-19 04:16:54.513727 Epoch 86, Train Y Loss = 1.30508,  Train X Loss = 0.00000, Val Loss = 1.50034
2025-01-19 04:20:13.131228 Epoch 87, Train Y Loss = 1.30524,  Train X Loss = 0.00000, Val Loss = 1.50130
2025-01-19 04:23:31.756372 Epoch 88, Train Y Loss = 1.30457,  Train X Loss = 0.00000, Val Loss = 1.50265
2025-01-19 04:26:50.396393 Epoch 89, Train Y Loss = 1.30386,  Train X Loss = 0.00000, Val Loss = 1.50143
2025-01-19 04:30:09.044429 Epoch 90, Train Y Loss = 1.30373,  Train X Loss = 0.00000, Val Loss = 1.50162
2025-01-19 04:33:27.757245 Epoch 91, Train Y Loss = 1.30332,  Train X Loss = 0.00000, Val Loss = 1.50251
2025-01-19 04:36:46.512002 Epoch 92, Train Y Loss = 1.30407,  Train X Loss = 0.00000, Val Loss = 1.50162
2025-01-19 04:40:05.021555 Epoch 93, Train Y Loss = 1.30289,  Train X Loss = 0.00000, Val Loss = 1.50069
2025-01-19 04:43:23.306631 Epoch 94, Train Y Loss = 1.30192,  Train X Loss = 0.00000, Val Loss = 1.50164
Change mask ratio: 0.0
2025-01-19 04:46:41.619824 Epoch 95, Train Y Loss = 1.30147,  Train X Loss = 0.00000, Val Loss = 1.50151
2025-01-19 04:49:59.831029 Epoch 96, Train Y Loss = 1.30161,  Train X Loss = 0.00000, Val Loss = 1.50121
2025-01-19 04:53:18.126552 Epoch 97, Train Y Loss = 1.30099,  Train X Loss = 0.00000, Val Loss = 1.50138
2025-01-19 04:56:36.420415 Epoch 98, Train Y Loss = 1.30051,  Train X Loss = 0.00000, Val Loss = 1.50126
2025-01-19 04:59:54.738527 Epoch 99, Train Y Loss = 1.30023,  Train X Loss = 0.00000, Val Loss = 1.50089
2025-01-19 05:03:13.045228 Epoch 100, Train Y Loss = 1.30036,  Train X Loss = 0.00000, Val Loss = 1.50213
Early stopping at epoch: 100
Best at epoch 86:
Train Loss = 1.30508
Train RMSE = 2.86573, MAE = 1.27765, MAPE = 2.72305
Val Loss = 1.50034
Val RMSE = 3.46094, MAE = 1.49859, MAPE = 3.38437
--------- Test ---------
All Steps RMSE = 3.47138, MAE = 1.51873, MAPE = 3.38786
Step 1 RMSE = 1.53340, MAE = 0.83916, MAPE = 1.60753
Step 2 RMSE = 2.18468, MAE = 1.10013, MAPE = 2.21052
Step 3 RMSE = 2.67653, MAE = 1.27367, MAPE = 2.65362
Step 4 RMSE = 3.05207, MAE = 1.40160, MAPE = 3.00407
Step 5 RMSE = 3.33759, MAE = 1.49982, MAPE = 3.28794
Step 6 RMSE = 3.55965, MAE = 1.57911, MAPE = 3.52458
Step 7 RMSE = 3.73728, MAE = 1.64390, MAPE = 3.72222
Step 8 RMSE = 3.87978, MAE = 1.69753, MAPE = 3.88726
Step 9 RMSE = 3.99541, MAE = 1.74279, MAPE = 4.02719
Step 10 RMSE = 4.09158, MAE = 1.78133, MAPE = 4.14534
Step 11 RMSE = 4.17330, MAE = 1.81540, MAPE = 4.24390
Step 12 RMSE = 4.24875, MAE = 1.85035, MAPE = 4.34014
Inference time: 18.16 s
