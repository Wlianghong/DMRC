PEMSBAY
--------- DMRCMLP ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        15,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "adaptive_mask": false,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 93048409,
    "gpu": [
        6
    ],
    "save": false,
    "model_args": {
        "num_nodes": 325,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        385,212
├─Linear: 1-1                                 [16, 12, 325, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 325, 48]         --
│    └─Embedding: 2-1                         [16, 12, 325, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 325, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 325, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 325, 144]        158,224
├─Predictor: 1-4                              [16, 12, 325, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 325, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 325, 144]        41,760
│    └─Linear: 2-6                            [16, 325, 12]             20,748
===============================================================================================
Total params: 1,129,504
Trainable params: 1,129,504
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.75
Forward/backward pass size (MB): 2847.94
Params size (MB): 2.98
Estimated Total Size (MB): 2851.66
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMSBAY-2025-01-20-15-10-46.pt
2025-01-20 15:14:23.413464 Epoch 1, Train Y Loss = 2.05950,  Train X Loss = 1.00745, Val Loss = 1.95623
2025-01-20 15:18:01.590095 Epoch 2, Train Y Loss = 1.73207,  Train X Loss = 0.80633, Val Loss = 1.80031
2025-01-20 15:21:39.602451 Epoch 3, Train Y Loss = 1.63795,  Train X Loss = 0.78531, Val Loss = 1.75063
2025-01-20 15:25:17.442012 Epoch 4, Train Y Loss = 1.58761,  Train X Loss = 0.76767, Val Loss = 1.70751
2025-01-20 15:28:55.526749 Epoch 5, Train Y Loss = 1.55819,  Train X Loss = 0.74200, Val Loss = 1.67670
2025-01-20 15:32:33.404006 Epoch 6, Train Y Loss = 1.53659,  Train X Loss = 0.68675, Val Loss = 1.74038
2025-01-20 15:36:10.960266 Epoch 7, Train Y Loss = 1.51779,  Train X Loss = 0.66738, Val Loss = 1.61731
2025-01-20 15:39:48.439851 Epoch 8, Train Y Loss = 1.50442,  Train X Loss = 0.66012, Val Loss = 1.64235
2025-01-20 15:43:25.693943 Epoch 9, Train Y Loss = 1.49117,  Train X Loss = 0.65431, Val Loss = 1.61225
2025-01-20 15:47:03.013000 Epoch 10, Train Y Loss = 1.48416,  Train X Loss = 0.64985, Val Loss = 1.63696
2025-01-20 15:50:40.293614 Epoch 11, Train Y Loss = 1.47759,  Train X Loss = 0.64662, Val Loss = 1.64826
2025-01-20 15:54:18.079766 Epoch 12, Train Y Loss = 1.47063,  Train X Loss = 0.64365, Val Loss = 1.59976
2025-01-20 15:57:55.382900 Epoch 13, Train Y Loss = 1.46622,  Train X Loss = 0.64071, Val Loss = 1.59643
2025-01-20 16:01:32.769034 Epoch 14, Train Y Loss = 1.46148,  Train X Loss = 0.63784, Val Loss = 1.60319
2025-01-20 16:05:10.637706 Epoch 15, Train Y Loss = 1.45673,  Train X Loss = 0.63603, Val Loss = 1.58390
2025-01-20 16:08:48.474089 Epoch 16, Train Y Loss = 1.40733,  Train X Loss = 0.61791, Val Loss = 1.54103
2025-01-20 16:12:25.515729 Epoch 17, Train Y Loss = 1.39839,  Train X Loss = 0.61586, Val Loss = 1.53335
2025-01-20 16:16:02.965467 Epoch 18, Train Y Loss = 1.39443,  Train X Loss = 0.61494, Val Loss = 1.52517
2025-01-20 16:19:40.527399 Epoch 19, Train Y Loss = 1.39116,  Train X Loss = 0.61432, Val Loss = 1.52902
2025-01-20 16:23:18.154566 Epoch 20, Train Y Loss = 1.38905,  Train X Loss = 0.61336, Val Loss = 1.52860
2025-01-20 16:26:55.776626 Epoch 21, Train Y Loss = 1.38728,  Train X Loss = 0.61320, Val Loss = 1.52590
2025-01-20 16:30:32.926301 Epoch 22, Train Y Loss = 1.38519,  Train X Loss = 0.61244, Val Loss = 1.52513
2025-01-20 16:34:09.845758 Epoch 23, Train Y Loss = 1.38324,  Train X Loss = 0.61241, Val Loss = 1.52139
2025-01-20 16:37:47.159367 Epoch 24, Train Y Loss = 1.38117,  Train X Loss = 0.61208, Val Loss = 1.52504
2025-01-20 16:41:24.397384 Epoch 25, Train Y Loss = 1.37955,  Train X Loss = 0.61125, Val Loss = 1.52186
2025-01-20 16:45:01.860569 Epoch 26, Train Y Loss = 1.37853,  Train X Loss = 0.61101, Val Loss = 1.51885
2025-01-20 16:48:39.485963 Epoch 27, Train Y Loss = 1.37730,  Train X Loss = 0.61032, Val Loss = 1.52070
2025-01-20 16:52:16.607095 Epoch 28, Train Y Loss = 1.37518,  Train X Loss = 0.60975, Val Loss = 1.52749
2025-01-20 16:55:53.854510 Epoch 29, Train Y Loss = 1.37409,  Train X Loss = 0.60992, Val Loss = 1.53029
2025-01-20 16:59:31.326644 Epoch 30, Train Y Loss = 1.37249,  Train X Loss = 0.60938, Val Loss = 1.51907
2025-01-20 17:03:08.802840 Epoch 31, Train Y Loss = 1.37124,  Train X Loss = 0.60913, Val Loss = 1.52175
2025-01-20 17:06:46.770015 Epoch 32, Train Y Loss = 1.37055,  Train X Loss = 0.60894, Val Loss = 1.52162
2025-01-20 17:10:24.005515 Epoch 33, Train Y Loss = 1.36852,  Train X Loss = 0.60895, Val Loss = 1.51962
2025-01-20 17:14:01.020367 Epoch 34, Train Y Loss = 1.36731,  Train X Loss = 0.60874, Val Loss = 1.52175
2025-01-20 17:17:38.590719 Epoch 35, Train Y Loss = 1.36557,  Train X Loss = 0.60818, Val Loss = 1.52077
2025-01-20 17:21:15.770948 Epoch 36, Train Y Loss = 1.35712,  Train X Loss = 0.60631, Val Loss = 1.51446
2025-01-20 17:24:53.375301 Epoch 37, Train Y Loss = 1.35521,  Train X Loss = 0.60600, Val Loss = 1.51384
2025-01-20 17:28:30.613593 Epoch 38, Train Y Loss = 1.35540,  Train X Loss = 0.60599, Val Loss = 1.51263
2025-01-20 17:32:08.037734 Epoch 39, Train Y Loss = 1.35452,  Train X Loss = 0.60602, Val Loss = 1.51244
2025-01-20 17:35:44.811076 Epoch 40, Train Y Loss = 1.35495,  Train X Loss = 0.60569, Val Loss = 1.51386
2025-01-20 17:39:21.951989 Epoch 41, Train Y Loss = 1.35424,  Train X Loss = 0.60612, Val Loss = 1.51480
2025-01-20 17:42:59.119486 Epoch 42, Train Y Loss = 1.35360,  Train X Loss = 0.60577, Val Loss = 1.51290
2025-01-20 17:46:36.410067 Epoch 43, Train Y Loss = 1.35399,  Train X Loss = 0.60538, Val Loss = 1.51391
2025-01-20 17:50:13.680676 Epoch 44, Train Y Loss = 1.35304,  Train X Loss = 0.60548, Val Loss = 1.51197
2025-01-20 17:53:50.588024 Epoch 45, Train Y Loss = 1.35281,  Train X Loss = 0.60561, Val Loss = 1.51381
2025-01-20 17:57:27.679420 Epoch 46, Train Y Loss = 1.35274,  Train X Loss = 0.60526, Val Loss = 1.51375
2025-01-20 18:01:05.506656 Epoch 47, Train Y Loss = 1.35238,  Train X Loss = 0.60513, Val Loss = 1.51371
2025-01-20 18:04:43.357817 Epoch 48, Train Y Loss = 1.35185,  Train X Loss = 0.60521, Val Loss = 1.51308
2025-01-20 18:08:21.006437 Epoch 49, Train Y Loss = 1.35190,  Train X Loss = 0.60480, Val Loss = 1.51429
2025-01-20 18:11:57.993338 Epoch 50, Train Y Loss = 1.35154,  Train X Loss = 0.60534, Val Loss = 1.51264
2025-01-20 18:15:35.292859 Epoch 51, Train Y Loss = 1.35227,  Train X Loss = 0.60528, Val Loss = 1.51329
2025-01-20 18:19:12.753279 Epoch 52, Train Y Loss = 1.35158,  Train X Loss = 0.60517, Val Loss = 1.51211
2025-01-20 18:22:50.085842 Epoch 53, Train Y Loss = 1.35109,  Train X Loss = 0.60508, Val Loss = 1.51234
2025-01-20 18:26:27.101347 Epoch 54, Train Y Loss = 1.35066,  Train X Loss = 0.60510, Val Loss = 1.51369
2025-01-20 18:30:04.483771 Epoch 55, Train Y Loss = 1.35147,  Train X Loss = 0.60521, Val Loss = 1.51311
2025-01-20 18:33:42.217949 Epoch 56, Train Y Loss = 1.35043,  Train X Loss = 0.60468, Val Loss = 1.51356
2025-01-20 18:37:19.405679 Epoch 57, Train Y Loss = 1.35117,  Train X Loss = 0.60541, Val Loss = 1.51350
2025-01-20 18:40:56.694147 Epoch 58, Train Y Loss = 1.35068,  Train X Loss = 0.60501, Val Loss = 1.51407
2025-01-20 18:44:34.226441 Epoch 59, Train Y Loss = 1.34942,  Train X Loss = 0.60458, Val Loss = 1.51339
2025-01-20 18:48:11.939747 Epoch 60, Train Y Loss = 1.35017,  Train X Loss = 0.60486, Val Loss = 1.51410
2025-01-20 18:51:49.298786 Epoch 61, Train Y Loss = 1.34947,  Train X Loss = 0.60469, Val Loss = 1.51352
2025-01-20 18:55:26.594246 Epoch 62, Train Y Loss = 1.34936,  Train X Loss = 0.60455, Val Loss = 1.51474
2025-01-20 18:59:04.353939 Epoch 63, Train Y Loss = 1.34881,  Train X Loss = 0.60474, Val Loss = 1.51414
2025-01-20 19:02:41.905280 Epoch 64, Train Y Loss = 1.34881,  Train X Loss = 0.60482, Val Loss = 1.51407
2025-01-20 19:06:19.246420 Epoch 65, Train Y Loss = 1.34954,  Train X Loss = 0.60464, Val Loss = 1.51332
2025-01-20 19:09:56.751299 Epoch 66, Train Y Loss = 1.34816,  Train X Loss = 0.60414, Val Loss = 1.51376
2025-01-20 19:13:33.900641 Epoch 67, Train Y Loss = 1.34809,  Train X Loss = 0.60447, Val Loss = 1.51577
2025-01-20 19:17:11.417912 Epoch 68, Train Y Loss = 1.34822,  Train X Loss = 0.60415, Val Loss = 1.51668
2025-01-20 19:20:49.101803 Epoch 69, Train Y Loss = 1.34824,  Train X Loss = 0.60409, Val Loss = 1.51332
2025-01-20 19:24:26.597662 Epoch 70, Train Y Loss = 1.34861,  Train X Loss = 0.60452, Val Loss = 1.51544
2025-01-20 19:28:03.932406 Epoch 71, Train Y Loss = 1.34734,  Train X Loss = 0.60413, Val Loss = 1.51435
2025-01-20 19:31:42.057660 Epoch 72, Train Y Loss = 1.34740,  Train X Loss = 0.60400, Val Loss = 1.51349
2025-01-20 19:35:19.914170 Epoch 73, Train Y Loss = 1.34698,  Train X Loss = 0.60395, Val Loss = 1.51383
2025-01-20 19:38:57.739454 Epoch 74, Train Y Loss = 1.34681,  Train X Loss = 0.60339, Val Loss = 1.51479
Early stopping at epoch: 74
Best at epoch 44:
Train Loss = 1.35304
Train RMSE = 2.98537, MAE = 1.32528, MAPE = 2.84918
Val Loss = 1.51197
Val RMSE = 3.50504, MAE = 1.51006, MAPE = 3.45259
--------- Test ---------
All Steps RMSE = 3.45809, MAE = 1.51251, MAPE = 3.39594
Step 1 RMSE = 1.54105, MAE = 0.84134, MAPE = 1.61559
Step 2 RMSE = 2.19666, MAE = 1.10545, MAPE = 2.23358
Step 3 RMSE = 2.68821, MAE = 1.27968, MAPE = 2.68504
Step 4 RMSE = 3.05883, MAE = 1.40559, MAPE = 3.03915
Step 5 RMSE = 3.33791, MAE = 1.50049, MAPE = 3.31951
Step 6 RMSE = 3.55515, MAE = 1.57586, MAPE = 3.55122
Step 7 RMSE = 3.72949, MAE = 1.63680, MAPE = 3.73998
Step 8 RMSE = 3.86580, MAE = 1.68621, MAPE = 3.89070
Step 9 RMSE = 3.97318, MAE = 1.72779, MAPE = 4.01721
Step 10 RMSE = 4.06023, MAE = 1.76348, MAPE = 4.12310
Step 11 RMSE = 4.13496, MAE = 1.79604, MAPE = 4.21795
Step 12 RMSE = 4.20874, MAE = 1.83141, MAPE = 4.31821
Inference time: 18.26 s
