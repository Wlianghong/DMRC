PEMSBAY
--------- DMRCMLP ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        15,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 34110658,
    "gpu": [
        6
    ],
    "save": false,
    "model_args": {
        "num_nodes": 325,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        385,212
├─Linear: 1-1                                 [16, 12, 325, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 325, 48]         --
│    └─Embedding: 2-1                         [16, 12, 325, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 325, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 325, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 325, 144]        158,224
├─Predictor: 1-4                              [16, 12, 325, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 325, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 325, 144]        41,760
│    └─Linear: 2-6                            [16, 325, 12]             20,748
===============================================================================================
Total params: 1,129,504
Trainable params: 1,129,504
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.75
Forward/backward pass size (MB): 2847.94
Params size (MB): 2.98
Estimated Total Size (MB): 2851.66
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMSBAY-2025-01-21-00-04-56.pt
2025-01-21 00:08:20.062328 Epoch 1, Train Y Loss = 2.06384,  Train X Loss = 0.00000, Val Loss = 1.98805
2025-01-21 00:11:44.066728 Epoch 2, Train Y Loss = 1.70866,  Train X Loss = 0.00000, Val Loss = 1.77894
2025-01-21 00:15:08.164151 Epoch 3, Train Y Loss = 1.62733,  Train X Loss = 0.00000, Val Loss = 1.75046
2025-01-21 00:18:31.836865 Epoch 4, Train Y Loss = 1.57879,  Train X Loss = 0.00000, Val Loss = 1.66748
2025-01-21 00:21:55.643804 Epoch 5, Train Y Loss = 1.54736,  Train X Loss = 0.00000, Val Loss = 1.68069
2025-01-21 00:25:19.523402 Epoch 6, Train Y Loss = 1.52720,  Train X Loss = 0.00000, Val Loss = 1.67229
2025-01-21 00:28:42.904154 Epoch 7, Train Y Loss = 1.50805,  Train X Loss = 0.00000, Val Loss = 1.63355
2025-01-21 00:32:06.450698 Epoch 8, Train Y Loss = 1.49398,  Train X Loss = 0.00000, Val Loss = 1.61222
2025-01-21 00:35:29.859018 Epoch 9, Train Y Loss = 1.48192,  Train X Loss = 0.00000, Val Loss = 1.60784
2025-01-21 00:38:52.905966 Epoch 10, Train Y Loss = 1.47237,  Train X Loss = 0.00000, Val Loss = 1.61298
2025-01-21 00:42:16.086597 Epoch 11, Train Y Loss = 1.46278,  Train X Loss = 0.00000, Val Loss = 1.59443
2025-01-21 00:45:39.247328 Epoch 12, Train Y Loss = 1.45582,  Train X Loss = 0.00000, Val Loss = 1.61309
2025-01-21 00:49:01.952289 Epoch 13, Train Y Loss = 1.45002,  Train X Loss = 0.00000, Val Loss = 1.60506
2025-01-21 00:52:25.187066 Epoch 14, Train Y Loss = 1.44349,  Train X Loss = 0.00000, Val Loss = 1.59043
2025-01-21 00:55:49.188668 Epoch 15, Train Y Loss = 1.43808,  Train X Loss = 0.00000, Val Loss = 1.58343
2025-01-21 00:59:12.549019 Epoch 16, Train Y Loss = 1.38928,  Train X Loss = 0.00000, Val Loss = 1.53921
2025-01-21 01:02:35.749013 Epoch 17, Train Y Loss = 1.37793,  Train X Loss = 0.00000, Val Loss = 1.53643
2025-01-21 01:05:58.917090 Epoch 18, Train Y Loss = 1.37304,  Train X Loss = 0.00000, Val Loss = 1.54147
2025-01-21 01:09:22.312697 Epoch 19, Train Y Loss = 1.36915,  Train X Loss = 0.00000, Val Loss = 1.53994
2025-01-21 01:12:45.723080 Epoch 20, Train Y Loss = 1.36599,  Train X Loss = 0.00000, Val Loss = 1.53584
2025-01-21 01:16:09.551177 Epoch 21, Train Y Loss = 1.36355,  Train X Loss = 0.00000, Val Loss = 1.53549
2025-01-21 01:19:32.790353 Epoch 22, Train Y Loss = 1.36196,  Train X Loss = 0.00000, Val Loss = 1.53351
2025-01-21 01:22:56.401721 Epoch 23, Train Y Loss = 1.35865,  Train X Loss = 0.00000, Val Loss = 1.53848
2025-01-21 01:26:19.569840 Epoch 24, Train Y Loss = 1.35649,  Train X Loss = 0.00000, Val Loss = 1.54866
2025-01-21 01:29:42.727616 Epoch 25, Train Y Loss = 1.35445,  Train X Loss = 0.00000, Val Loss = 1.53620
2025-01-21 01:33:06.893156 Epoch 26, Train Y Loss = 1.35207,  Train X Loss = 0.00000, Val Loss = 1.52990
2025-01-21 01:36:30.733442 Epoch 27, Train Y Loss = 1.35055,  Train X Loss = 0.00000, Val Loss = 1.53139
2025-01-21 01:39:53.815643 Epoch 28, Train Y Loss = 1.34836,  Train X Loss = 0.00000, Val Loss = 1.53295
2025-01-21 01:43:17.337359 Epoch 29, Train Y Loss = 1.34678,  Train X Loss = 0.00000, Val Loss = 1.53287
2025-01-21 01:46:40.492652 Epoch 30, Train Y Loss = 1.34551,  Train X Loss = 0.00000, Val Loss = 1.53131
2025-01-21 01:50:03.949593 Epoch 31, Train Y Loss = 1.34296,  Train X Loss = 0.00000, Val Loss = 1.53062
2025-01-21 01:53:27.731851 Epoch 32, Train Y Loss = 1.34160,  Train X Loss = 0.00000, Val Loss = 1.52706
2025-01-21 01:56:51.066313 Epoch 33, Train Y Loss = 1.33961,  Train X Loss = 0.00000, Val Loss = 1.52999
2025-01-21 02:00:14.600942 Epoch 34, Train Y Loss = 1.33775,  Train X Loss = 0.00000, Val Loss = 1.53197
2025-01-21 02:03:37.642566 Epoch 35, Train Y Loss = 1.33622,  Train X Loss = 0.00000, Val Loss = 1.53227
2025-01-21 02:07:01.033416 Epoch 36, Train Y Loss = 1.32839,  Train X Loss = 0.00000, Val Loss = 1.52858
2025-01-21 02:10:24.803324 Epoch 37, Train Y Loss = 1.32792,  Train X Loss = 0.00000, Val Loss = 1.52727
2025-01-21 02:13:48.546365 Epoch 38, Train Y Loss = 1.32628,  Train X Loss = 0.00000, Val Loss = 1.52864
2025-01-21 02:17:11.495023 Epoch 39, Train Y Loss = 1.32668,  Train X Loss = 0.00000, Val Loss = 1.52690
2025-01-21 02:20:34.625148 Epoch 40, Train Y Loss = 1.32612,  Train X Loss = 0.00000, Val Loss = 1.52749
2025-01-21 02:23:58.353331 Epoch 41, Train Y Loss = 1.32483,  Train X Loss = 0.00000, Val Loss = 1.52849
2025-01-21 02:27:21.837802 Epoch 42, Train Y Loss = 1.32538,  Train X Loss = 0.00000, Val Loss = 1.52697
2025-01-21 02:30:45.455297 Epoch 43, Train Y Loss = 1.32432,  Train X Loss = 0.00000, Val Loss = 1.52786
2025-01-21 02:34:08.987027 Epoch 44, Train Y Loss = 1.32412,  Train X Loss = 0.00000, Val Loss = 1.52776
2025-01-21 02:37:32.366371 Epoch 45, Train Y Loss = 1.32399,  Train X Loss = 0.00000, Val Loss = 1.52922
2025-01-21 02:40:55.533025 Epoch 46, Train Y Loss = 1.32404,  Train X Loss = 0.00000, Val Loss = 1.52749
2025-01-21 02:44:18.531061 Epoch 47, Train Y Loss = 1.32327,  Train X Loss = 0.00000, Val Loss = 1.52749
Change mask ratio: 0.075
2025-01-21 02:47:40.066064 Epoch 48, Train Y Loss = 1.31414,  Train X Loss = 0.00000, Val Loss = 1.52637
2025-01-21 02:51:01.708801 Epoch 49, Train Y Loss = 1.31371,  Train X Loss = 0.00000, Val Loss = 1.52547
2025-01-21 02:54:23.317848 Epoch 50, Train Y Loss = 1.31336,  Train X Loss = 0.00000, Val Loss = 1.52749
2025-01-21 02:57:44.605658 Epoch 51, Train Y Loss = 1.31272,  Train X Loss = 0.00000, Val Loss = 1.52635
2025-01-21 03:01:06.292869 Epoch 52, Train Y Loss = 1.31257,  Train X Loss = 0.00000, Val Loss = 1.52549
2025-01-21 03:04:27.504505 Epoch 53, Train Y Loss = 1.31241,  Train X Loss = 0.00000, Val Loss = 1.52694
2025-01-21 03:07:48.811647 Epoch 54, Train Y Loss = 1.31198,  Train X Loss = 0.00000, Val Loss = 1.52577
2025-01-21 03:11:10.445790 Epoch 55, Train Y Loss = 1.31131,  Train X Loss = 0.00000, Val Loss = 1.52746
2025-01-21 03:14:31.771639 Epoch 56, Train Y Loss = 1.31126,  Train X Loss = 0.00000, Val Loss = 1.52640
2025-01-21 03:17:53.379582 Epoch 57, Train Y Loss = 1.31132,  Train X Loss = 0.00000, Val Loss = 1.52632
Change mask ratio: 0.0375
2025-01-21 03:21:14.421546 Epoch 58, Train Y Loss = 1.30625,  Train X Loss = 0.00000, Val Loss = 1.52575
2025-01-21 03:24:35.013344 Epoch 59, Train Y Loss = 1.30533,  Train X Loss = 0.00000, Val Loss = 1.52614
2025-01-21 03:27:56.421666 Epoch 60, Train Y Loss = 1.30493,  Train X Loss = 0.00000, Val Loss = 1.52660
2025-01-21 03:31:17.401974 Epoch 61, Train Y Loss = 1.30450,  Train X Loss = 0.00000, Val Loss = 1.52530
2025-01-21 03:34:38.665077 Epoch 62, Train Y Loss = 1.30467,  Train X Loss = 0.00000, Val Loss = 1.52602
2025-01-21 03:37:59.907464 Epoch 63, Train Y Loss = 1.30390,  Train X Loss = 0.00000, Val Loss = 1.52719
2025-01-21 03:41:20.845769 Epoch 64, Train Y Loss = 1.30362,  Train X Loss = 0.00000, Val Loss = 1.52686
2025-01-21 03:44:41.974858 Epoch 65, Train Y Loss = 1.30294,  Train X Loss = 0.00000, Val Loss = 1.52662
2025-01-21 03:48:02.750527 Epoch 66, Train Y Loss = 1.30306,  Train X Loss = 0.00000, Val Loss = 1.52690
2025-01-21 03:51:23.320504 Epoch 67, Train Y Loss = 1.30196,  Train X Loss = 0.00000, Val Loss = 1.52766
2025-01-21 03:54:44.081164 Epoch 68, Train Y Loss = 1.30175,  Train X Loss = 0.00000, Val Loss = 1.52655
2025-01-21 03:58:04.990595 Epoch 69, Train Y Loss = 1.30108,  Train X Loss = 0.00000, Val Loss = 1.52680
Change mask ratio: 0.0
2025-01-21 04:01:19.261350 Epoch 70, Train Y Loss = 1.29589,  Train X Loss = 0.00000, Val Loss = 1.52785
2025-01-21 04:04:33.640650 Epoch 71, Train Y Loss = 1.29499,  Train X Loss = 0.00000, Val Loss = 1.52726
2025-01-21 04:07:48.010425 Epoch 72, Train Y Loss = 1.29461,  Train X Loss = 0.00000, Val Loss = 1.52865
2025-01-21 04:11:02.366491 Epoch 73, Train Y Loss = 1.29405,  Train X Loss = 0.00000, Val Loss = 1.52889
2025-01-21 04:14:16.643272 Epoch 74, Train Y Loss = 1.29383,  Train X Loss = 0.00000, Val Loss = 1.52869
2025-01-21 04:17:30.984113 Epoch 75, Train Y Loss = 1.29271,  Train X Loss = 0.00000, Val Loss = 1.52782
2025-01-21 04:20:45.325941 Epoch 76, Train Y Loss = 1.29277,  Train X Loss = 0.00000, Val Loss = 1.53004
2025-01-21 04:23:59.564281 Epoch 77, Train Y Loss = 1.29172,  Train X Loss = 0.00000, Val Loss = 1.52892
Change mask ratio: 0.0
2025-01-21 04:27:13.602182 Epoch 78, Train Y Loss = 1.29135,  Train X Loss = 0.00000, Val Loss = 1.53005
2025-01-21 04:30:27.597848 Epoch 79, Train Y Loss = 1.29173,  Train X Loss = 0.00000, Val Loss = 1.53071
2025-01-21 04:33:41.674488 Epoch 80, Train Y Loss = 1.29080,  Train X Loss = 0.00000, Val Loss = 1.53043
2025-01-21 04:36:55.898718 Epoch 81, Train Y Loss = 1.28998,  Train X Loss = 0.00000, Val Loss = 1.53014
2025-01-21 04:40:10.098185 Epoch 82, Train Y Loss = 1.28952,  Train X Loss = 0.00000, Val Loss = 1.53038
2025-01-21 04:43:24.295241 Epoch 83, Train Y Loss = 1.28944,  Train X Loss = 0.00000, Val Loss = 1.52872
2025-01-21 04:46:38.468577 Epoch 84, Train Y Loss = 1.28844,  Train X Loss = 0.00000, Val Loss = 1.52990
2025-01-21 04:49:52.682934 Epoch 85, Train Y Loss = 1.28834,  Train X Loss = 0.00000, Val Loss = 1.53032
Change mask ratio: 0.0
2025-01-21 04:53:06.907129 Epoch 86, Train Y Loss = 1.28749,  Train X Loss = 0.00000, Val Loss = 1.53030
2025-01-21 04:56:21.157406 Epoch 87, Train Y Loss = 1.28744,  Train X Loss = 0.00000, Val Loss = 1.53037
2025-01-21 04:59:35.426148 Epoch 88, Train Y Loss = 1.28671,  Train X Loss = 0.00000, Val Loss = 1.53011
2025-01-21 05:02:49.670054 Epoch 89, Train Y Loss = 1.28618,  Train X Loss = 0.00000, Val Loss = 1.53087
2025-01-21 05:06:03.691829 Epoch 90, Train Y Loss = 1.28571,  Train X Loss = 0.00000, Val Loss = 1.53014
2025-01-21 05:09:17.763210 Epoch 91, Train Y Loss = 1.28516,  Train X Loss = 0.00000, Val Loss = 1.53179
Early stopping at epoch: 91
Best at epoch 61:
Train Loss = 1.30450
Train RMSE = 2.85180, MAE = 1.27419, MAPE = 2.71463
Val Loss = 1.52530
Val RMSE = 3.54475, MAE = 1.52336, MAPE = 3.45856
--------- Test ---------
All Steps RMSE = 3.56525, MAE = 1.55038, MAPE = 3.45448
Step 1 RMSE = 1.64582, MAE = 0.86024, MAPE = 1.66099
Step 2 RMSE = 2.29876, MAE = 1.13143, MAPE = 2.30080
Step 3 RMSE = 2.79279, MAE = 1.30938, MAPE = 2.76156
Step 4 RMSE = 3.16771, MAE = 1.43765, MAPE = 3.11606
Step 5 RMSE = 3.44872, MAE = 1.53506, MAPE = 3.39409
Step 6 RMSE = 3.66513, MAE = 1.61244, MAPE = 3.61899
Step 7 RMSE = 3.83800, MAE = 1.67548, MAPE = 3.80018
Step 8 RMSE = 3.97417, MAE = 1.72722, MAPE = 3.94558
Step 9 RMSE = 4.08244, MAE = 1.77240, MAPE = 4.06646
Step 10 RMSE = 4.17194, MAE = 1.81208, MAPE = 4.17142
Step 11 RMSE = 4.25152, MAE = 1.84792, MAPE = 4.26442
Step 12 RMSE = 4.32521, MAE = 1.88325, MAPE = 4.35325
Inference time: 18.65 s
