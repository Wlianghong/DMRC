METRLA
--------- DMRCMLP ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0003,
    "milestones": [
        25,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 74418540,
    "gpu": [
        0
    ],
    "save": false,
    "model_args": {
        "num_nodes": 207,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        283,260
├─Linear: 1-1                                 [16, 12, 207, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 207, 48]         --
│    └─Embedding: 2-1                         [16, 12, 207, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 207, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 207, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 207, 144]        158,224
├─Predictor: 1-4                              [16, 12, 207, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 207, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 207, 144]        41,760
│    └─Linear: 2-6                            [16, 207, 12]             20,748
===============================================================================================
Total params: 1,027,552
Trainable params: 1,027,552
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.48
Forward/backward pass size (MB): 1813.92
Params size (MB): 2.98
Estimated Total Size (MB): 1817.37
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-METRLA-2025-01-16-18-48-27.pt
2025-01-16 18:50:13.220610 Epoch 1, Train Y Loss = 4.11879,  Train X Loss = 2.64078, Val Loss = 3.35670
2025-01-16 18:51:58.565018 Epoch 2, Train Y Loss = 3.42268,  Train X Loss = 2.26478, Val Loss = 3.15557
2025-01-16 18:53:32.778612 Epoch 3, Train Y Loss = 3.24233,  Train X Loss = 2.21560, Val Loss = 2.96753
2025-01-16 18:55:18.106919 Epoch 4, Train Y Loss = 3.14175,  Train X Loss = 2.18753, Val Loss = 2.95379
2025-01-16 18:56:50.994067 Epoch 5, Train Y Loss = 3.08750,  Train X Loss = 2.06730, Val Loss = 2.90326
2025-01-16 18:58:36.806608 Epoch 6, Train Y Loss = 3.03237,  Train X Loss = 1.99818, Val Loss = 2.82220
2025-01-16 19:00:11.414871 Epoch 7, Train Y Loss = 2.99196,  Train X Loss = 1.97428, Val Loss = 2.83223
2025-01-16 19:01:57.714946 Epoch 8, Train Y Loss = 2.96997,  Train X Loss = 1.95835, Val Loss = 2.83161
2025-01-16 19:03:43.939996 Epoch 9, Train Y Loss = 2.94642,  Train X Loss = 1.94582, Val Loss = 2.78096
2025-01-16 19:05:17.633519 Epoch 10, Train Y Loss = 2.93219,  Train X Loss = 1.93612, Val Loss = 2.82005
2025-01-16 19:07:03.521499 Epoch 11, Train Y Loss = 2.91802,  Train X Loss = 1.92811, Val Loss = 2.79779
2025-01-16 19:08:49.023889 Epoch 12, Train Y Loss = 2.90730,  Train X Loss = 1.91990, Val Loss = 2.79425
2025-01-16 19:10:22.007240 Epoch 13, Train Y Loss = 2.89651,  Train X Loss = 1.91099, Val Loss = 2.77593
2025-01-16 19:12:08.108086 Epoch 14, Train Y Loss = 2.88662,  Train X Loss = 1.90496, Val Loss = 2.75588
2025-01-16 19:13:54.308952 Epoch 15, Train Y Loss = 2.88021,  Train X Loss = 1.90045, Val Loss = 2.75567
2025-01-16 19:15:29.288216 Epoch 16, Train Y Loss = 2.87412,  Train X Loss = 1.89735, Val Loss = 2.77362
2025-01-16 19:17:14.116766 Epoch 17, Train Y Loss = 2.86322,  Train X Loss = 1.89105, Val Loss = 2.74066
2025-01-16 19:19:00.059613 Epoch 18, Train Y Loss = 2.85867,  Train X Loss = 1.88548, Val Loss = 2.75057
2025-01-16 19:20:36.384150 Epoch 19, Train Y Loss = 2.85137,  Train X Loss = 1.88302, Val Loss = 2.75032
2025-01-16 19:22:18.685798 Epoch 20, Train Y Loss = 2.84850,  Train X Loss = 1.87823, Val Loss = 2.73911
2025-01-16 19:23:51.891494 Epoch 21, Train Y Loss = 2.84498,  Train X Loss = 1.87752, Val Loss = 2.76667
2025-01-16 19:25:37.727085 Epoch 22, Train Y Loss = 2.83902,  Train X Loss = 1.87323, Val Loss = 2.77649
2025-01-16 19:27:13.366810 Epoch 23, Train Y Loss = 2.83695,  Train X Loss = 1.87231, Val Loss = 2.75159
2025-01-16 19:28:58.988819 Epoch 24, Train Y Loss = 2.83100,  Train X Loss = 1.86917, Val Loss = 2.73525
2025-01-16 19:30:44.921100 Epoch 25, Train Y Loss = 2.82679,  Train X Loss = 1.86512, Val Loss = 2.72517
2025-01-16 19:32:21.341908 Epoch 26, Train Y Loss = 2.74801,  Train X Loss = 1.82997, Val Loss = 2.66445
2025-01-16 19:34:04.714814 Epoch 27, Train Y Loss = 2.73720,  Train X Loss = 1.82269, Val Loss = 2.65832
2025-01-16 19:35:50.694119 Epoch 28, Train Y Loss = 2.73199,  Train X Loss = 1.81903, Val Loss = 2.67012
2025-01-16 19:37:28.502167 Epoch 29, Train Y Loss = 2.72757,  Train X Loss = 1.81826, Val Loss = 2.66383
2025-01-16 19:39:10.628945 Epoch 30, Train Y Loss = 2.72411,  Train X Loss = 1.81986, Val Loss = 2.66098
2025-01-16 19:40:56.626705 Epoch 31, Train Y Loss = 2.72077,  Train X Loss = 1.81859, Val Loss = 2.66718
2025-01-16 19:42:35.039209 Epoch 32, Train Y Loss = 2.71907,  Train X Loss = 1.81663, Val Loss = 2.67278
2025-01-16 19:44:16.713151 Epoch 33, Train Y Loss = 2.71752,  Train X Loss = 1.81522, Val Loss = 2.66173
2025-01-16 19:46:02.769765 Epoch 34, Train Y Loss = 2.71481,  Train X Loss = 1.81457, Val Loss = 2.66636
2025-01-16 19:47:43.335886 Epoch 35, Train Y Loss = 2.71213,  Train X Loss = 1.81587, Val Loss = 2.65811
2025-01-16 19:49:21.860376 Epoch 36, Train Y Loss = 2.70098,  Train X Loss = 1.81092, Val Loss = 2.65604
2025-01-16 19:50:54.512847 Epoch 37, Train Y Loss = 2.69866,  Train X Loss = 1.80887, Val Loss = 2.65413
2025-01-16 19:52:40.626864 Epoch 38, Train Y Loss = 2.69780,  Train X Loss = 1.81049, Val Loss = 2.65428
2025-01-16 19:54:19.354253 Epoch 39, Train Y Loss = 2.69672,  Train X Loss = 1.81030, Val Loss = 2.65710
2025-01-16 19:56:00.648322 Epoch 40, Train Y Loss = 2.69741,  Train X Loss = 1.81137, Val Loss = 2.65418
2025-01-16 19:57:46.928775 Epoch 41, Train Y Loss = 2.69705,  Train X Loss = 1.80879, Val Loss = 2.65221
2025-01-16 19:59:26.956414 Epoch 42, Train Y Loss = 2.69577,  Train X Loss = 1.80874, Val Loss = 2.65504
2025-01-16 20:01:06.911254 Epoch 43, Train Y Loss = 2.69630,  Train X Loss = 1.80923, Val Loss = 2.65355
2025-01-16 20:02:52.611979 Epoch 44, Train Y Loss = 2.69543,  Train X Loss = 1.80913, Val Loss = 2.65615
2025-01-16 20:04:33.568402 Epoch 45, Train Y Loss = 2.69536,  Train X Loss = 1.80946, Val Loss = 2.65733
2025-01-16 20:06:11.802663 Epoch 46, Train Y Loss = 2.69529,  Train X Loss = 1.80832, Val Loss = 2.65616
2025-01-16 20:07:57.270636 Epoch 47, Train Y Loss = 2.69434,  Train X Loss = 1.80793, Val Loss = 2.65537
2025-01-16 20:09:38.863070 Epoch 48, Train Y Loss = 2.69411,  Train X Loss = 1.80840, Val Loss = 2.65567
2025-01-16 20:11:17.833940 Epoch 49, Train Y Loss = 2.69308,  Train X Loss = 1.80734, Val Loss = 2.65651
Change mask ratio: 0.075
2025-01-16 20:13:02.418355 Epoch 50, Train Y Loss = 2.68095,  Train X Loss = 0.88467, Val Loss = 2.64837
2025-01-16 20:14:43.000980 Epoch 51, Train Y Loss = 2.68036,  Train X Loss = 0.88455, Val Loss = 2.64963
2025-01-16 20:16:20.466255 Epoch 52, Train Y Loss = 2.68048,  Train X Loss = 0.88508, Val Loss = 2.64875
2025-01-16 20:17:53.997644 Epoch 53, Train Y Loss = 2.67804,  Train X Loss = 0.88611, Val Loss = 2.64828
2025-01-16 20:19:38.766821 Epoch 54, Train Y Loss = 2.67730,  Train X Loss = 0.88550, Val Loss = 2.64864
2025-01-16 20:21:11.562068 Epoch 55, Train Y Loss = 2.67728,  Train X Loss = 0.88528, Val Loss = 2.64695
2025-01-16 20:22:56.624555 Epoch 56, Train Y Loss = 2.67732,  Train X Loss = 0.88562, Val Loss = 2.64953
2025-01-16 20:24:42.352923 Epoch 57, Train Y Loss = 2.67679,  Train X Loss = 0.88566, Val Loss = 2.64820
2025-01-16 20:26:15.072609 Epoch 58, Train Y Loss = 2.67590,  Train X Loss = 0.88553, Val Loss = 2.64723
2025-01-16 20:28:00.571770 Epoch 59, Train Y Loss = 2.67526,  Train X Loss = 0.88632, Val Loss = 2.64567
2025-01-16 20:29:46.017961 Epoch 60, Train Y Loss = 2.67440,  Train X Loss = 0.88531, Val Loss = 2.64691
2025-01-16 20:31:18.587061 Epoch 61, Train Y Loss = 2.67422,  Train X Loss = 0.88651, Val Loss = 2.64563
2025-01-16 20:33:03.270126 Epoch 62, Train Y Loss = 2.67420,  Train X Loss = 0.88629, Val Loss = 2.64732
2025-01-16 20:34:48.038043 Epoch 63, Train Y Loss = 2.67295,  Train X Loss = 0.88511, Val Loss = 2.64768
2025-01-16 20:36:20.290287 Epoch 64, Train Y Loss = 2.67329,  Train X Loss = 0.88609, Val Loss = 2.64765
2025-01-16 20:38:06.148209 Epoch 65, Train Y Loss = 2.67223,  Train X Loss = 0.88697, Val Loss = 2.64683
2025-01-16 20:39:52.012399 Epoch 66, Train Y Loss = 2.67282,  Train X Loss = 0.88670, Val Loss = 2.64800
2025-01-16 20:41:25.803974 Epoch 67, Train Y Loss = 2.67110,  Train X Loss = 0.88571, Val Loss = 2.64625
2025-01-16 20:43:10.714500 Epoch 68, Train Y Loss = 2.67055,  Train X Loss = 0.88698, Val Loss = 2.64878
2025-01-16 20:44:44.200035 Epoch 69, Train Y Loss = 2.67093,  Train X Loss = 0.88717, Val Loss = 2.64779
Change mask ratio: 0.0375
2025-01-16 20:46:29.305263 Epoch 70, Train Y Loss = 2.66302,  Train X Loss = 0.43791, Val Loss = 2.64627
2025-01-16 20:48:01.687130 Epoch 71, Train Y Loss = 2.66283,  Train X Loss = 0.43933, Val Loss = 2.64909
2025-01-16 20:49:46.489282 Epoch 72, Train Y Loss = 2.66213,  Train X Loss = 0.43828, Val Loss = 2.64477
2025-01-16 20:51:32.277413 Epoch 73, Train Y Loss = 2.66139,  Train X Loss = 0.43869, Val Loss = 2.64579
2025-01-16 20:53:04.926327 Epoch 74, Train Y Loss = 2.66016,  Train X Loss = 0.43925, Val Loss = 2.64699
2025-01-16 20:54:50.244571 Epoch 75, Train Y Loss = 2.65908,  Train X Loss = 0.43880, Val Loss = 2.64814
2025-01-16 20:56:34.897126 Epoch 76, Train Y Loss = 2.65924,  Train X Loss = 0.44030, Val Loss = 2.64684
2025-01-16 20:58:07.534266 Epoch 77, Train Y Loss = 2.65884,  Train X Loss = 0.43951, Val Loss = 2.64686
2025-01-16 20:59:52.799655 Epoch 78, Train Y Loss = 2.65746,  Train X Loss = 0.43938, Val Loss = 2.64566
2025-01-16 21:01:35.767532 Epoch 79, Train Y Loss = 2.65736,  Train X Loss = 0.44017, Val Loss = 2.64815
2025-01-16 21:03:09.489438 Epoch 80, Train Y Loss = 2.65743,  Train X Loss = 0.43959, Val Loss = 2.64620
Change mask ratio: 0.0
2025-01-16 21:04:50.574542 Epoch 81, Train Y Loss = 2.64889,  Train X Loss = 0.00000, Val Loss = 2.64190
2025-01-16 21:06:14.152631 Epoch 82, Train Y Loss = 2.64789,  Train X Loss = 0.00000, Val Loss = 2.64918
2025-01-16 21:07:55.061104 Epoch 83, Train Y Loss = 2.64683,  Train X Loss = 0.00000, Val Loss = 2.64566
2025-01-16 21:09:18.158435 Epoch 84, Train Y Loss = 2.64569,  Train X Loss = 0.00000, Val Loss = 2.64466
2025-01-16 21:10:58.544388 Epoch 85, Train Y Loss = 2.64499,  Train X Loss = 0.00000, Val Loss = 2.64368
2025-01-16 21:12:20.464239 Epoch 86, Train Y Loss = 2.64393,  Train X Loss = 0.00000, Val Loss = 2.64270
2025-01-16 21:13:43.188460 Epoch 87, Train Y Loss = 2.64263,  Train X Loss = 0.00000, Val Loss = 2.64003
2025-01-16 21:15:20.784871 Epoch 88, Train Y Loss = 2.64187,  Train X Loss = 0.00000, Val Loss = 2.64253
2025-01-16 21:16:47.781287 Epoch 89, Train Y Loss = 2.64193,  Train X Loss = 0.00000, Val Loss = 2.64277
2025-01-16 21:18:26.153583 Epoch 90, Train Y Loss = 2.64162,  Train X Loss = 0.00000, Val Loss = 2.64366
2025-01-16 21:19:52.147381 Epoch 91, Train Y Loss = 2.64101,  Train X Loss = 0.00000, Val Loss = 2.64417
2025-01-16 21:21:31.867363 Epoch 92, Train Y Loss = 2.63986,  Train X Loss = 0.00000, Val Loss = 2.64313
2025-01-16 21:22:56.496295 Epoch 93, Train Y Loss = 2.63849,  Train X Loss = 0.00000, Val Loss = 2.64446
2025-01-16 21:24:35.384566 Epoch 94, Train Y Loss = 2.63757,  Train X Loss = 0.00000, Val Loss = 2.64343
2025-01-16 21:26:00.628938 Epoch 95, Train Y Loss = 2.63728,  Train X Loss = 0.00000, Val Loss = 2.64652
Change mask ratio: 0.0
2025-01-16 21:27:39.677147 Epoch 96, Train Y Loss = 2.63653,  Train X Loss = 0.00000, Val Loss = 2.64260
2025-01-16 21:29:04.728022 Epoch 97, Train Y Loss = 2.63610,  Train X Loss = 0.00000, Val Loss = 2.64354
2025-01-16 21:30:44.678482 Epoch 98, Train Y Loss = 2.63419,  Train X Loss = 0.00000, Val Loss = 2.64422
2025-01-16 21:32:09.435309 Epoch 99, Train Y Loss = 2.63402,  Train X Loss = 0.00000, Val Loss = 2.64097
2025-01-16 21:33:50.054800 Epoch 100, Train Y Loss = 2.63317,  Train X Loss = 0.00000, Val Loss = 2.64415
Early stopping at epoch: 100
Best at epoch 87:
Train Loss = 2.64263
Train RMSE = 5.23813, MAE = 2.61082, MAPE = 6.83717
Val Loss = 2.64003
Val RMSE = 5.56447, MAE = 2.69078, MAPE = 7.33552
--------- Test ---------
All Steps RMSE = 5.90557, MAE = 2.90018, MAPE = 7.87954
Step 1 RMSE = 3.73354, MAE = 2.15410, MAPE = 5.07454
Step 2 RMSE = 4.48610, MAE = 2.42784, MAPE = 5.99504
Step 3 RMSE = 4.99114, MAE = 2.60900, MAPE = 6.67685
Step 4 RMSE = 5.38312, MAE = 2.74401, MAPE = 7.20256
Step 5 RMSE = 5.69522, MAE = 2.85123, MAPE = 7.63631
Step 6 RMSE = 5.96185, MAE = 2.94407, MAPE = 8.01118
Step 7 RMSE = 6.19665, MAE = 3.02507, MAPE = 8.34400
Step 8 RMSE = 6.39796, MAE = 3.09550, MAPE = 8.65258
Step 9 RMSE = 6.56439, MAE = 3.15851, MAPE = 8.91089
Step 10 RMSE = 6.70742, MAE = 3.21376, MAPE = 9.14216
Step 11 RMSE = 6.83536, MAE = 3.26325, MAPE = 9.34973
Step 12 RMSE = 6.96010, MAE = 3.31590, MAPE = 9.55880
Inference time: 7.75 s
