PEMSBAY
--------- DMRCMLP ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        15,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 51970489,
    "gpu": [
        6
    ],
    "save": false,
    "model_args": {
        "num_nodes": 325,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        385,212
├─Linear: 1-1                                 [16, 12, 325, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 325, 48]         --
│    └─Embedding: 2-1                         [16, 12, 325, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 325, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 325, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 325, 144]        158,224
├─Predictor: 1-4                              [16, 12, 325, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 325, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 325, 144]        41,760
│    └─Linear: 2-6                            [16, 325, 12]             20,748
===============================================================================================
Total params: 1,129,504
Trainable params: 1,129,504
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.75
Forward/backward pass size (MB): 2847.94
Params size (MB): 2.98
Estimated Total Size (MB): 2851.66
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMSBAY-2025-01-20-19-40-35.pt
2025-01-20 19:43:57.500827 Epoch 1, Train Y Loss = 2.06247,  Train X Loss = 0.00000, Val Loss = 1.99639
2025-01-20 19:47:19.429393 Epoch 2, Train Y Loss = 1.70345,  Train X Loss = 0.00000, Val Loss = 1.79200
2025-01-20 19:50:41.169256 Epoch 3, Train Y Loss = 1.62462,  Train X Loss = 0.00000, Val Loss = 1.76252
2025-01-20 19:54:02.549193 Epoch 4, Train Y Loss = 1.58310,  Train X Loss = 0.00000, Val Loss = 1.68217
2025-01-20 19:57:24.122433 Epoch 5, Train Y Loss = 1.55171,  Train X Loss = 0.00000, Val Loss = 1.68564
2025-01-20 20:00:45.894731 Epoch 6, Train Y Loss = 1.52848,  Train X Loss = 0.00000, Val Loss = 1.68918
2025-01-20 20:04:08.339012 Epoch 7, Train Y Loss = 1.51015,  Train X Loss = 0.00000, Val Loss = 1.62149
2025-01-20 20:07:30.431313 Epoch 8, Train Y Loss = 1.49694,  Train X Loss = 0.00000, Val Loss = 1.62761
2025-01-20 20:10:52.057252 Epoch 9, Train Y Loss = 1.48745,  Train X Loss = 0.00000, Val Loss = 1.66719
2025-01-20 20:14:13.596997 Epoch 10, Train Y Loss = 1.47825,  Train X Loss = 0.00000, Val Loss = 1.60180
2025-01-20 20:17:34.926296 Epoch 11, Train Y Loss = 1.46845,  Train X Loss = 0.00000, Val Loss = 1.61931
2025-01-20 20:20:56.409621 Epoch 12, Train Y Loss = 1.46179,  Train X Loss = 0.00000, Val Loss = 1.59929
2025-01-20 20:24:17.890388 Epoch 13, Train Y Loss = 1.45501,  Train X Loss = 0.00000, Val Loss = 1.58663
2025-01-20 20:27:39.675467 Epoch 14, Train Y Loss = 1.44951,  Train X Loss = 0.00000, Val Loss = 1.59794
2025-01-20 20:31:01.358855 Epoch 15, Train Y Loss = 1.44478,  Train X Loss = 0.00000, Val Loss = 1.58864
2025-01-20 20:34:22.750947 Epoch 16, Train Y Loss = 1.39528,  Train X Loss = 0.00000, Val Loss = 1.54221
2025-01-20 20:37:44.509625 Epoch 17, Train Y Loss = 1.38511,  Train X Loss = 0.00000, Val Loss = 1.54020
2025-01-20 20:41:06.677883 Epoch 18, Train Y Loss = 1.38163,  Train X Loss = 0.00000, Val Loss = 1.53741
2025-01-20 20:44:29.906556 Epoch 19, Train Y Loss = 1.37689,  Train X Loss = 0.00000, Val Loss = 1.53300
2025-01-20 20:47:51.866702 Epoch 20, Train Y Loss = 1.37344,  Train X Loss = 0.00000, Val Loss = 1.53674
2025-01-20 20:51:13.356927 Epoch 21, Train Y Loss = 1.37087,  Train X Loss = 0.00000, Val Loss = 1.53326
2025-01-20 20:54:35.082703 Epoch 22, Train Y Loss = 1.36826,  Train X Loss = 0.00000, Val Loss = 1.53791
2025-01-20 20:57:56.768862 Epoch 23, Train Y Loss = 1.36612,  Train X Loss = 0.00000, Val Loss = 1.53574
2025-01-20 21:01:18.615089 Epoch 24, Train Y Loss = 1.36355,  Train X Loss = 0.00000, Val Loss = 1.53483
2025-01-20 21:04:40.355318 Epoch 25, Train Y Loss = 1.36073,  Train X Loss = 0.00000, Val Loss = 1.53565
2025-01-20 21:08:01.864774 Epoch 26, Train Y Loss = 1.35829,  Train X Loss = 0.00000, Val Loss = 1.53113
2025-01-20 21:11:23.797937 Epoch 27, Train Y Loss = 1.35634,  Train X Loss = 0.00000, Val Loss = 1.53412
2025-01-20 21:14:45.344365 Epoch 28, Train Y Loss = 1.35452,  Train X Loss = 0.00000, Val Loss = 1.53141
2025-01-20 21:18:06.981499 Epoch 29, Train Y Loss = 1.35227,  Train X Loss = 0.00000, Val Loss = 1.53674
2025-01-20 21:21:28.087290 Epoch 30, Train Y Loss = 1.35063,  Train X Loss = 0.00000, Val Loss = 1.53346
2025-01-20 21:24:49.236277 Epoch 31, Train Y Loss = 1.34822,  Train X Loss = 0.00000, Val Loss = 1.52919
2025-01-20 21:28:11.367873 Epoch 32, Train Y Loss = 1.34650,  Train X Loss = 0.00000, Val Loss = 1.53211
2025-01-20 21:31:33.335340 Epoch 33, Train Y Loss = 1.34481,  Train X Loss = 0.00000, Val Loss = 1.53641
2025-01-20 21:34:55.165955 Epoch 34, Train Y Loss = 1.34314,  Train X Loss = 0.00000, Val Loss = 1.53204
2025-01-20 21:38:16.563124 Epoch 35, Train Y Loss = 1.34160,  Train X Loss = 0.00000, Val Loss = 1.53210
2025-01-20 21:41:38.146218 Epoch 36, Train Y Loss = 1.33290,  Train X Loss = 0.00000, Val Loss = 1.52681
2025-01-20 21:44:59.557372 Epoch 37, Train Y Loss = 1.33215,  Train X Loss = 0.00000, Val Loss = 1.52474
2025-01-20 21:48:21.066619 Epoch 38, Train Y Loss = 1.33095,  Train X Loss = 0.00000, Val Loss = 1.52485
2025-01-20 21:51:42.187679 Epoch 39, Train Y Loss = 1.33021,  Train X Loss = 0.00000, Val Loss = 1.52504
2025-01-20 21:55:03.592964 Epoch 40, Train Y Loss = 1.33121,  Train X Loss = 0.00000, Val Loss = 1.52516
2025-01-20 21:58:25.462635 Epoch 41, Train Y Loss = 1.33085,  Train X Loss = 0.00000, Val Loss = 1.52563
2025-01-20 22:01:47.186047 Epoch 42, Train Y Loss = 1.32975,  Train X Loss = 0.00000, Val Loss = 1.52562
2025-01-20 22:05:08.555261 Epoch 43, Train Y Loss = 1.32864,  Train X Loss = 0.00000, Val Loss = 1.52480
2025-01-20 22:08:29.812625 Epoch 44, Train Y Loss = 1.32896,  Train X Loss = 0.00000, Val Loss = 1.52550
2025-01-20 22:11:51.013368 Epoch 45, Train Y Loss = 1.32851,  Train X Loss = 0.00000, Val Loss = 1.52653
Change mask ratio: 0.075
2025-01-20 22:15:10.845364 Epoch 46, Train Y Loss = 1.31884,  Train X Loss = 0.00000, Val Loss = 1.52398
2025-01-20 22:18:30.749007 Epoch 47, Train Y Loss = 1.31893,  Train X Loss = 0.00000, Val Loss = 1.52439
2025-01-20 22:21:50.326135 Epoch 48, Train Y Loss = 1.31731,  Train X Loss = 0.00000, Val Loss = 1.52265
2025-01-20 22:25:09.863674 Epoch 49, Train Y Loss = 1.31685,  Train X Loss = 0.00000, Val Loss = 1.52167
2025-01-20 22:28:29.458766 Epoch 50, Train Y Loss = 1.31666,  Train X Loss = 0.00000, Val Loss = 1.52171
2025-01-20 22:31:49.231839 Epoch 51, Train Y Loss = 1.31607,  Train X Loss = 0.00000, Val Loss = 1.52292
2025-01-20 22:35:09.205621 Epoch 52, Train Y Loss = 1.31576,  Train X Loss = 0.00000, Val Loss = 1.52173
2025-01-20 22:38:29.123905 Epoch 53, Train Y Loss = 1.31610,  Train X Loss = 0.00000, Val Loss = 1.52215
2025-01-20 22:41:49.389169 Epoch 54, Train Y Loss = 1.31522,  Train X Loss = 0.00000, Val Loss = 1.52192
2025-01-20 22:45:09.381017 Epoch 55, Train Y Loss = 1.31550,  Train X Loss = 0.00000, Val Loss = 1.52256
2025-01-20 22:48:29.530983 Epoch 56, Train Y Loss = 1.31493,  Train X Loss = 0.00000, Val Loss = 1.52266
2025-01-20 22:51:49.681381 Epoch 57, Train Y Loss = 1.31388,  Train X Loss = 0.00000, Val Loss = 1.52206
Change mask ratio: 0.0375
2025-01-20 22:55:09.167098 Epoch 58, Train Y Loss = 1.30876,  Train X Loss = 0.00000, Val Loss = 1.52249
2025-01-20 22:58:29.066105 Epoch 59, Train Y Loss = 1.30827,  Train X Loss = 0.00000, Val Loss = 1.52231
2025-01-20 23:01:48.197768 Epoch 60, Train Y Loss = 1.30767,  Train X Loss = 0.00000, Val Loss = 1.52308
2025-01-20 23:05:07.573487 Epoch 61, Train Y Loss = 1.30783,  Train X Loss = 0.00000, Val Loss = 1.52303
2025-01-20 23:08:26.920914 Epoch 62, Train Y Loss = 1.30662,  Train X Loss = 0.00000, Val Loss = 1.52249
2025-01-20 23:11:45.926189 Epoch 63, Train Y Loss = 1.30597,  Train X Loss = 0.00000, Val Loss = 1.52311
2025-01-20 23:15:05.067484 Epoch 64, Train Y Loss = 1.30582,  Train X Loss = 0.00000, Val Loss = 1.52340
2025-01-20 23:18:24.779905 Epoch 65, Train Y Loss = 1.30510,  Train X Loss = 0.00000, Val Loss = 1.52306
Change mask ratio: 0.0
2025-01-20 23:21:37.487217 Epoch 66, Train Y Loss = 1.29952,  Train X Loss = 0.00000, Val Loss = 1.52268
2025-01-20 23:24:50.043227 Epoch 67, Train Y Loss = 1.29857,  Train X Loss = 0.00000, Val Loss = 1.52433
2025-01-20 23:28:02.337526 Epoch 68, Train Y Loss = 1.29877,  Train X Loss = 0.00000, Val Loss = 1.52271
2025-01-20 23:31:14.587194 Epoch 69, Train Y Loss = 1.29766,  Train X Loss = 0.00000, Val Loss = 1.52387
2025-01-20 23:34:26.957561 Epoch 70, Train Y Loss = 1.29745,  Train X Loss = 0.00000, Val Loss = 1.52330
2025-01-20 23:37:39.324849 Epoch 71, Train Y Loss = 1.29633,  Train X Loss = 0.00000, Val Loss = 1.52460
2025-01-20 23:40:51.751738 Epoch 72, Train Y Loss = 1.29582,  Train X Loss = 0.00000, Val Loss = 1.52331
2025-01-20 23:44:04.157460 Epoch 73, Train Y Loss = 1.29492,  Train X Loss = 0.00000, Val Loss = 1.52474
Change mask ratio: 0.0
2025-01-20 23:47:16.736549 Epoch 74, Train Y Loss = 1.29487,  Train X Loss = 0.00000, Val Loss = 1.52473
2025-01-20 23:50:29.374248 Epoch 75, Train Y Loss = 1.29413,  Train X Loss = 0.00000, Val Loss = 1.52495
2025-01-20 23:53:41.834927 Epoch 76, Train Y Loss = 1.29320,  Train X Loss = 0.00000, Val Loss = 1.52444
2025-01-20 23:56:54.152059 Epoch 77, Train Y Loss = 1.29341,  Train X Loss = 0.00000, Val Loss = 1.52600
2025-01-21 00:00:06.647100 Epoch 78, Train Y Loss = 1.29304,  Train X Loss = 0.00000, Val Loss = 1.52471
2025-01-21 00:03:19.133788 Epoch 79, Train Y Loss = 1.29200,  Train X Loss = 0.00000, Val Loss = 1.52530
Early stopping at epoch: 79
Best at epoch 49:
Train Loss = 1.31685
Train RMSE = 2.86647, MAE = 1.28465, MAPE = 2.73142
Val Loss = 1.52167
Val RMSE = 3.55342, MAE = 1.51996, MAPE = 3.45468
--------- Test ---------
All Steps RMSE = 3.57671, MAE = 1.54353, MAPE = 3.48147
Step 1 RMSE = 1.63920, MAE = 0.86260, MAPE = 1.67103
Step 2 RMSE = 2.30162, MAE = 1.13473, MAPE = 2.32142
Step 3 RMSE = 2.80386, MAE = 1.31237, MAPE = 2.79168
Step 4 RMSE = 3.18473, MAE = 1.43895, MAPE = 3.15023
Step 5 RMSE = 3.46865, MAE = 1.53331, MAPE = 3.42907
Step 6 RMSE = 3.68627, MAE = 1.60835, MAPE = 3.65323
Step 7 RMSE = 3.85693, MAE = 1.66895, MAPE = 3.83314
Step 8 RMSE = 3.99120, MAE = 1.71832, MAPE = 3.97674
Step 9 RMSE = 4.09580, MAE = 1.75940, MAPE = 4.09295
Step 10 RMSE = 4.18187, MAE = 1.79576, MAPE = 4.19620
Step 11 RMSE = 4.25694, MAE = 1.82855, MAPE = 4.28815
Step 12 RMSE = 4.32613, MAE = 1.86101, MAPE = 4.37384
Inference time: 18.25 s
