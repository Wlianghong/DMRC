PEMS03
--------- DMRCMLP ---------
{
    "num_nodes": 358,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0005,
    "milestones": [
        20,
        35,
        50
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 120,
    "early_stop": 20,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 51970489,
    "gpu": [
        3
    ],
    "save": false,
    "model_args": {
        "num_nodes": 358,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        434,604
├─Linear: 1-1                                 [16, 12, 358, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 358, 48]         --
│    └─Embedding: 2-1                         [16, 12, 358, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 358, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 358, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 358, 144]        158,224
├─Predictor: 1-4                              [16, 12, 358, 1]          --
│    └─Linear: 2-5                            [16, 12, 358, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 358, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 358, 144]        41,760
│    └─Linear: 2-7                            [16, 358, 12]             20,748
===============================================================================================
Total params: 1,199,776
Trainable params: 1,199,776
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 0.82
Forward/backward pass size (MB): 3216.29
Params size (MB): 3.06
Estimated Total Size (MB): 3220.18
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS03-2025-01-16-13-53-14.pt
2025-01-16 13:55:30.275693 Epoch 1, Train Y Loss = 21.99335,  Train X Loss = 16.37224, Val Loss = 16.76627
2025-01-16 13:57:46.514457 Epoch 2, Train Y Loss = 16.66285,  Train X Loss = 12.95024, Val Loss = 17.09099
2025-01-16 14:00:02.892760 Epoch 3, Train Y Loss = 15.63065,  Train X Loss = 12.57154, Val Loss = 15.69990
2025-01-16 14:02:19.408731 Epoch 4, Train Y Loss = 15.04411,  Train X Loss = 11.42252, Val Loss = 14.87267
2025-01-16 14:04:35.903919 Epoch 5, Train Y Loss = 14.74235,  Train X Loss = 9.39933, Val Loss = 14.30623
2025-01-16 14:06:52.379422 Epoch 6, Train Y Loss = 14.26338,  Train X Loss = 8.80829, Val Loss = 14.64446
2025-01-16 14:09:07.651125 Epoch 7, Train Y Loss = 14.07948,  Train X Loss = 8.64679, Val Loss = 13.74667
2025-01-16 14:11:22.497179 Epoch 8, Train Y Loss = 13.81816,  Train X Loss = 8.41215, Val Loss = 13.88910
2025-01-16 14:13:37.288723 Epoch 9, Train Y Loss = 13.65563,  Train X Loss = 8.27736, Val Loss = 13.54298
2025-01-16 14:15:51.979929 Epoch 10, Train Y Loss = 13.52659,  Train X Loss = 8.15861, Val Loss = 14.01664
2025-01-16 14:18:06.520828 Epoch 11, Train Y Loss = 13.40228,  Train X Loss = 8.07057, Val Loss = 13.65286
2025-01-16 14:20:20.864473 Epoch 12, Train Y Loss = 13.25877,  Train X Loss = 8.03591, Val Loss = 13.55224
2025-01-16 14:22:35.756450 Epoch 13, Train Y Loss = 13.16045,  Train X Loss = 7.91363, Val Loss = 13.43715
2025-01-16 14:24:50.574525 Epoch 14, Train Y Loss = 13.13891,  Train X Loss = 7.89204, Val Loss = 13.47087
2025-01-16 14:27:05.230819 Epoch 15, Train Y Loss = 13.00725,  Train X Loss = 7.85463, Val Loss = 13.89634
2025-01-16 14:29:19.709096 Epoch 16, Train Y Loss = 12.97022,  Train X Loss = 7.79818, Val Loss = 13.38388
2025-01-16 14:31:34.304162 Epoch 17, Train Y Loss = 12.88360,  Train X Loss = 7.75777, Val Loss = 13.32632
2025-01-16 14:33:48.874856 Epoch 18, Train Y Loss = 12.83841,  Train X Loss = 7.69109, Val Loss = 13.22132
2025-01-16 14:36:03.623916 Epoch 19, Train Y Loss = 12.78839,  Train X Loss = 7.71393, Val Loss = 13.30072
2025-01-16 14:38:18.317882 Epoch 20, Train Y Loss = 12.74099,  Train X Loss = 7.66198, Val Loss = 13.21974
2025-01-16 14:40:32.912133 Epoch 21, Train Y Loss = 12.20192,  Train X Loss = 7.36766, Val Loss = 12.86762
2025-01-16 14:42:47.438164 Epoch 22, Train Y Loss = 12.14447,  Train X Loss = 7.32127, Val Loss = 12.92147
2025-01-16 14:45:02.112884 Epoch 23, Train Y Loss = 12.12037,  Train X Loss = 7.31105, Val Loss = 12.91864
2025-01-16 14:47:18.402189 Epoch 24, Train Y Loss = 12.10248,  Train X Loss = 7.30500, Val Loss = 12.89144
2025-01-16 14:49:33.853303 Epoch 25, Train Y Loss = 12.08869,  Train X Loss = 7.29205, Val Loss = 12.87859
2025-01-16 14:51:48.398896 Epoch 26, Train Y Loss = 12.07304,  Train X Loss = 7.28535, Val Loss = 12.93080
2025-01-16 14:54:02.582940 Epoch 27, Train Y Loss = 12.06016,  Train X Loss = 7.27518, Val Loss = 12.87867
2025-01-16 14:56:16.557709 Epoch 28, Train Y Loss = 12.04772,  Train X Loss = 7.26858, Val Loss = 12.83882
2025-01-16 14:58:30.447840 Epoch 29, Train Y Loss = 12.04008,  Train X Loss = 7.26195, Val Loss = 12.87099
2025-01-16 15:00:44.363639 Epoch 30, Train Y Loss = 12.02577,  Train X Loss = 7.25946, Val Loss = 12.86197
2025-01-16 15:02:58.066776 Epoch 31, Train Y Loss = 12.02032,  Train X Loss = 7.25302, Val Loss = 12.93675
2025-01-16 15:05:11.725083 Epoch 32, Train Y Loss = 12.00849,  Train X Loss = 7.24195, Val Loss = 12.89514
2025-01-16 15:07:25.319111 Epoch 33, Train Y Loss = 11.99879,  Train X Loss = 7.24264, Val Loss = 12.86889
2025-01-16 15:09:38.783255 Epoch 34, Train Y Loss = 11.99210,  Train X Loss = 7.23948, Val Loss = 12.85640
2025-01-16 15:11:52.512990 Epoch 35, Train Y Loss = 11.98388,  Train X Loss = 7.23306, Val Loss = 12.98873
2025-01-16 15:14:06.184361 Epoch 36, Train Y Loss = 11.91472,  Train X Loss = 7.20010, Val Loss = 12.83613
2025-01-16 15:16:19.851841 Epoch 37, Train Y Loss = 11.90501,  Train X Loss = 7.19692, Val Loss = 12.85533
2025-01-16 15:18:33.257507 Epoch 38, Train Y Loss = 11.90211,  Train X Loss = 7.19585, Val Loss = 12.85341
2025-01-16 15:20:46.906883 Epoch 39, Train Y Loss = 11.90070,  Train X Loss = 7.18754, Val Loss = 12.82828
2025-01-16 15:23:00.686781 Epoch 40, Train Y Loss = 11.89801,  Train X Loss = 7.19359, Val Loss = 12.84222
2025-01-16 15:25:14.808668 Epoch 41, Train Y Loss = 11.89754,  Train X Loss = 7.18852, Val Loss = 12.84649
2025-01-16 15:27:28.998514 Epoch 42, Train Y Loss = 11.89477,  Train X Loss = 7.18913, Val Loss = 12.83935
2025-01-16 15:29:43.211844 Epoch 43, Train Y Loss = 11.89339,  Train X Loss = 7.19132, Val Loss = 12.83037
2025-01-16 15:31:57.606959 Epoch 44, Train Y Loss = 11.89251,  Train X Loss = 7.18718, Val Loss = 12.85590
2025-01-16 15:34:12.042471 Epoch 45, Train Y Loss = 11.89071,  Train X Loss = 7.18216, Val Loss = 12.86660
2025-01-16 15:36:26.514741 Epoch 46, Train Y Loss = 11.88966,  Train X Loss = 7.18064, Val Loss = 12.86444
2025-01-16 15:38:40.996410 Epoch 47, Train Y Loss = 11.88909,  Train X Loss = 7.18923, Val Loss = 12.86001
Change mask ratio: 0.075
2025-01-16 15:40:52.102092 Epoch 48, Train Y Loss = 11.85108,  Train X Loss = 3.44832, Val Loss = 12.80166
2025-01-16 15:43:03.265844 Epoch 49, Train Y Loss = 11.84763,  Train X Loss = 3.44593, Val Loss = 12.79244
2025-01-16 15:45:14.170922 Epoch 50, Train Y Loss = 11.84455,  Train X Loss = 3.44694, Val Loss = 12.82630
2025-01-16 15:47:24.923547 Epoch 51, Train Y Loss = 11.83528,  Train X Loss = 3.44387, Val Loss = 12.80814
2025-01-16 15:49:35.629760 Epoch 52, Train Y Loss = 11.83470,  Train X Loss = 3.44566, Val Loss = 12.80526
2025-01-16 15:51:46.625005 Epoch 53, Train Y Loss = 11.83456,  Train X Loss = 3.44933, Val Loss = 12.81056
2025-01-16 15:53:57.744916 Epoch 54, Train Y Loss = 11.83316,  Train X Loss = 3.44571, Val Loss = 12.80816
2025-01-16 15:56:09.087187 Epoch 55, Train Y Loss = 11.83403,  Train X Loss = 3.44730, Val Loss = 12.80318
2025-01-16 15:58:20.351917 Epoch 56, Train Y Loss = 11.83368,  Train X Loss = 3.44608, Val Loss = 12.80799
2025-01-16 16:00:31.295045 Epoch 57, Train Y Loss = 11.83278,  Train X Loss = 3.44497, Val Loss = 12.80497
Change mask ratio: 0.0375
2025-01-16 16:02:40.701340 Epoch 58, Train Y Loss = 11.81733,  Train X Loss = 1.68909, Val Loss = 12.79578
2025-01-16 16:04:50.095304 Epoch 59, Train Y Loss = 11.81622,  Train X Loss = 1.69162, Val Loss = 12.79837
2025-01-16 16:06:59.503693 Epoch 60, Train Y Loss = 11.81499,  Train X Loss = 1.69172, Val Loss = 12.79201
2025-01-16 16:09:08.918302 Epoch 61, Train Y Loss = 11.81494,  Train X Loss = 1.68919, Val Loss = 12.79603
2025-01-16 16:11:18.322311 Epoch 62, Train Y Loss = 11.81369,  Train X Loss = 1.69050, Val Loss = 12.78731
2025-01-16 16:13:27.748855 Epoch 63, Train Y Loss = 11.81372,  Train X Loss = 1.68937, Val Loss = 12.79575
2025-01-16 16:15:37.126806 Epoch 64, Train Y Loss = 11.81411,  Train X Loss = 1.68774, Val Loss = 12.79259
2025-01-16 16:17:46.550161 Epoch 65, Train Y Loss = 11.81296,  Train X Loss = 1.68935, Val Loss = 12.79032
2025-01-16 16:19:55.871420 Epoch 66, Train Y Loss = 11.81263,  Train X Loss = 1.68764, Val Loss = 12.79182
2025-01-16 16:22:05.299618 Epoch 67, Train Y Loss = 11.81147,  Train X Loss = 1.69118, Val Loss = 12.78989
2025-01-16 16:24:14.597395 Epoch 68, Train Y Loss = 11.81140,  Train X Loss = 1.68817, Val Loss = 12.79354
2025-01-16 16:26:23.931053 Epoch 69, Train Y Loss = 11.81057,  Train X Loss = 1.68865, Val Loss = 12.78780
2025-01-16 16:28:33.146661 Epoch 70, Train Y Loss = 11.81088,  Train X Loss = 1.68815, Val Loss = 12.79777
Change mask ratio: 0.0
2025-01-16 16:30:22.340330 Epoch 71, Train Y Loss = 11.79716,  Train X Loss = 0.00000, Val Loss = 12.78045
2025-01-16 16:32:11.942918 Epoch 72, Train Y Loss = 11.79545,  Train X Loss = 0.00000, Val Loss = 12.77815
2025-01-16 16:34:01.794555 Epoch 73, Train Y Loss = 11.79409,  Train X Loss = 0.00000, Val Loss = 12.77766
2025-01-16 16:35:51.386352 Epoch 74, Train Y Loss = 11.79269,  Train X Loss = 0.00000, Val Loss = 12.77702
2025-01-16 16:37:40.553033 Epoch 75, Train Y Loss = 11.79235,  Train X Loss = 0.00000, Val Loss = 12.77388
2025-01-16 16:39:29.566512 Epoch 76, Train Y Loss = 11.79090,  Train X Loss = 0.00000, Val Loss = 12.77721
2025-01-16 16:41:18.567424 Epoch 77, Train Y Loss = 11.79096,  Train X Loss = 0.00000, Val Loss = 12.78180
2025-01-16 16:43:07.517135 Epoch 78, Train Y Loss = 11.79028,  Train X Loss = 0.00000, Val Loss = 12.77981
2025-01-16 16:44:56.948168 Epoch 79, Train Y Loss = 11.78910,  Train X Loss = 0.00000, Val Loss = 12.77252
2025-01-16 16:46:46.334520 Epoch 80, Train Y Loss = 11.78803,  Train X Loss = 0.00000, Val Loss = 12.77946
2025-01-16 16:48:35.358410 Epoch 81, Train Y Loss = 11.78695,  Train X Loss = 0.00000, Val Loss = 12.77414
2025-01-16 16:50:24.947051 Epoch 82, Train Y Loss = 11.78735,  Train X Loss = 0.00000, Val Loss = 12.77803
2025-01-16 16:52:14.187774 Epoch 83, Train Y Loss = 11.78633,  Train X Loss = 0.00000, Val Loss = 12.77450
2025-01-16 16:54:03.051377 Epoch 84, Train Y Loss = 11.78566,  Train X Loss = 0.00000, Val Loss = 12.77742
2025-01-16 16:55:51.964543 Epoch 85, Train Y Loss = 11.78438,  Train X Loss = 0.00000, Val Loss = 12.77749
2025-01-16 16:57:40.806897 Epoch 86, Train Y Loss = 11.78347,  Train X Loss = 0.00000, Val Loss = 12.77461
2025-01-16 16:59:29.674673 Epoch 87, Train Y Loss = 11.78304,  Train X Loss = 0.00000, Val Loss = 12.77543
Change mask ratio: 0.0
2025-01-16 17:01:19.072260 Epoch 88, Train Y Loss = 11.78256,  Train X Loss = 0.00000, Val Loss = 12.77262
2025-01-16 17:03:08.030469 Epoch 89, Train Y Loss = 11.78203,  Train X Loss = 0.00000, Val Loss = 12.77733
2025-01-16 17:04:57.218526 Epoch 90, Train Y Loss = 11.78132,  Train X Loss = 0.00000, Val Loss = 12.78147
2025-01-16 17:06:46.682609 Epoch 91, Train Y Loss = 11.78098,  Train X Loss = 0.00000, Val Loss = 12.77405
2025-01-16 17:08:35.711968 Epoch 92, Train Y Loss = 11.78052,  Train X Loss = 0.00000, Val Loss = 12.77242
2025-01-16 17:10:24.931574 Epoch 93, Train Y Loss = 11.77960,  Train X Loss = 0.00000, Val Loss = 12.77950
2025-01-16 17:12:14.373497 Epoch 94, Train Y Loss = 11.77855,  Train X Loss = 0.00000, Val Loss = 12.77423
2025-01-16 17:14:04.119630 Epoch 95, Train Y Loss = 11.77894,  Train X Loss = 0.00000, Val Loss = 12.77325
2025-01-16 17:15:53.843010 Epoch 96, Train Y Loss = 11.77835,  Train X Loss = 0.00000, Val Loss = 12.77954
2025-01-16 17:17:43.355598 Epoch 97, Train Y Loss = 11.77709,  Train X Loss = 0.00000, Val Loss = 12.77733
2025-01-16 17:19:32.841203 Epoch 98, Train Y Loss = 11.77687,  Train X Loss = 0.00000, Val Loss = 12.77759
2025-01-16 17:21:22.138295 Epoch 99, Train Y Loss = 11.77614,  Train X Loss = 0.00000, Val Loss = 12.77481
2025-01-16 17:23:11.714970 Epoch 100, Train Y Loss = 11.77558,  Train X Loss = 0.00000, Val Loss = 12.77484
Change mask ratio: 0.0
2025-01-16 17:25:01.308636 Epoch 101, Train Y Loss = 11.77463,  Train X Loss = 0.00000, Val Loss = 12.77650
2025-01-16 17:26:50.637597 Epoch 102, Train Y Loss = 11.77436,  Train X Loss = 0.00000, Val Loss = 12.77332
2025-01-16 17:28:39.922116 Epoch 103, Train Y Loss = 11.77389,  Train X Loss = 0.00000, Val Loss = 12.77356
2025-01-16 17:30:29.225132 Epoch 104, Train Y Loss = 11.77371,  Train X Loss = 0.00000, Val Loss = 12.77819
2025-01-16 17:32:18.511557 Epoch 105, Train Y Loss = 11.77279,  Train X Loss = 0.00000, Val Loss = 12.77415
2025-01-16 17:34:07.672082 Epoch 106, Train Y Loss = 11.77197,  Train X Loss = 0.00000, Val Loss = 12.77167
2025-01-16 17:35:56.760848 Epoch 107, Train Y Loss = 11.77096,  Train X Loss = 0.00000, Val Loss = 12.77460
2025-01-16 17:37:45.786286 Epoch 108, Train Y Loss = 11.77102,  Train X Loss = 0.00000, Val Loss = 12.77289
2025-01-16 17:39:34.891474 Epoch 109, Train Y Loss = 11.77115,  Train X Loss = 0.00000, Val Loss = 12.77580
2025-01-16 17:41:24.026940 Epoch 110, Train Y Loss = 11.76956,  Train X Loss = 0.00000, Val Loss = 12.76919
2025-01-16 17:43:13.245701 Epoch 111, Train Y Loss = 11.76926,  Train X Loss = 0.00000, Val Loss = 12.76953
2025-01-16 17:45:02.419187 Epoch 112, Train Y Loss = 11.76935,  Train X Loss = 0.00000, Val Loss = 12.77468
2025-01-16 17:46:51.717230 Epoch 113, Train Y Loss = 11.76789,  Train X Loss = 0.00000, Val Loss = 12.77361
2025-01-16 17:48:40.982134 Epoch 114, Train Y Loss = 11.76674,  Train X Loss = 0.00000, Val Loss = 12.77881
2025-01-16 17:50:30.185668 Epoch 115, Train Y Loss = 11.76778,  Train X Loss = 0.00000, Val Loss = 12.77987
2025-01-16 17:52:19.476631 Epoch 116, Train Y Loss = 11.76736,  Train X Loss = 0.00000, Val Loss = 12.76787
2025-01-16 17:54:08.702222 Epoch 117, Train Y Loss = 11.76619,  Train X Loss = 0.00000, Val Loss = 12.77050
2025-01-16 17:55:57.780392 Epoch 118, Train Y Loss = 11.76514,  Train X Loss = 0.00000, Val Loss = 12.76818
2025-01-16 17:57:46.925937 Epoch 119, Train Y Loss = 11.76541,  Train X Loss = 0.00000, Val Loss = 12.77343
2025-01-16 17:59:36.079789 Epoch 120, Train Y Loss = 11.76447,  Train X Loss = 0.00000, Val Loss = 12.77445
Early stopping at epoch: 120
Best at epoch 116:
Train Loss = 11.76736
Train RMSE = 20.23773, MAE = 12.24797, MAPE = 11.20983
Val Loss = 12.76787
Val RMSE = 21.55008, MAE = 13.29963, MAPE = 12.50508
--------- Test ---------
All Steps RMSE = 25.75693, MAE = 14.90358, MAPE = 14.91428
Step 1 RMSE = 19.48110, MAE = 12.11312, MAPE = 12.59976
Step 2 RMSE = 21.66398, MAE = 13.04117, MAPE = 13.43750
Step 3 RMSE = 23.15764, MAE = 13.66325, MAPE = 13.93741
Step 4 RMSE = 24.36380, MAE = 14.16982, MAPE = 14.29745
Step 5 RMSE = 25.24827, MAE = 14.58101, MAPE = 14.61004
Step 6 RMSE = 25.94988, MAE = 14.93817, MAPE = 14.89600
Step 7 RMSE = 26.60870, MAE = 15.29480, MAPE = 15.18866
Step 8 RMSE = 27.16886, MAE = 15.61560, MAPE = 15.46305
Step 9 RMSE = 27.67962, MAE = 15.91755, MAPE = 15.71828
Step 10 RMSE = 28.16063, MAE = 16.21041, MAPE = 15.99508
Step 11 RMSE = 28.62972, MAE = 16.49709, MAPE = 16.26420
Step 12 RMSE = 29.09334, MAE = 16.80093, MAPE = 16.56400
Inference time: 10.69 s
