PEMS07
--------- DMRCMLP ---------
{
    "num_nodes": 883,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.001,
    "milestones": [
        20,
        40,
        55
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 120,
    "early_stop": 25,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 6,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 34110658,
    "gpu": [
        4,
        5
    ],
    "save": false,
    "model_args": {
        "num_nodes": 883,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        888,204
├─Linear: 1-1                                 [16, 12, 883, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 883, 48]         --
│    └─Embedding: 2-1                         [16, 12, 883, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 883, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 883, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 883, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 883, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 883, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 883, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 883, 144]        158,224
├─Predictor: 1-4                              [16, 12, 883, 1]          --
│    └─Linear: 2-5                            [16, 12, 883, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 883, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 883, 144]        41,760
│    └─Linear: 2-7                            [16, 883, 12]             20,748
===============================================================================================
Total params: 1,653,376
Trainable params: 1,653,376
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 2.03
Forward/backward pass size (MB): 7932.93
Params size (MB): 3.06
Estimated Total Size (MB): 7938.02
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS07-2025-01-16-23-14-26.pt
2025-01-16 23:19:47.278448 Epoch 1, Train Y Loss = 31.44312,  Train X Loss = 22.52233, Val Loss = 24.37402
2025-01-16 23:25:08.028303 Epoch 2, Train Y Loss = 24.63519,  Train X Loss = 17.86799, Val Loss = 24.34398
2025-01-16 23:30:28.981111 Epoch 3, Train Y Loss = 22.85359,  Train X Loss = 17.11759, Val Loss = 22.09006
2025-01-16 23:35:50.130758 Epoch 4, Train Y Loss = 22.08907,  Train X Loss = 16.90301, Val Loss = 21.64672
2025-01-16 23:41:11.140491 Epoch 5, Train Y Loss = 21.38451,  Train X Loss = 16.32017, Val Loss = 20.99945
2025-01-16 23:46:32.077868 Epoch 6, Train Y Loss = 21.10667,  Train X Loss = 13.46536, Val Loss = 21.05399
2025-01-16 23:51:52.783378 Epoch 7, Train Y Loss = 20.50947,  Train X Loss = 11.99434, Val Loss = 20.34412
2025-01-16 23:57:08.574733 Epoch 8, Train Y Loss = 20.24940,  Train X Loss = 11.71587, Val Loss = 20.54344
2025-01-17 00:02:23.838800 Epoch 9, Train Y Loss = 19.94972,  Train X Loss = 11.51287, Val Loss = 20.30611
2025-01-17 00:07:39.269792 Epoch 10, Train Y Loss = 19.70853,  Train X Loss = 11.38163, Val Loss = 19.88059
2025-01-17 00:12:52.439413 Epoch 11, Train Y Loss = 19.48883,  Train X Loss = 11.20021, Val Loss = 19.78232
2025-01-17 00:18:09.272550 Epoch 12, Train Y Loss = 19.34302,  Train X Loss = 11.13966, Val Loss = 19.88622
2025-01-17 00:23:30.384836 Epoch 13, Train Y Loss = 19.20404,  Train X Loss = 10.99462, Val Loss = 19.65560
2025-01-17 00:28:51.063571 Epoch 14, Train Y Loss = 19.06110,  Train X Loss = 10.91413, Val Loss = 19.67577
2025-01-17 00:34:11.409218 Epoch 15, Train Y Loss = 18.88457,  Train X Loss = 10.85665, Val Loss = 19.33923
2025-01-17 00:39:31.935835 Epoch 16, Train Y Loss = 18.71554,  Train X Loss = 10.73598, Val Loss = 19.33384
2025-01-17 00:44:50.142921 Epoch 17, Train Y Loss = 18.63358,  Train X Loss = 10.73431, Val Loss = 19.25392
2025-01-17 00:50:11.903141 Epoch 18, Train Y Loss = 18.57739,  Train X Loss = 10.65453, Val Loss = 19.17870
2025-01-17 00:55:33.668359 Epoch 19, Train Y Loss = 18.41439,  Train X Loss = 10.62033, Val Loss = 19.24111
2025-01-17 01:00:54.398776 Epoch 20, Train Y Loss = 18.41309,  Train X Loss = 10.64655, Val Loss = 19.47623
2025-01-17 01:06:12.788008 Epoch 21, Train Y Loss = 17.60717,  Train X Loss = 10.18687, Val Loss = 18.62452
2025-01-17 01:11:35.249650 Epoch 22, Train Y Loss = 17.50205,  Train X Loss = 10.13770, Val Loss = 18.66572
2025-01-17 01:16:57.512757 Epoch 23, Train Y Loss = 17.46130,  Train X Loss = 10.12185, Val Loss = 18.61638
2025-01-17 01:22:20.156455 Epoch 24, Train Y Loss = 17.42910,  Train X Loss = 10.11344, Val Loss = 18.71151
2025-01-17 01:27:42.054763 Epoch 25, Train Y Loss = 17.39763,  Train X Loss = 10.09630, Val Loss = 18.73222
2025-01-17 01:33:03.420150 Epoch 26, Train Y Loss = 17.36981,  Train X Loss = 10.08706, Val Loss = 18.70277
2025-01-17 01:38:25.753949 Epoch 27, Train Y Loss = 17.34442,  Train X Loss = 10.07554, Val Loss = 18.67598
2025-01-17 01:43:48.381258 Epoch 28, Train Y Loss = 17.32369,  Train X Loss = 10.06527, Val Loss = 18.67194
2025-01-17 01:49:10.401385 Epoch 29, Train Y Loss = 17.29966,  Train X Loss = 10.06128, Val Loss = 18.77131
Change mask ratio: 0.075
2025-01-17 01:54:35.337631 Epoch 30, Train Y Loss = 17.19395,  Train X Loss = 4.87579, Val Loss = 18.50279
2025-01-17 02:00:02.139106 Epoch 31, Train Y Loss = 17.15805,  Train X Loss = 4.87927, Val Loss = 18.54350
2025-01-17 02:05:27.949374 Epoch 32, Train Y Loss = 17.13474,  Train X Loss = 4.88309, Val Loss = 18.47419
2025-01-17 02:10:54.019067 Epoch 33, Train Y Loss = 17.11019,  Train X Loss = 4.88838, Val Loss = 18.65378
2025-01-17 02:16:17.400210 Epoch 34, Train Y Loss = 17.08550,  Train X Loss = 4.89053, Val Loss = 18.48242
2025-01-17 02:21:39.331886 Epoch 35, Train Y Loss = 17.06924,  Train X Loss = 4.89116, Val Loss = 18.45671
2025-01-17 02:27:02.858354 Epoch 36, Train Y Loss = 17.04983,  Train X Loss = 4.88929, Val Loss = 18.51043
2025-01-17 02:33:26.567361 Epoch 37, Train Y Loss = 17.03084,  Train X Loss = 4.89423, Val Loss = 18.42270
2025-01-17 02:42:17.875825 Epoch 38, Train Y Loss = 17.01501,  Train X Loss = 4.89233, Val Loss = 18.45131
2025-01-17 02:51:09.343581 Epoch 39, Train Y Loss = 16.99763,  Train X Loss = 4.88866, Val Loss = 18.40938
2025-01-17 03:00:01.339188 Epoch 40, Train Y Loss = 16.98058,  Train X Loss = 4.88944, Val Loss = 18.38940
2025-01-17 03:08:53.080988 Epoch 41, Train Y Loss = 16.87119,  Train X Loss = 4.87134, Val Loss = 18.38238
2025-01-17 03:17:44.669111 Epoch 42, Train Y Loss = 16.85848,  Train X Loss = 4.86848, Val Loss = 18.41159
2025-01-17 03:26:35.862940 Epoch 43, Train Y Loss = 16.85470,  Train X Loss = 4.86671, Val Loss = 18.41938
2025-01-17 03:35:27.096371 Epoch 44, Train Y Loss = 16.85076,  Train X Loss = 4.86688, Val Loss = 18.42501
2025-01-17 03:44:18.768352 Epoch 45, Train Y Loss = 16.84625,  Train X Loss = 4.86558, Val Loss = 18.42346
2025-01-17 03:53:09.902157 Epoch 46, Train Y Loss = 16.84326,  Train X Loss = 4.86927, Val Loss = 18.40580
2025-01-17 04:02:00.676626 Epoch 47, Train Y Loss = 16.83980,  Train X Loss = 4.86731, Val Loss = 18.47203
Change mask ratio: 0.0375
2025-01-17 04:10:51.293037 Epoch 48, Train Y Loss = 16.78635,  Train X Loss = 2.39855, Val Loss = 18.30792
2025-01-17 04:19:42.079919 Epoch 49, Train Y Loss = 16.77594,  Train X Loss = 2.39982, Val Loss = 18.33035
2025-01-17 04:28:33.035637 Epoch 50, Train Y Loss = 16.77070,  Train X Loss = 2.40086, Val Loss = 18.31309
2025-01-17 04:37:23.931583 Epoch 51, Train Y Loss = 16.76551,  Train X Loss = 2.40205, Val Loss = 18.31287
2025-01-17 04:46:14.855371 Epoch 52, Train Y Loss = 16.76011,  Train X Loss = 2.40232, Val Loss = 18.29527
2025-01-17 04:55:05.651542 Epoch 53, Train Y Loss = 16.75596,  Train X Loss = 2.40497, Val Loss = 18.31124
2025-01-17 05:03:56.792207 Epoch 54, Train Y Loss = 16.74995,  Train X Loss = 2.40462, Val Loss = 18.33647
2025-01-17 05:12:47.959856 Epoch 55, Train Y Loss = 16.74746,  Train X Loss = 2.40630, Val Loss = 18.31659
2025-01-17 05:21:38.713129 Epoch 56, Train Y Loss = 16.73283,  Train X Loss = 2.40803, Val Loss = 18.30799
2025-01-17 05:30:29.767596 Epoch 57, Train Y Loss = 16.73064,  Train X Loss = 2.40614, Val Loss = 18.30297
2025-01-17 05:36:42.195603 Epoch 58, Train Y Loss = 16.73117,  Train X Loss = 2.40698, Val Loss = 18.30660
Change mask ratio: 0.0
2025-01-17 05:40:19.985587 Epoch 59, Train Y Loss = 16.80632,  Train X Loss = 0.00000, Val Loss = 18.02357
2025-01-17 05:43:58.118009 Epoch 60, Train Y Loss = 16.74334,  Train X Loss = 0.00000, Val Loss = 18.00014
2025-01-17 05:47:35.840754 Epoch 61, Train Y Loss = 16.72271,  Train X Loss = 0.00000, Val Loss = 17.99053
2025-01-17 05:51:13.208079 Epoch 62, Train Y Loss = 16.71136,  Train X Loss = 0.00000, Val Loss = 17.97070
2025-01-17 05:54:50.602513 Epoch 63, Train Y Loss = 16.70277,  Train X Loss = 0.00000, Val Loss = 17.97997
2025-01-17 05:58:28.107039 Epoch 64, Train Y Loss = 16.69855,  Train X Loss = 0.00000, Val Loss = 17.97302
2025-01-17 06:02:05.154181 Epoch 65, Train Y Loss = 16.69269,  Train X Loss = 0.00000, Val Loss = 17.96646
2025-01-17 06:05:42.093535 Epoch 66, Train Y Loss = 16.69186,  Train X Loss = 0.00000, Val Loss = 17.96597
2025-01-17 06:09:18.839613 Epoch 67, Train Y Loss = 16.68601,  Train X Loss = 0.00000, Val Loss = 17.96808
2025-01-17 06:12:55.766233 Epoch 68, Train Y Loss = 16.68597,  Train X Loss = 0.00000, Val Loss = 17.96390
2025-01-17 06:16:33.038751 Epoch 69, Train Y Loss = 16.67996,  Train X Loss = 0.00000, Val Loss = 17.96806
2025-01-17 06:20:10.412100 Epoch 70, Train Y Loss = 16.67985,  Train X Loss = 0.00000, Val Loss = 17.96741
2025-01-17 06:23:48.140750 Epoch 71, Train Y Loss = 16.67705,  Train X Loss = 0.00000, Val Loss = 17.96013
2025-01-17 06:27:25.703912 Epoch 72, Train Y Loss = 16.67463,  Train X Loss = 0.00000, Val Loss = 17.96597
2025-01-17 06:31:03.089701 Epoch 73, Train Y Loss = 16.67300,  Train X Loss = 0.00000, Val Loss = 17.95745
2025-01-17 06:34:40.050235 Epoch 74, Train Y Loss = 16.67247,  Train X Loss = 0.00000, Val Loss = 17.95516
2025-01-17 06:38:17.620144 Epoch 75, Train Y Loss = 16.67003,  Train X Loss = 0.00000, Val Loss = 17.95352
2025-01-17 06:41:55.245662 Epoch 76, Train Y Loss = 16.67000,  Train X Loss = 0.00000, Val Loss = 17.95675
2025-01-17 06:45:32.580539 Epoch 77, Train Y Loss = 16.66791,  Train X Loss = 0.00000, Val Loss = 17.95336
2025-01-17 06:49:10.140609 Epoch 78, Train Y Loss = 16.66749,  Train X Loss = 0.00000, Val Loss = 17.95506
2025-01-17 06:52:47.291058 Epoch 79, Train Y Loss = 16.66572,  Train X Loss = 0.00000, Val Loss = 17.95930
2025-01-17 06:56:24.436364 Epoch 80, Train Y Loss = 16.66317,  Train X Loss = 0.00000, Val Loss = 17.95611
2025-01-17 07:00:01.983895 Epoch 81, Train Y Loss = 16.66278,  Train X Loss = 0.00000, Val Loss = 17.95798
2025-01-17 07:03:39.795832 Epoch 82, Train Y Loss = 16.65934,  Train X Loss = 0.00000, Val Loss = 17.95347
2025-01-17 07:07:17.442040 Epoch 83, Train Y Loss = 16.66029,  Train X Loss = 0.00000, Val Loss = 17.95110
2025-01-17 07:10:55.028918 Epoch 84, Train Y Loss = 16.65876,  Train X Loss = 0.00000, Val Loss = 17.95164
2025-01-17 07:14:33.140789 Epoch 85, Train Y Loss = 16.65682,  Train X Loss = 0.00000, Val Loss = 17.96428
2025-01-17 07:18:11.188469 Epoch 86, Train Y Loss = 16.65535,  Train X Loss = 0.00000, Val Loss = 17.95492
2025-01-17 07:21:48.596706 Epoch 87, Train Y Loss = 16.65422,  Train X Loss = 0.00000, Val Loss = 17.95256
2025-01-17 07:25:26.001798 Epoch 88, Train Y Loss = 16.65380,  Train X Loss = 0.00000, Val Loss = 17.95262
2025-01-17 07:29:03.669001 Epoch 89, Train Y Loss = 16.65453,  Train X Loss = 0.00000, Val Loss = 17.95720
Change mask ratio: 0.0
2025-01-17 07:32:41.533785 Epoch 90, Train Y Loss = 16.65175,  Train X Loss = 0.00000, Val Loss = 17.94927
2025-01-17 07:36:19.241592 Epoch 91, Train Y Loss = 16.65176,  Train X Loss = 0.00000, Val Loss = 17.95602
2025-01-17 07:39:56.942526 Epoch 92, Train Y Loss = 16.64910,  Train X Loss = 0.00000, Val Loss = 17.94960
2025-01-17 07:43:34.721663 Epoch 93, Train Y Loss = 16.64815,  Train X Loss = 0.00000, Val Loss = 17.95325
2025-01-17 07:47:12.679883 Epoch 94, Train Y Loss = 16.64786,  Train X Loss = 0.00000, Val Loss = 17.94710
2025-01-17 07:50:50.442623 Epoch 95, Train Y Loss = 16.64478,  Train X Loss = 0.00000, Val Loss = 17.95053
2025-01-17 07:54:27.617509 Epoch 96, Train Y Loss = 16.64599,  Train X Loss = 0.00000, Val Loss = 17.95169
2025-01-17 07:58:04.224910 Epoch 97, Train Y Loss = 16.64510,  Train X Loss = 0.00000, Val Loss = 17.95247
2025-01-17 08:01:41.210231 Epoch 98, Train Y Loss = 16.64407,  Train X Loss = 0.00000, Val Loss = 17.95140
2025-01-17 08:05:17.688421 Epoch 99, Train Y Loss = 16.64281,  Train X Loss = 0.00000, Val Loss = 17.95676
2025-01-17 08:08:54.353281 Epoch 100, Train Y Loss = 16.64281,  Train X Loss = 0.00000, Val Loss = 17.95586
Change mask ratio: 0.0
2025-01-17 08:12:30.814803 Epoch 101, Train Y Loss = 16.64114,  Train X Loss = 0.00000, Val Loss = 17.95086
2025-01-17 08:16:07.323703 Epoch 102, Train Y Loss = 16.64185,  Train X Loss = 0.00000, Val Loss = 17.95056
2025-01-17 08:19:44.341446 Epoch 103, Train Y Loss = 16.63955,  Train X Loss = 0.00000, Val Loss = 17.95346
2025-01-17 08:23:21.790887 Epoch 104, Train Y Loss = 16.63854,  Train X Loss = 0.00000, Val Loss = 17.95407
2025-01-17 08:26:59.470495 Epoch 105, Train Y Loss = 16.63893,  Train X Loss = 0.00000, Val Loss = 17.94490
2025-01-17 08:30:36.934661 Epoch 106, Train Y Loss = 16.63604,  Train X Loss = 0.00000, Val Loss = 17.95535
2025-01-17 08:34:13.950801 Epoch 107, Train Y Loss = 16.63498,  Train X Loss = 0.00000, Val Loss = 17.95851
2025-01-17 08:37:51.466308 Epoch 108, Train Y Loss = 16.63501,  Train X Loss = 0.00000, Val Loss = 17.95160
2025-01-17 08:41:28.891820 Epoch 109, Train Y Loss = 16.63361,  Train X Loss = 0.00000, Val Loss = 17.94781
2025-01-17 08:45:06.301931 Epoch 110, Train Y Loss = 16.63151,  Train X Loss = 0.00000, Val Loss = 17.95568
2025-01-17 08:48:43.959686 Epoch 111, Train Y Loss = 16.63180,  Train X Loss = 0.00000, Val Loss = 17.95562
Change mask ratio: 0.0
2025-01-17 08:52:21.138671 Epoch 112, Train Y Loss = 16.63132,  Train X Loss = 0.00000, Val Loss = 17.94810
2025-01-17 08:55:58.398108 Epoch 113, Train Y Loss = 16.63015,  Train X Loss = 0.00000, Val Loss = 17.95159
2025-01-17 08:59:35.465915 Epoch 114, Train Y Loss = 16.63045,  Train X Loss = 0.00000, Val Loss = 17.95661
2025-01-17 09:03:13.008668 Epoch 115, Train Y Loss = 16.62986,  Train X Loss = 0.00000, Val Loss = 17.95816
2025-01-17 09:06:50.584967 Epoch 116, Train Y Loss = 16.62885,  Train X Loss = 0.00000, Val Loss = 17.95188
2025-01-17 09:10:27.710658 Epoch 117, Train Y Loss = 16.62499,  Train X Loss = 0.00000, Val Loss = 17.96076
Change mask ratio: 0.0
2025-01-17 09:14:04.877291 Epoch 118, Train Y Loss = 16.62594,  Train X Loss = 0.00000, Val Loss = 17.95196
2025-01-17 09:17:41.901876 Epoch 119, Train Y Loss = 16.62595,  Train X Loss = 0.00000, Val Loss = 17.95920
2025-01-17 09:21:18.651882 Epoch 120, Train Y Loss = 16.62505,  Train X Loss = 0.00000, Val Loss = 17.95812
Early stopping at epoch: 120
Best at epoch 105:
Train Loss = 16.63893
Train RMSE = 29.49150, MAE = 16.97153, MAPE = 7.43330
Val Loss = 17.94490
Val RMSE = 31.87400, MAE = 18.46314, MAPE = 8.02412
--------- Test ---------
All Steps RMSE = 32.60991, MAE = 19.05233, MAPE = 7.89637
Step 1 RMSE = 26.08718, MAE = 15.82904, MAPE = 6.62813
Step 2 RMSE = 28.53589, MAE = 16.99212, MAPE = 7.11528
Step 3 RMSE = 29.97282, MAE = 17.68829, MAPE = 7.37342
Step 4 RMSE = 31.06144, MAE = 18.23183, MAPE = 7.57595
Step 5 RMSE = 31.96378, MAE = 18.69160, MAPE = 7.75136
Step 6 RMSE = 32.73341, MAE = 19.10092, MAPE = 7.91317
Step 7 RMSE = 33.43233, MAE = 19.48067, MAPE = 8.05633
Step 8 RMSE = 34.07112, MAE = 19.83882, MAPE = 8.19259
Step 9 RMSE = 34.64644, MAE = 20.16784, MAPE = 8.31905
Step 10 RMSE = 35.18159, MAE = 20.48688, MAPE = 8.44855
Step 11 RMSE = 35.71850, MAE = 20.84246, MAPE = 8.60053
Step 12 RMSE = 36.29150, MAE = 21.27468, MAPE = 8.78102
Inference time: 27.79 s
