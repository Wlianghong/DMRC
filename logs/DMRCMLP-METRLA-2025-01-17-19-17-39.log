METRLA
--------- DMRCMLP ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0003,
    "milestones": [
        25,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 74418540,
    "gpu": [
        0
    ],
    "save": false,
    "model_args": {
        "num_nodes": 207,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        283,260
├─Linear: 1-1                                 [16, 12, 207, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 207, 48]         --
│    └─Embedding: 2-1                         [16, 12, 207, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 207, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 207, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 207, 144]        158,224
├─Predictor: 1-4                              [16, 12, 207, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 207, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 207, 144]        41,760
│    └─Linear: 2-6                            [16, 207, 12]             20,748
===============================================================================================
Total params: 1,027,552
Trainable params: 1,027,552
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.48
Forward/backward pass size (MB): 1813.92
Params size (MB): 2.98
Estimated Total Size (MB): 1817.37
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-METRLA-2025-01-17-19-17-39.pt
2025-01-17 19:19:02.397098 Epoch 1, Train Y Loss = 4.13240,  Train X Loss = 0.00000, Val Loss = 3.30010
2025-01-17 19:20:24.643425 Epoch 2, Train Y Loss = 3.40755,  Train X Loss = 0.00000, Val Loss = 3.17983
2025-01-17 19:21:47.440006 Epoch 3, Train Y Loss = 3.26794,  Train X Loss = 0.00000, Val Loss = 2.99491
2025-01-17 19:23:10.129563 Epoch 4, Train Y Loss = 3.14496,  Train X Loss = 0.00000, Val Loss = 2.99380
2025-01-17 19:24:32.540278 Epoch 5, Train Y Loss = 3.08967,  Train X Loss = 0.00000, Val Loss = 2.99209
2025-01-17 19:25:55.244255 Epoch 6, Train Y Loss = 3.05411,  Train X Loss = 0.00000, Val Loss = 2.89463
2025-01-17 19:27:17.903601 Epoch 7, Train Y Loss = 3.02584,  Train X Loss = 0.00000, Val Loss = 2.90995
2025-01-17 19:28:40.492958 Epoch 8, Train Y Loss = 2.99962,  Train X Loss = 0.00000, Val Loss = 2.88546
2025-01-17 19:30:02.849997 Epoch 9, Train Y Loss = 2.97365,  Train X Loss = 0.00000, Val Loss = 2.86008
2025-01-17 19:31:25.071492 Epoch 10, Train Y Loss = 2.94908,  Train X Loss = 0.00000, Val Loss = 2.86379
2025-01-17 19:32:47.583121 Epoch 11, Train Y Loss = 2.92661,  Train X Loss = 0.00000, Val Loss = 2.81942
2025-01-17 19:34:10.066090 Epoch 12, Train Y Loss = 2.90835,  Train X Loss = 0.00000, Val Loss = 2.79383
2025-01-17 19:35:32.482186 Epoch 13, Train Y Loss = 2.89672,  Train X Loss = 0.00000, Val Loss = 2.78722
2025-01-17 19:36:54.765362 Epoch 14, Train Y Loss = 2.88078,  Train X Loss = 0.00000, Val Loss = 2.78778
2025-01-17 19:38:17.192620 Epoch 15, Train Y Loss = 2.87108,  Train X Loss = 0.00000, Val Loss = 2.78664
2025-01-17 19:39:39.574876 Epoch 16, Train Y Loss = 2.86232,  Train X Loss = 0.00000, Val Loss = 2.80785
2025-01-17 19:41:02.249162 Epoch 17, Train Y Loss = 2.85201,  Train X Loss = 0.00000, Val Loss = 2.74677
2025-01-17 19:42:24.740802 Epoch 18, Train Y Loss = 2.84217,  Train X Loss = 0.00000, Val Loss = 2.76092
2025-01-17 19:43:47.317784 Epoch 19, Train Y Loss = 2.83759,  Train X Loss = 0.00000, Val Loss = 2.77126
2025-01-17 19:45:09.785720 Epoch 20, Train Y Loss = 2.83000,  Train X Loss = 0.00000, Val Loss = 2.76424
2025-01-17 19:46:32.049242 Epoch 21, Train Y Loss = 2.82509,  Train X Loss = 0.00000, Val Loss = 2.77833
2025-01-17 19:47:54.529761 Epoch 22, Train Y Loss = 2.82041,  Train X Loss = 0.00000, Val Loss = 2.79200
2025-01-17 19:49:16.938988 Epoch 23, Train Y Loss = 2.81593,  Train X Loss = 0.00000, Val Loss = 2.79664
2025-01-17 19:50:39.178750 Epoch 24, Train Y Loss = 2.80971,  Train X Loss = 0.00000, Val Loss = 2.78181
2025-01-17 19:52:01.356301 Epoch 25, Train Y Loss = 2.80370,  Train X Loss = 0.00000, Val Loss = 2.77214
Change mask ratio: 0.075
2025-01-17 19:53:22.849169 Epoch 26, Train Y Loss = 2.70436,  Train X Loss = 0.00000, Val Loss = 2.72020
2025-01-17 19:54:44.580614 Epoch 27, Train Y Loss = 2.68749,  Train X Loss = 0.00000, Val Loss = 2.72052
2025-01-17 19:56:05.991950 Epoch 28, Train Y Loss = 2.68050,  Train X Loss = 0.00000, Val Loss = 2.71789
2025-01-17 19:57:27.535055 Epoch 29, Train Y Loss = 2.67325,  Train X Loss = 0.00000, Val Loss = 2.71840
2025-01-17 19:58:49.070325 Epoch 30, Train Y Loss = 2.66885,  Train X Loss = 0.00000, Val Loss = 2.71847
2025-01-17 20:00:10.650595 Epoch 31, Train Y Loss = 2.66470,  Train X Loss = 0.00000, Val Loss = 2.72599
2025-01-17 20:01:32.234381 Epoch 32, Train Y Loss = 2.66058,  Train X Loss = 0.00000, Val Loss = 2.73916
2025-01-17 20:02:54.159539 Epoch 33, Train Y Loss = 2.65712,  Train X Loss = 0.00000, Val Loss = 2.72340
2025-01-17 20:04:15.814907 Epoch 34, Train Y Loss = 2.65353,  Train X Loss = 0.00000, Val Loss = 2.73249
2025-01-17 20:05:37.406822 Epoch 35, Train Y Loss = 2.64908,  Train X Loss = 0.00000, Val Loss = 2.73672
2025-01-17 20:06:59.228984 Epoch 36, Train Y Loss = 2.63649,  Train X Loss = 0.00000, Val Loss = 2.72765
Change mask ratio: 0.0375
2025-01-17 20:08:20.316691 Epoch 37, Train Y Loss = 2.62247,  Train X Loss = 0.00000, Val Loss = 2.72079
2025-01-17 20:09:41.365246 Epoch 38, Train Y Loss = 2.62163,  Train X Loss = 0.00000, Val Loss = 2.72208
2025-01-17 20:11:02.472035 Epoch 39, Train Y Loss = 2.61998,  Train X Loss = 0.00000, Val Loss = 2.72298
2025-01-17 20:12:23.290788 Epoch 40, Train Y Loss = 2.61954,  Train X Loss = 0.00000, Val Loss = 2.72320
2025-01-17 20:13:44.522360 Epoch 41, Train Y Loss = 2.61910,  Train X Loss = 0.00000, Val Loss = 2.72112
2025-01-17 20:15:05.524070 Epoch 42, Train Y Loss = 2.61757,  Train X Loss = 0.00000, Val Loss = 2.72274
2025-01-17 20:16:26.665721 Epoch 43, Train Y Loss = 2.61830,  Train X Loss = 0.00000, Val Loss = 2.72323
2025-01-17 20:17:47.818078 Epoch 44, Train Y Loss = 2.61673,  Train X Loss = 0.00000, Val Loss = 2.72386
Change mask ratio: 0.0
2025-01-17 20:19:04.840125 Epoch 45, Train Y Loss = 2.60313,  Train X Loss = 0.00000, Val Loss = 2.72048
2025-01-17 20:20:21.992045 Epoch 46, Train Y Loss = 2.60214,  Train X Loss = 0.00000, Val Loss = 2.72108
2025-01-17 20:21:39.128403 Epoch 47, Train Y Loss = 2.60141,  Train X Loss = 0.00000, Val Loss = 2.72140
2025-01-17 20:22:56.192363 Epoch 48, Train Y Loss = 2.60072,  Train X Loss = 0.00000, Val Loss = 2.72163
2025-01-17 20:24:13.297654 Epoch 49, Train Y Loss = 2.59964,  Train X Loss = 0.00000, Val Loss = 2.72266
2025-01-17 20:25:30.457628 Epoch 50, Train Y Loss = 2.59921,  Train X Loss = 0.00000, Val Loss = 2.72017
2025-01-17 20:26:47.584209 Epoch 51, Train Y Loss = 2.59866,  Train X Loss = 0.00000, Val Loss = 2.72166
2025-01-17 20:28:04.665581 Epoch 52, Train Y Loss = 2.59797,  Train X Loss = 0.00000, Val Loss = 2.72105
Change mask ratio: 0.0
2025-01-17 20:29:21.693434 Epoch 53, Train Y Loss = 2.59617,  Train X Loss = 0.00000, Val Loss = 2.72346
2025-01-17 20:30:38.643427 Epoch 54, Train Y Loss = 2.59552,  Train X Loss = 0.00000, Val Loss = 2.72269
2025-01-17 20:31:55.487097 Epoch 55, Train Y Loss = 2.59461,  Train X Loss = 0.00000, Val Loss = 2.72069
2025-01-17 20:33:12.372852 Epoch 56, Train Y Loss = 2.59418,  Train X Loss = 0.00000, Val Loss = 2.72336
2025-01-17 20:34:29.266075 Epoch 57, Train Y Loss = 2.59374,  Train X Loss = 0.00000, Val Loss = 2.72450
2025-01-17 20:35:46.184739 Epoch 58, Train Y Loss = 2.59280,  Train X Loss = 0.00000, Val Loss = 2.72246
Early stopping at epoch: 58
Best at epoch 28:
Train Loss = 2.68050
Train RMSE = 5.28036, MAE = 2.63453, MAPE = 6.89151
Val Loss = 2.71789
Val RMSE = 5.76356, MAE = 2.77158, MAPE = 7.59563
--------- Test ---------
All Steps RMSE = 6.06237, MAE = 2.95296, MAPE = 8.05743
Step 1 RMSE = 3.96349, MAE = 2.26769, MAPE = 5.50740
Step 2 RMSE = 4.70464, MAE = 2.51939, MAPE = 6.35241
Step 3 RMSE = 5.18843, MAE = 2.67565, MAPE = 6.92258
Step 4 RMSE = 5.55268, MAE = 2.79752, MAPE = 7.39093
Step 5 RMSE = 5.85565, MAE = 2.89954, MAPE = 7.79230
Step 6 RMSE = 6.11250, MAE = 2.98640, MAPE = 8.13686
Step 7 RMSE = 6.33265, MAE = 3.06157, MAPE = 8.44796
Step 8 RMSE = 6.53927, MAE = 3.13254, MAPE = 8.74518
Step 9 RMSE = 6.70710, MAE = 3.19437, MAPE = 9.00483
Step 10 RMSE = 6.84222, MAE = 3.24951, MAPE = 9.24340
Step 11 RMSE = 6.97990, MAE = 3.30068, MAPE = 9.46509
Step 12 RMSE = 7.09916, MAE = 3.35070, MAPE = 9.68037
Inference time: 7.38 s
