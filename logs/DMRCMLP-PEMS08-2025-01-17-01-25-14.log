PEMS08
--------- DMRCMLP ---------
{
    "num_nodes": 170,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0015,
    "milestones": [
        30,
        50,
        70
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 150,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": false,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 93048409,
    "gpu": [
        2
    ],
    "save": true,
    "model_args": {
        "num_nodes": 170,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        272,172
├─Linear: 1-1                                 [16, 12, 170, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 170, 48]         --
│    └─Embedding: 2-1                         [16, 12, 170, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 170, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 170, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 170, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 170, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 170, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 170, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 170, 144]        158,224
├─Predictor: 1-4                              [16, 12, 170, 1]          --
│    └─Linear: 2-5                            [16, 12, 170, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 170, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 170, 144]        41,760
│    └─Linear: 2-7                            [16, 170, 12]             20,748
===============================================================================================
Total params: 1,037,344
Trainable params: 1,037,344
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 0.39
Forward/backward pass size (MB): 1527.29
Params size (MB): 3.06
Estimated Total Size (MB): 1530.74
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS08-2025-01-17-01-25-14.pt
2025-01-17 01:26:02.860727 Epoch 1, Train Y Loss = 24.02007,  Train X Loss = 18.32436, Val Loss = 18.53716
2025-01-17 01:26:51.450721 Epoch 2, Train Y Loss = 18.33744,  Train X Loss = 14.00810, Val Loss = 17.79602
2025-01-17 01:27:39.897263 Epoch 3, Train Y Loss = 17.38551,  Train X Loss = 13.53949, Val Loss = 17.10266
2025-01-17 01:28:28.378149 Epoch 4, Train Y Loss = 16.78146,  Train X Loss = 13.30671, Val Loss = 16.79555
2025-01-17 01:29:16.545130 Epoch 5, Train Y Loss = 16.30964,  Train X Loss = 12.80760, Val Loss = 16.46313
2025-01-17 01:30:04.986622 Epoch 6, Train Y Loss = 15.93670,  Train X Loss = 12.62876, Val Loss = 15.82310
2025-01-17 01:30:53.465665 Epoch 7, Train Y Loss = 15.59404,  Train X Loss = 12.51082, Val Loss = 15.08642
2025-01-17 01:31:41.820814 Epoch 8, Train Y Loss = 15.27003,  Train X Loss = 12.31663, Val Loss = 14.93115
2025-01-17 01:32:30.307962 Epoch 9, Train Y Loss = 15.10161,  Train X Loss = 12.28415, Val Loss = 15.27712
2025-01-17 01:33:18.656385 Epoch 10, Train Y Loss = 14.92325,  Train X Loss = 12.25201, Val Loss = 14.79686
2025-01-17 01:34:07.107662 Epoch 11, Train Y Loss = 14.81477,  Train X Loss = 12.12069, Val Loss = 14.49045
2025-01-17 01:34:55.258929 Epoch 12, Train Y Loss = 14.63167,  Train X Loss = 12.05782, Val Loss = 14.35071
2025-01-17 01:35:43.724813 Epoch 13, Train Y Loss = 14.49826,  Train X Loss = 12.03892, Val Loss = 14.58715
2025-01-17 01:36:32.189652 Epoch 14, Train Y Loss = 14.41069,  Train X Loss = 11.94201, Val Loss = 14.44438
2025-01-17 01:37:20.462574 Epoch 15, Train Y Loss = 14.17982,  Train X Loss = 11.82319, Val Loss = 14.37622
2025-01-17 01:38:08.963401 Epoch 16, Train Y Loss = 14.17645,  Train X Loss = 11.81860, Val Loss = 14.24855
2025-01-17 01:38:57.352580 Epoch 17, Train Y Loss = 14.00185,  Train X Loss = 11.66808, Val Loss = 14.04033
2025-01-17 01:39:45.783006 Epoch 18, Train Y Loss = 14.00258,  Train X Loss = 11.69473, Val Loss = 13.94321
2025-01-17 01:40:33.855644 Epoch 19, Train Y Loss = 13.87239,  Train X Loss = 11.60044, Val Loss = 13.69656
2025-01-17 01:41:22.299044 Epoch 20, Train Y Loss = 13.77841,  Train X Loss = 11.59605, Val Loss = 13.66624
2025-01-17 01:42:10.793101 Epoch 21, Train Y Loss = 13.71016,  Train X Loss = 11.49319, Val Loss = 13.57623
2025-01-17 01:42:59.275519 Epoch 22, Train Y Loss = 13.70029,  Train X Loss = 11.49272, Val Loss = 13.85751
2025-01-17 01:43:47.744844 Epoch 23, Train Y Loss = 13.63232,  Train X Loss = 11.45618, Val Loss = 13.84935
2025-01-17 01:44:36.075448 Epoch 24, Train Y Loss = 13.62098,  Train X Loss = 11.41709, Val Loss = 13.73126
2025-01-17 01:45:24.581846 Epoch 25, Train Y Loss = 13.53751,  Train X Loss = 11.41393, Val Loss = 13.57616
2025-01-17 01:46:12.751319 Epoch 26, Train Y Loss = 13.50348,  Train X Loss = 11.37308, Val Loss = 13.62087
2025-01-17 01:47:01.154410 Epoch 27, Train Y Loss = 13.45270,  Train X Loss = 11.35818, Val Loss = 13.50213
2025-01-17 01:47:49.419128 Epoch 28, Train Y Loss = 13.41512,  Train X Loss = 11.29947, Val Loss = 13.85715
2025-01-17 01:48:37.806727 Epoch 29, Train Y Loss = 13.41202,  Train X Loss = 11.31671, Val Loss = 13.64788
2025-01-17 01:49:26.212650 Epoch 30, Train Y Loss = 13.35470,  Train X Loss = 11.27552, Val Loss = 13.57554
2025-01-17 01:50:14.505270 Epoch 31, Train Y Loss = 12.80102,  Train X Loss = 11.03442, Val Loss = 12.98270
2025-01-17 01:51:02.929883 Epoch 32, Train Y Loss = 12.71071,  Train X Loss = 10.98185, Val Loss = 12.94536
2025-01-17 01:51:51.089492 Epoch 33, Train Y Loss = 12.68473,  Train X Loss = 10.96808, Val Loss = 12.96645
2025-01-17 01:52:39.490606 Epoch 34, Train Y Loss = 12.66572,  Train X Loss = 10.96890, Val Loss = 12.94447
2025-01-17 01:53:27.771325 Epoch 35, Train Y Loss = 12.64809,  Train X Loss = 10.97074, Val Loss = 12.97662
2025-01-17 01:54:16.228398 Epoch 36, Train Y Loss = 12.63607,  Train X Loss = 10.95294, Val Loss = 12.97160
2025-01-17 01:55:04.633915 Epoch 37, Train Y Loss = 12.62539,  Train X Loss = 10.95273, Val Loss = 12.98839
2025-01-17 01:55:52.934665 Epoch 38, Train Y Loss = 12.61218,  Train X Loss = 10.95517, Val Loss = 12.96563
2025-01-17 01:56:41.333332 Epoch 39, Train Y Loss = 12.60227,  Train X Loss = 10.94065, Val Loss = 12.95114
2025-01-17 01:57:29.452777 Epoch 40, Train Y Loss = 12.58899,  Train X Loss = 10.93023, Val Loss = 12.96355
2025-01-17 01:58:17.874203 Epoch 41, Train Y Loss = 12.58296,  Train X Loss = 10.92716, Val Loss = 13.00940
2025-01-17 01:59:06.118504 Epoch 42, Train Y Loss = 12.57432,  Train X Loss = 10.92688, Val Loss = 12.97652
2025-01-17 01:59:54.564178 Epoch 43, Train Y Loss = 12.56352,  Train X Loss = 10.90483, Val Loss = 13.04116
2025-01-17 02:00:42.898134 Epoch 44, Train Y Loss = 12.56097,  Train X Loss = 10.92909, Val Loss = 12.98525
2025-01-17 02:01:31.381351 Epoch 45, Train Y Loss = 12.55408,  Train X Loss = 10.91658, Val Loss = 12.96374
2025-01-17 02:02:19.676689 Epoch 46, Train Y Loss = 12.54038,  Train X Loss = 10.89577, Val Loss = 12.99103
2025-01-17 02:03:07.781865 Epoch 47, Train Y Loss = 12.53623,  Train X Loss = 10.90241, Val Loss = 12.97397
2025-01-17 02:03:56.191122 Epoch 48, Train Y Loss = 12.53200,  Train X Loss = 10.91460, Val Loss = 13.05504
2025-01-17 02:04:44.467763 Epoch 49, Train Y Loss = 12.52603,  Train X Loss = 10.88633, Val Loss = 12.96640
2025-01-17 02:05:32.998068 Epoch 50, Train Y Loss = 12.51669,  Train X Loss = 10.88610, Val Loss = 12.93645
2025-01-17 02:06:21.263403 Epoch 51, Train Y Loss = 12.45045,  Train X Loss = 10.86229, Val Loss = 12.93223
2025-01-17 02:07:09.679352 Epoch 52, Train Y Loss = 12.44203,  Train X Loss = 10.86467, Val Loss = 12.94874
2025-01-17 02:07:57.882150 Epoch 53, Train Y Loss = 12.43956,  Train X Loss = 10.86233, Val Loss = 12.92823
2025-01-17 02:08:46.203025 Epoch 54, Train Y Loss = 12.43693,  Train X Loss = 10.87031, Val Loss = 12.92949
2025-01-17 02:09:34.577460 Epoch 55, Train Y Loss = 12.43605,  Train X Loss = 10.87015, Val Loss = 12.93817
2025-01-17 02:10:22.873322 Epoch 56, Train Y Loss = 12.43402,  Train X Loss = 10.85461, Val Loss = 12.93895
2025-01-17 02:11:11.288819 Epoch 57, Train Y Loss = 12.43099,  Train X Loss = 10.84988, Val Loss = 12.94326
2025-01-17 02:11:59.490935 Epoch 58, Train Y Loss = 12.43449,  Train X Loss = 10.87120, Val Loss = 12.93518
2025-01-17 02:12:47.952168 Epoch 59, Train Y Loss = 12.42944,  Train X Loss = 10.85058, Val Loss = 12.93890
2025-01-17 02:13:35.929372 Epoch 60, Train Y Loss = 12.42844,  Train X Loss = 10.86318, Val Loss = 12.93130
2025-01-17 02:14:23.667170 Epoch 61, Train Y Loss = 12.42775,  Train X Loss = 10.85378, Val Loss = 12.93575
2025-01-17 02:15:12.009570 Epoch 62, Train Y Loss = 12.42523,  Train X Loss = 10.84447, Val Loss = 12.94152
2025-01-17 02:16:00.664701 Epoch 63, Train Y Loss = 12.42393,  Train X Loss = 10.87003, Val Loss = 12.93438
2025-01-17 02:16:49.407258 Epoch 64, Train Y Loss = 12.42307,  Train X Loss = 10.86041, Val Loss = 12.95069
2025-01-17 02:17:37.950371 Epoch 65, Train Y Loss = 12.42182,  Train X Loss = 10.85088, Val Loss = 12.92582
2025-01-17 02:18:26.648405 Epoch 66, Train Y Loss = 12.42329,  Train X Loss = 10.86014, Val Loss = 12.93130
2025-01-17 02:19:14.965359 Epoch 67, Train Y Loss = 12.42296,  Train X Loss = 10.84889, Val Loss = 12.93242
2025-01-17 02:20:03.689220 Epoch 68, Train Y Loss = 12.42086,  Train X Loss = 10.86481, Val Loss = 12.94200
2025-01-17 02:20:52.404671 Epoch 69, Train Y Loss = 12.41849,  Train X Loss = 10.84775, Val Loss = 12.94868
2025-01-17 02:21:41.108117 Epoch 70, Train Y Loss = 12.41575,  Train X Loss = 10.84355, Val Loss = 12.94154
2025-01-17 02:22:29.850247 Epoch 71, Train Y Loss = 12.41178,  Train X Loss = 10.86071, Val Loss = 12.94118
2025-01-17 02:23:18.552585 Epoch 72, Train Y Loss = 12.40973,  Train X Loss = 10.85964, Val Loss = 12.94088
2025-01-17 02:24:07.168663 Epoch 73, Train Y Loss = 12.40883,  Train X Loss = 10.83154, Val Loss = 12.93798
2025-01-17 02:24:55.207621 Epoch 74, Train Y Loss = 12.40849,  Train X Loss = 10.85533, Val Loss = 12.93823
2025-01-17 02:25:43.953592 Epoch 75, Train Y Loss = 12.40638,  Train X Loss = 10.83877, Val Loss = 12.94024
2025-01-17 02:26:32.540230 Epoch 76, Train Y Loss = 12.40902,  Train X Loss = 10.84116, Val Loss = 12.93879
2025-01-17 02:27:21.322406 Epoch 77, Train Y Loss = 12.40913,  Train X Loss = 10.84922, Val Loss = 12.94201
2025-01-17 02:28:10.115527 Epoch 78, Train Y Loss = 12.40517,  Train X Loss = 10.83194, Val Loss = 12.94181
2025-01-17 02:28:58.646577 Epoch 79, Train Y Loss = 12.40917,  Train X Loss = 10.83633, Val Loss = 12.94143
2025-01-17 02:29:47.365845 Epoch 80, Train Y Loss = 12.40580,  Train X Loss = 10.84693, Val Loss = 12.93949
2025-01-17 02:30:35.920875 Epoch 81, Train Y Loss = 12.40788,  Train X Loss = 10.84239, Val Loss = 12.94106
2025-01-17 02:31:24.402817 Epoch 82, Train Y Loss = 12.40638,  Train X Loss = 10.84920, Val Loss = 12.93991
2025-01-17 02:32:12.806747 Epoch 83, Train Y Loss = 12.40687,  Train X Loss = 10.84542, Val Loss = 12.94028
2025-01-17 02:33:00.917141 Epoch 84, Train Y Loss = 12.40733,  Train X Loss = 10.85773, Val Loss = 12.93969
2025-01-17 02:33:49.194476 Epoch 85, Train Y Loss = 12.40571,  Train X Loss = 10.85467, Val Loss = 12.93920
2025-01-17 02:34:37.535475 Epoch 86, Train Y Loss = 12.40836,  Train X Loss = 10.85528, Val Loss = 12.94319
2025-01-17 02:35:25.619466 Epoch 87, Train Y Loss = 12.40664,  Train X Loss = 10.83777, Val Loss = 12.94284
2025-01-17 02:36:13.939199 Epoch 88, Train Y Loss = 12.40598,  Train X Loss = 10.83595, Val Loss = 12.93969
2025-01-17 02:37:02.329580 Epoch 89, Train Y Loss = 12.40602,  Train X Loss = 10.84780, Val Loss = 12.93532
2025-01-17 02:37:50.468067 Epoch 90, Train Y Loss = 12.40555,  Train X Loss = 10.84809, Val Loss = 12.93966
2025-01-17 02:38:38.851889 Epoch 91, Train Y Loss = 12.40618,  Train X Loss = 10.83512, Val Loss = 12.94244
2025-01-17 02:39:27.155962 Epoch 92, Train Y Loss = 12.40552,  Train X Loss = 10.83920, Val Loss = 12.93935
2025-01-17 02:40:15.274318 Epoch 93, Train Y Loss = 12.40478,  Train X Loss = 10.83297, Val Loss = 12.94079
2025-01-17 02:41:03.697023 Epoch 94, Train Y Loss = 12.40517,  Train X Loss = 10.84698, Val Loss = 12.93990
2025-01-17 02:41:51.969461 Epoch 95, Train Y Loss = 12.40706,  Train X Loss = 10.85861, Val Loss = 12.94222
Early stopping at epoch: 95
Best at epoch 65:
Train Loss = 12.42182
Train RMSE = 22.51815, MAE = 12.68113, MAPE = 8.26764
Val Loss = 12.92582
Val RMSE = 23.64468, MAE = 13.35738, MAPE = 10.45068
--------- Test ---------
All Steps RMSE = 22.65027, MAE = 13.16961, MAPE = 8.65900
Step 1 RMSE = 18.78288, MAE = 11.23472, MAPE = 7.42536
Step 2 RMSE = 20.14665, MAE = 11.90068, MAPE = 7.82134
Step 3 RMSE = 20.99459, MAE = 12.31230, MAPE = 8.08065
Step 4 RMSE = 21.68449, MAE = 12.63548, MAPE = 8.28732
Step 5 RMSE = 22.24725, MAE = 12.90908, MAPE = 8.46613
Step 6 RMSE = 22.74186, MAE = 13.15671, MAPE = 8.64025
Step 7 RMSE = 23.17075, MAE = 13.38198, MAPE = 8.79281
Step 8 RMSE = 23.54623, MAE = 13.58239, MAPE = 8.93130
Step 9 RMSE = 23.88022, MAE = 13.77711, MAPE = 9.07224
Step 10 RMSE = 24.19346, MAE = 13.95804, MAPE = 9.21526
Step 11 RMSE = 24.51249, MAE = 14.20271, MAPE = 9.37676
Step 12 RMSE = 25.03712, MAE = 14.98419, MAPE = 9.79853
Inference time: 3.44 s
