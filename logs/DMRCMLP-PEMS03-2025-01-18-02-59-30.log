PEMS03
--------- DMRCMLP ---------
{
    "num_nodes": 358,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0005,
    "milestones": [
        20,
        35,
        50
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 120,
    "early_stop": 20,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 74418540,
    "gpu": [
        3
    ],
    "save": false,
    "model_args": {
        "num_nodes": 358,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        434,604
├─Linear: 1-1                                 [16, 12, 358, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 358, 48]         --
│    └─Embedding: 2-1                         [16, 12, 358, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 358, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 358, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 358, 144]        158,224
├─Predictor: 1-4                              [16, 12, 358, 1]          --
│    └─Linear: 2-5                            [16, 12, 358, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 358, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 358, 144]        41,760
│    └─Linear: 2-7                            [16, 358, 12]             20,748
===============================================================================================
Total params: 1,199,776
Trainable params: 1,199,776
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 0.82
Forward/backward pass size (MB): 3216.29
Params size (MB): 3.06
Estimated Total Size (MB): 3220.18
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS03-2025-01-18-02-59-30.pt
2025-01-18 03:01:36.981783 Epoch 1, Train Y Loss = 21.80759,  Train X Loss = 0.00000, Val Loss = 17.71655
2025-01-18 03:03:42.795128 Epoch 2, Train Y Loss = 16.58727,  Train X Loss = 0.00000, Val Loss = 16.85226
2025-01-18 03:05:48.589897 Epoch 3, Train Y Loss = 15.63084,  Train X Loss = 0.00000, Val Loss = 15.11380
2025-01-18 03:07:54.256429 Epoch 4, Train Y Loss = 15.04018,  Train X Loss = 0.00000, Val Loss = 15.48651
2025-01-18 03:09:59.624954 Epoch 5, Train Y Loss = 14.57178,  Train X Loss = 0.00000, Val Loss = 14.53401
2025-01-18 03:12:05.970809 Epoch 6, Train Y Loss = 14.27364,  Train X Loss = 0.00000, Val Loss = 14.15876
2025-01-18 03:14:11.751483 Epoch 7, Train Y Loss = 13.99202,  Train X Loss = 0.00000, Val Loss = 14.21221
2025-01-18 03:16:18.445342 Epoch 8, Train Y Loss = 13.76875,  Train X Loss = 0.00000, Val Loss = 14.04867
2025-01-18 03:18:24.148989 Epoch 9, Train Y Loss = 13.57085,  Train X Loss = 0.00000, Val Loss = 13.89334
2025-01-18 03:20:30.242173 Epoch 10, Train Y Loss = 13.41896,  Train X Loss = 0.00000, Val Loss = 13.80660
2025-01-18 03:22:36.029121 Epoch 11, Train Y Loss = 13.27419,  Train X Loss = 0.00000, Val Loss = 13.51441
2025-01-18 03:24:42.489136 Epoch 12, Train Y Loss = 13.18545,  Train X Loss = 0.00000, Val Loss = 13.63927
2025-01-18 03:26:48.368275 Epoch 13, Train Y Loss = 13.08716,  Train X Loss = 0.00000, Val Loss = 13.43374
2025-01-18 03:28:54.055554 Epoch 14, Train Y Loss = 12.96614,  Train X Loss = 0.00000, Val Loss = 13.56377
2025-01-18 03:31:00.145436 Epoch 15, Train Y Loss = 12.91951,  Train X Loss = 0.00000, Val Loss = 13.56141
2025-01-18 03:33:06.759924 Epoch 16, Train Y Loss = 12.85305,  Train X Loss = 0.00000, Val Loss = 13.38437
2025-01-18 03:35:13.248408 Epoch 17, Train Y Loss = 12.72859,  Train X Loss = 0.00000, Val Loss = 13.26382
2025-01-18 03:37:18.926225 Epoch 18, Train Y Loss = 12.72043,  Train X Loss = 0.00000, Val Loss = 13.45455
2025-01-18 03:39:25.350551 Epoch 19, Train Y Loss = 12.64830,  Train X Loss = 0.00000, Val Loss = 13.47079
2025-01-18 03:41:30.525695 Epoch 20, Train Y Loss = 12.60581,  Train X Loss = 0.00000, Val Loss = 13.47235
2025-01-18 03:43:37.408567 Epoch 21, Train Y Loss = 12.12747,  Train X Loss = 0.00000, Val Loss = 12.98919
2025-01-18 03:45:44.589545 Epoch 22, Train Y Loss = 12.05713,  Train X Loss = 0.00000, Val Loss = 13.03733
2025-01-18 03:47:49.812939 Epoch 23, Train Y Loss = 12.03092,  Train X Loss = 0.00000, Val Loss = 13.01325
2025-01-18 03:49:55.645695 Epoch 24, Train Y Loss = 12.01017,  Train X Loss = 0.00000, Val Loss = 13.00790
2025-01-18 03:52:02.063460 Epoch 25, Train Y Loss = 11.99480,  Train X Loss = 0.00000, Val Loss = 12.99207
2025-01-18 03:54:09.121538 Epoch 26, Train Y Loss = 11.97807,  Train X Loss = 0.00000, Val Loss = 12.97986
2025-01-18 03:56:15.992965 Epoch 27, Train Y Loss = 11.95972,  Train X Loss = 0.00000, Val Loss = 13.06212
2025-01-18 03:58:22.589699 Epoch 28, Train Y Loss = 11.94965,  Train X Loss = 0.00000, Val Loss = 13.00473
2025-01-18 04:00:27.624209 Epoch 29, Train Y Loss = 11.93353,  Train X Loss = 0.00000, Val Loss = 13.02577
2025-01-18 04:02:33.391354 Epoch 30, Train Y Loss = 11.92154,  Train X Loss = 0.00000, Val Loss = 13.01684
2025-01-18 04:04:39.132323 Epoch 31, Train Y Loss = 11.90973,  Train X Loss = 0.00000, Val Loss = 13.02612
2025-01-18 04:06:45.569760 Epoch 32, Train Y Loss = 11.89696,  Train X Loss = 0.00000, Val Loss = 13.05011
2025-01-18 04:08:51.807645 Epoch 33, Train Y Loss = 11.88695,  Train X Loss = 0.00000, Val Loss = 13.03668
2025-01-18 04:10:58.545756 Epoch 34, Train Y Loss = 11.87772,  Train X Loss = 0.00000, Val Loss = 13.03472
Change mask ratio: 0.075
2025-01-18 04:13:01.481775 Epoch 35, Train Y Loss = 11.82621,  Train X Loss = 0.00000, Val Loss = 13.00220
2025-01-18 04:15:05.274547 Epoch 36, Train Y Loss = 11.76382,  Train X Loss = 0.00000, Val Loss = 12.97634
2025-01-18 04:17:09.194371 Epoch 37, Train Y Loss = 11.75522,  Train X Loss = 0.00000, Val Loss = 12.96470
2025-01-18 04:19:13.275185 Epoch 38, Train Y Loss = 11.75276,  Train X Loss = 0.00000, Val Loss = 12.96958
2025-01-18 04:21:17.231821 Epoch 39, Train Y Loss = 11.75130,  Train X Loss = 0.00000, Val Loss = 12.98372
2025-01-18 04:23:20.797225 Epoch 40, Train Y Loss = 11.74800,  Train X Loss = 0.00000, Val Loss = 12.97578
2025-01-18 04:25:24.320825 Epoch 41, Train Y Loss = 11.74641,  Train X Loss = 0.00000, Val Loss = 12.98836
2025-01-18 04:27:28.531684 Epoch 42, Train Y Loss = 11.74428,  Train X Loss = 0.00000, Val Loss = 12.99056
2025-01-18 04:29:32.467635 Epoch 43, Train Y Loss = 11.74215,  Train X Loss = 0.00000, Val Loss = 13.01241
2025-01-18 04:31:36.010003 Epoch 44, Train Y Loss = 11.74076,  Train X Loss = 0.00000, Val Loss = 12.98754
2025-01-18 04:33:40.134478 Epoch 45, Train Y Loss = 11.74031,  Train X Loss = 0.00000, Val Loss = 13.00942
Change mask ratio: 0.0375
2025-01-18 04:35:43.204464 Epoch 46, Train Y Loss = 11.72074,  Train X Loss = 0.00000, Val Loss = 12.95303
2025-01-18 04:37:46.064493 Epoch 47, Train Y Loss = 11.71750,  Train X Loss = 0.00000, Val Loss = 12.95428
2025-01-18 04:39:47.932577 Epoch 48, Train Y Loss = 11.71533,  Train X Loss = 0.00000, Val Loss = 12.95469
2025-01-18 04:41:51.124355 Epoch 49, Train Y Loss = 11.71282,  Train X Loss = 0.00000, Val Loss = 12.95228
2025-01-18 04:43:53.487257 Epoch 50, Train Y Loss = 11.71098,  Train X Loss = 0.00000, Val Loss = 12.95564
2025-01-18 04:45:56.145681 Epoch 51, Train Y Loss = 11.70413,  Train X Loss = 0.00000, Val Loss = 12.95445
2025-01-18 04:47:58.752854 Epoch 52, Train Y Loss = 11.70230,  Train X Loss = 0.00000, Val Loss = 12.96020
2025-01-18 04:50:00.543870 Epoch 53, Train Y Loss = 11.70243,  Train X Loss = 0.00000, Val Loss = 12.95202
2025-01-18 04:52:03.673909 Epoch 54, Train Y Loss = 11.70218,  Train X Loss = 0.00000, Val Loss = 12.96024
2025-01-18 04:54:07.172419 Epoch 55, Train Y Loss = 11.70157,  Train X Loss = 0.00000, Val Loss = 12.95936
2025-01-18 04:56:10.192594 Epoch 56, Train Y Loss = 11.70156,  Train X Loss = 0.00000, Val Loss = 12.95539
2025-01-18 04:58:13.015553 Epoch 57, Train Y Loss = 11.70115,  Train X Loss = 0.00000, Val Loss = 12.95897
2025-01-18 05:00:15.652909 Epoch 58, Train Y Loss = 11.70152,  Train X Loss = 0.00000, Val Loss = 12.96293
2025-01-18 05:02:18.639699 Epoch 59, Train Y Loss = 11.70133,  Train X Loss = 0.00000, Val Loss = 12.96389
2025-01-18 05:04:21.975424 Epoch 60, Train Y Loss = 11.70107,  Train X Loss = 0.00000, Val Loss = 12.95951
2025-01-18 05:06:24.578994 Epoch 61, Train Y Loss = 11.69953,  Train X Loss = 0.00000, Val Loss = 12.96142
Change mask ratio: 0.0
2025-01-18 05:08:12.768060 Epoch 62, Train Y Loss = 11.72114,  Train X Loss = 0.00000, Val Loss = 12.94925
2025-01-18 05:10:00.974067 Epoch 63, Train Y Loss = 11.70687,  Train X Loss = 0.00000, Val Loss = 12.94616
2025-01-18 05:11:48.831808 Epoch 64, Train Y Loss = 11.70187,  Train X Loss = 0.00000, Val Loss = 12.94129
2025-01-18 05:13:36.709025 Epoch 65, Train Y Loss = 11.69829,  Train X Loss = 0.00000, Val Loss = 12.94448
2025-01-18 05:15:24.474197 Epoch 66, Train Y Loss = 11.69621,  Train X Loss = 0.00000, Val Loss = 12.94061
2025-01-18 05:17:12.327525 Epoch 67, Train Y Loss = 11.69541,  Train X Loss = 0.00000, Val Loss = 12.94787
2025-01-18 05:19:00.247658 Epoch 68, Train Y Loss = 11.69346,  Train X Loss = 0.00000, Val Loss = 12.94543
2025-01-18 05:20:48.108100 Epoch 69, Train Y Loss = 11.69201,  Train X Loss = 0.00000, Val Loss = 12.94526
2025-01-18 05:22:36.168936 Epoch 70, Train Y Loss = 11.69155,  Train X Loss = 0.00000, Val Loss = 12.94455
2025-01-18 05:24:24.077670 Epoch 71, Train Y Loss = 11.69029,  Train X Loss = 0.00000, Val Loss = 12.94806
2025-01-18 05:26:12.074451 Epoch 72, Train Y Loss = 11.69018,  Train X Loss = 0.00000, Val Loss = 12.94436
2025-01-18 05:28:00.014083 Epoch 73, Train Y Loss = 11.68823,  Train X Loss = 0.00000, Val Loss = 12.94420
2025-01-18 05:29:47.878184 Epoch 74, Train Y Loss = 11.68900,  Train X Loss = 0.00000, Val Loss = 12.94138
Change mask ratio: 0.0
2025-01-18 05:31:36.030733 Epoch 75, Train Y Loss = 11.68805,  Train X Loss = 0.00000, Val Loss = 12.93810
2025-01-18 05:33:24.278488 Epoch 76, Train Y Loss = 11.68815,  Train X Loss = 0.00000, Val Loss = 12.94515
2025-01-18 05:35:12.374271 Epoch 77, Train Y Loss = 11.68705,  Train X Loss = 0.00000, Val Loss = 12.94474
2025-01-18 05:37:00.345740 Epoch 78, Train Y Loss = 11.68714,  Train X Loss = 0.00000, Val Loss = 12.94203
2025-01-18 05:38:48.198518 Epoch 79, Train Y Loss = 11.68601,  Train X Loss = 0.00000, Val Loss = 12.94492
2025-01-18 05:40:36.209217 Epoch 80, Train Y Loss = 11.68643,  Train X Loss = 0.00000, Val Loss = 12.94288
2025-01-18 05:42:23.940495 Epoch 81, Train Y Loss = 11.68484,  Train X Loss = 0.00000, Val Loss = 12.93988
2025-01-18 05:44:11.798923 Epoch 82, Train Y Loss = 11.68467,  Train X Loss = 0.00000, Val Loss = 12.94445
2025-01-18 05:45:59.733977 Epoch 83, Train Y Loss = 11.68429,  Train X Loss = 0.00000, Val Loss = 12.93695
2025-01-18 05:47:47.586803 Epoch 84, Train Y Loss = 11.68373,  Train X Loss = 0.00000, Val Loss = 12.94188
2025-01-18 05:49:35.547122 Epoch 85, Train Y Loss = 11.68333,  Train X Loss = 0.00000, Val Loss = 12.94218
2025-01-18 05:51:24.011057 Epoch 86, Train Y Loss = 11.68326,  Train X Loss = 0.00000, Val Loss = 12.94377
2025-01-18 05:53:12.405603 Epoch 87, Train Y Loss = 11.68285,  Train X Loss = 0.00000, Val Loss = 12.93810
2025-01-18 05:55:00.581178 Epoch 88, Train Y Loss = 11.68230,  Train X Loss = 0.00000, Val Loss = 12.94668
2025-01-18 05:56:48.584749 Epoch 89, Train Y Loss = 11.68223,  Train X Loss = 0.00000, Val Loss = 12.94173
2025-01-18 05:58:36.170498 Epoch 90, Train Y Loss = 11.68195,  Train X Loss = 0.00000, Val Loss = 12.94493
2025-01-18 06:00:23.975901 Epoch 91, Train Y Loss = 11.68184,  Train X Loss = 0.00000, Val Loss = 12.94382
Change mask ratio: 0.0
2025-01-18 06:02:11.874541 Epoch 92, Train Y Loss = 11.68106,  Train X Loss = 0.00000, Val Loss = 12.94290
2025-01-18 06:03:59.678071 Epoch 93, Train Y Loss = 11.68077,  Train X Loss = 0.00000, Val Loss = 12.94315
2025-01-18 06:05:47.477301 Epoch 94, Train Y Loss = 11.68129,  Train X Loss = 0.00000, Val Loss = 12.94282
2025-01-18 06:07:35.312015 Epoch 95, Train Y Loss = 11.68035,  Train X Loss = 0.00000, Val Loss = 12.94123
2025-01-18 06:09:23.322087 Epoch 96, Train Y Loss = 11.67986,  Train X Loss = 0.00000, Val Loss = 12.94357
2025-01-18 06:11:10.993793 Epoch 97, Train Y Loss = 11.67922,  Train X Loss = 0.00000, Val Loss = 12.94472
2025-01-18 06:12:59.169162 Epoch 98, Train Y Loss = 11.67877,  Train X Loss = 0.00000, Val Loss = 12.94681
2025-01-18 06:14:47.122155 Epoch 99, Train Y Loss = 11.67949,  Train X Loss = 0.00000, Val Loss = 12.94013
Change mask ratio: 0.0
2025-01-18 06:16:35.137624 Epoch 100, Train Y Loss = 11.67838,  Train X Loss = 0.00000, Val Loss = 12.94396
2025-01-18 06:18:23.075069 Epoch 101, Train Y Loss = 11.67872,  Train X Loss = 0.00000, Val Loss = 12.94345
2025-01-18 06:20:10.847860 Epoch 102, Train Y Loss = 11.67777,  Train X Loss = 0.00000, Val Loss = 12.93704
2025-01-18 06:21:58.809834 Epoch 103, Train Y Loss = 11.67719,  Train X Loss = 0.00000, Val Loss = 12.94512
Early stopping at epoch: 103
Best at epoch 83:
Train Loss = 11.68429
Train RMSE = 20.05766, MAE = 12.07522, MAPE = 11.17007
Val Loss = 12.93695
Val RMSE = 21.88823, MAE = 13.45956, MAPE = 12.76947
--------- Test ---------
All Steps RMSE = 26.26814, MAE = 15.28263, MAPE = 15.50132
Step 1 RMSE = 20.09450, MAE = 12.62552, MAPE = 13.24425
Step 2 RMSE = 22.18235, MAE = 13.41308, MAPE = 14.00844
Step 3 RMSE = 23.78636, MAE = 14.04998, MAPE = 14.52855
Step 4 RMSE = 24.98876, MAE = 14.56306, MAPE = 14.89304
Step 5 RMSE = 25.85443, MAE = 14.97830, MAPE = 15.22306
Step 6 RMSE = 26.53579, MAE = 15.33478, MAPE = 15.50805
Step 7 RMSE = 27.13467, MAE = 15.67336, MAPE = 15.79045
Step 8 RMSE = 27.65541, MAE = 15.98107, MAPE = 16.05719
Step 9 RMSE = 28.12409, MAE = 16.27136, MAPE = 16.30982
Step 10 RMSE = 28.58253, MAE = 16.55327, MAPE = 16.55707
Step 11 RMSE = 29.03099, MAE = 16.83109, MAPE = 16.81374
Step 12 RMSE = 29.49023, MAE = 17.11667, MAPE = 17.08199
Inference time: 11.11 s
