PEMSBAY
--------- DMRCMLP ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        15,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "adaptive_mask": false,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 34110658,
    "gpu": [
        6
    ],
    "save": false,
    "model_args": {
        "num_nodes": 325,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        385,212
├─Linear: 1-1                                 [16, 12, 325, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 325, 48]         --
│    └─Embedding: 2-1                         [16, 12, 325, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 325, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 325, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 325, 144]        158,224
├─Predictor: 1-4                              [16, 12, 325, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 325, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 325, 144]        41,760
│    └─Linear: 2-6                            [16, 325, 12]             20,748
===============================================================================================
Total params: 1,129,504
Trainable params: 1,129,504
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.75
Forward/backward pass size (MB): 2847.94
Params size (MB): 2.98
Estimated Total Size (MB): 2851.66
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMSBAY-2025-01-20-00-25-25.pt
2025-01-20 00:29:03.709597 Epoch 1, Train Y Loss = 2.04875,  Train X Loss = 1.00371, Val Loss = 1.99704
2025-01-20 00:32:41.245106 Epoch 2, Train Y Loss = 1.71859,  Train X Loss = 0.81201, Val Loss = 1.77117
2025-01-20 00:36:18.254070 Epoch 3, Train Y Loss = 1.63031,  Train X Loss = 0.78081, Val Loss = 1.78197
2025-01-20 00:39:55.582165 Epoch 4, Train Y Loss = 1.58198,  Train X Loss = 0.76684, Val Loss = 1.70899
2025-01-20 00:43:32.798471 Epoch 5, Train Y Loss = 1.55447,  Train X Loss = 0.72303, Val Loss = 1.74681
2025-01-20 00:47:11.277080 Epoch 6, Train Y Loss = 1.53241,  Train X Loss = 0.67841, Val Loss = 1.65768
2025-01-20 00:50:47.564615 Epoch 7, Train Y Loss = 1.51002,  Train X Loss = 0.66345, Val Loss = 1.62251
2025-01-20 00:54:23.883111 Epoch 8, Train Y Loss = 1.49612,  Train X Loss = 0.65431, Val Loss = 1.61405
2025-01-20 00:58:00.625913 Epoch 9, Train Y Loss = 1.48482,  Train X Loss = 0.65011, Val Loss = 1.60798
2025-01-20 01:01:37.503724 Epoch 10, Train Y Loss = 1.47695,  Train X Loss = 0.64767, Val Loss = 1.59855
2025-01-20 01:05:13.838742 Epoch 11, Train Y Loss = 1.46836,  Train X Loss = 0.64466, Val Loss = 1.59708
2025-01-20 01:08:50.172458 Epoch 12, Train Y Loss = 1.46074,  Train X Loss = 0.64167, Val Loss = 1.61793
2025-01-20 01:12:26.788607 Epoch 13, Train Y Loss = 1.45488,  Train X Loss = 0.63989, Val Loss = 1.60842
2025-01-20 01:16:04.345377 Epoch 14, Train Y Loss = 1.44967,  Train X Loss = 0.63755, Val Loss = 1.57642
2025-01-20 01:19:42.816581 Epoch 15, Train Y Loss = 1.44595,  Train X Loss = 0.63590, Val Loss = 1.58013
2025-01-20 01:23:19.957787 Epoch 16, Train Y Loss = 1.39634,  Train X Loss = 0.61824, Val Loss = 1.52723
2025-01-20 01:26:56.057965 Epoch 17, Train Y Loss = 1.38620,  Train X Loss = 0.61605, Val Loss = 1.52445
2025-01-20 01:30:31.757286 Epoch 18, Train Y Loss = 1.38162,  Train X Loss = 0.61432, Val Loss = 1.52711
2025-01-20 01:34:07.687750 Epoch 19, Train Y Loss = 1.37844,  Train X Loss = 0.61334, Val Loss = 1.52512
2025-01-20 01:37:43.887770 Epoch 20, Train Y Loss = 1.37583,  Train X Loss = 0.61356, Val Loss = 1.52471
2025-01-20 01:41:20.112045 Epoch 21, Train Y Loss = 1.37333,  Train X Loss = 0.61253, Val Loss = 1.52349
2025-01-20 01:44:56.201743 Epoch 22, Train Y Loss = 1.37241,  Train X Loss = 0.61245, Val Loss = 1.52775
2025-01-20 01:48:31.971210 Epoch 23, Train Y Loss = 1.36940,  Train X Loss = 0.61143, Val Loss = 1.52584
2025-01-20 01:52:07.652570 Epoch 24, Train Y Loss = 1.36839,  Train X Loss = 0.61176, Val Loss = 1.52510
2025-01-20 01:55:43.080381 Epoch 25, Train Y Loss = 1.36622,  Train X Loss = 0.61110, Val Loss = 1.51946
2025-01-20 01:59:18.909800 Epoch 26, Train Y Loss = 1.36425,  Train X Loss = 0.61085, Val Loss = 1.51828
2025-01-20 02:02:54.509738 Epoch 27, Train Y Loss = 1.36260,  Train X Loss = 0.61070, Val Loss = 1.51358
2025-01-20 02:06:30.304009 Epoch 28, Train Y Loss = 1.36081,  Train X Loss = 0.61052, Val Loss = 1.51910
2025-01-20 02:10:06.253517 Epoch 29, Train Y Loss = 1.35950,  Train X Loss = 0.60970, Val Loss = 1.51991
2025-01-20 02:13:42.556334 Epoch 30, Train Y Loss = 1.35888,  Train X Loss = 0.60953, Val Loss = 1.51887
2025-01-20 02:17:18.580769 Epoch 31, Train Y Loss = 1.35671,  Train X Loss = 0.60929, Val Loss = 1.51852
2025-01-20 02:20:54.922134 Epoch 32, Train Y Loss = 1.35486,  Train X Loss = 0.60894, Val Loss = 1.51667
2025-01-20 02:24:31.448667 Epoch 33, Train Y Loss = 1.35394,  Train X Loss = 0.60846, Val Loss = 1.51507
2025-01-20 02:28:07.918460 Epoch 34, Train Y Loss = 1.35212,  Train X Loss = 0.60848, Val Loss = 1.51416
2025-01-20 02:31:44.224830 Epoch 35, Train Y Loss = 1.35066,  Train X Loss = 0.60794, Val Loss = 1.51796
2025-01-20 02:35:20.447455 Epoch 36, Train Y Loss = 1.34191,  Train X Loss = 0.60649, Val Loss = 1.50986
2025-01-20 02:38:56.486072 Epoch 37, Train Y Loss = 1.34193,  Train X Loss = 0.60600, Val Loss = 1.51094
2025-01-20 02:42:32.703136 Epoch 38, Train Y Loss = 1.34034,  Train X Loss = 0.60616, Val Loss = 1.51008
2025-01-20 02:46:09.082035 Epoch 39, Train Y Loss = 1.34047,  Train X Loss = 0.60632, Val Loss = 1.50918
2025-01-20 02:49:45.037932 Epoch 40, Train Y Loss = 1.34024,  Train X Loss = 0.60618, Val Loss = 1.50848
2025-01-20 02:53:20.955958 Epoch 41, Train Y Loss = 1.33863,  Train X Loss = 0.60587, Val Loss = 1.50948
2025-01-20 02:56:56.806731 Epoch 42, Train Y Loss = 1.33991,  Train X Loss = 0.60574, Val Loss = 1.50974
2025-01-20 03:00:32.647475 Epoch 43, Train Y Loss = 1.33837,  Train X Loss = 0.60561, Val Loss = 1.51155
2025-01-20 03:04:08.503990 Epoch 44, Train Y Loss = 1.33823,  Train X Loss = 0.60534, Val Loss = 1.51065
2025-01-20 03:07:44.959605 Epoch 45, Train Y Loss = 1.33813,  Train X Loss = 0.60545, Val Loss = 1.50983
2025-01-20 03:11:21.295144 Epoch 46, Train Y Loss = 1.33792,  Train X Loss = 0.60547, Val Loss = 1.50765
2025-01-20 03:14:57.352181 Epoch 47, Train Y Loss = 1.33748,  Train X Loss = 0.60542, Val Loss = 1.50854
2025-01-20 03:18:33.711473 Epoch 48, Train Y Loss = 1.33735,  Train X Loss = 0.60557, Val Loss = 1.50978
2025-01-20 03:22:10.327285 Epoch 49, Train Y Loss = 1.33727,  Train X Loss = 0.60536, Val Loss = 1.50780
2025-01-20 03:25:46.950273 Epoch 50, Train Y Loss = 1.33714,  Train X Loss = 0.60536, Val Loss = 1.50934
2025-01-20 03:29:22.699016 Epoch 51, Train Y Loss = 1.33653,  Train X Loss = 0.60570, Val Loss = 1.50939
2025-01-20 03:32:58.545907 Epoch 52, Train Y Loss = 1.33642,  Train X Loss = 0.60544, Val Loss = 1.50870
2025-01-20 03:36:34.361996 Epoch 53, Train Y Loss = 1.33669,  Train X Loss = 0.60510, Val Loss = 1.50843
2025-01-20 03:40:10.127144 Epoch 54, Train Y Loss = 1.33618,  Train X Loss = 0.60542, Val Loss = 1.50787
2025-01-20 03:43:46.180699 Epoch 55, Train Y Loss = 1.33581,  Train X Loss = 0.60474, Val Loss = 1.50918
2025-01-20 03:47:22.404906 Epoch 56, Train Y Loss = 1.33554,  Train X Loss = 0.60489, Val Loss = 1.50822
2025-01-20 03:50:58.760208 Epoch 57, Train Y Loss = 1.33571,  Train X Loss = 0.60567, Val Loss = 1.50880
2025-01-20 03:54:34.681781 Epoch 58, Train Y Loss = 1.33577,  Train X Loss = 0.60514, Val Loss = 1.50828
2025-01-20 03:58:10.883790 Epoch 59, Train Y Loss = 1.33500,  Train X Loss = 0.60493, Val Loss = 1.50626
2025-01-20 04:01:47.166966 Epoch 60, Train Y Loss = 1.33457,  Train X Loss = 0.60484, Val Loss = 1.50767
2025-01-20 04:05:23.533383 Epoch 61, Train Y Loss = 1.33455,  Train X Loss = 0.60516, Val Loss = 1.50837
2025-01-20 04:08:59.654135 Epoch 62, Train Y Loss = 1.33474,  Train X Loss = 0.60484, Val Loss = 1.50923
2025-01-20 04:12:36.294811 Epoch 63, Train Y Loss = 1.33444,  Train X Loss = 0.60482, Val Loss = 1.50701
2025-01-20 04:16:12.663353 Epoch 64, Train Y Loss = 1.33396,  Train X Loss = 0.60484, Val Loss = 1.50898
2025-01-20 04:19:49.204053 Epoch 65, Train Y Loss = 1.33325,  Train X Loss = 0.60459, Val Loss = 1.50888
2025-01-20 04:23:25.602519 Epoch 66, Train Y Loss = 1.33386,  Train X Loss = 0.60453, Val Loss = 1.50788
2025-01-20 04:27:02.100589 Epoch 67, Train Y Loss = 1.33306,  Train X Loss = 0.60459, Val Loss = 1.50828
2025-01-20 04:30:39.047091 Epoch 68, Train Y Loss = 1.33305,  Train X Loss = 0.60459, Val Loss = 1.50866
2025-01-20 04:34:15.675176 Epoch 69, Train Y Loss = 1.33285,  Train X Loss = 0.60446, Val Loss = 1.50779
2025-01-20 04:37:52.055168 Epoch 70, Train Y Loss = 1.33296,  Train X Loss = 0.60434, Val Loss = 1.50772
2025-01-20 04:41:28.054168 Epoch 71, Train Y Loss = 1.33249,  Train X Loss = 0.60403, Val Loss = 1.50824
2025-01-20 04:45:04.179039 Epoch 72, Train Y Loss = 1.33230,  Train X Loss = 0.60405, Val Loss = 1.50711
2025-01-20 04:48:40.413404 Epoch 73, Train Y Loss = 1.33196,  Train X Loss = 0.60429, Val Loss = 1.50871
2025-01-20 04:52:16.055594 Epoch 74, Train Y Loss = 1.33216,  Train X Loss = 0.60459, Val Loss = 1.50839
2025-01-20 04:55:51.914249 Epoch 75, Train Y Loss = 1.33128,  Train X Loss = 0.60455, Val Loss = 1.50764
2025-01-20 04:59:27.729382 Epoch 76, Train Y Loss = 1.33160,  Train X Loss = 0.60423, Val Loss = 1.50892
2025-01-20 05:03:03.680781 Epoch 77, Train Y Loss = 1.33071,  Train X Loss = 0.60405, Val Loss = 1.50913
2025-01-20 05:06:39.490021 Epoch 78, Train Y Loss = 1.33077,  Train X Loss = 0.60438, Val Loss = 1.50641
2025-01-20 05:10:15.233461 Epoch 79, Train Y Loss = 1.33175,  Train X Loss = 0.60425, Val Loss = 1.50828
2025-01-20 05:13:51.518103 Epoch 80, Train Y Loss = 1.33100,  Train X Loss = 0.60401, Val Loss = 1.50668
2025-01-20 05:17:27.693178 Epoch 81, Train Y Loss = 1.33011,  Train X Loss = 0.60425, Val Loss = 1.50711
2025-01-20 05:21:03.825755 Epoch 82, Train Y Loss = 1.33010,  Train X Loss = 0.60398, Val Loss = 1.50750
2025-01-20 05:24:40.287814 Epoch 83, Train Y Loss = 1.33011,  Train X Loss = 0.60409, Val Loss = 1.50653
2025-01-20 05:28:16.755788 Epoch 84, Train Y Loss = 1.32961,  Train X Loss = 0.60366, Val Loss = 1.50844
2025-01-20 05:31:52.925791 Epoch 85, Train Y Loss = 1.33011,  Train X Loss = 0.60424, Val Loss = 1.50739
2025-01-20 05:35:29.328662 Epoch 86, Train Y Loss = 1.32897,  Train X Loss = 0.60406, Val Loss = 1.50719
2025-01-20 05:39:05.542168 Epoch 87, Train Y Loss = 1.32943,  Train X Loss = 0.60371, Val Loss = 1.50795
2025-01-20 05:42:42.123663 Epoch 88, Train Y Loss = 1.32899,  Train X Loss = 0.60389, Val Loss = 1.50760
2025-01-20 05:46:17.852201 Epoch 89, Train Y Loss = 1.32855,  Train X Loss = 0.60357, Val Loss = 1.50680
Early stopping at epoch: 89
Best at epoch 59:
Train Loss = 1.33500
Train RMSE = 2.93749, MAE = 1.30248, MAPE = 2.79901
Val Loss = 1.50626
Val RMSE = 3.48353, MAE = 1.50442, MAPE = 3.42415
--------- Test ---------
All Steps RMSE = 3.48538, MAE = 1.51979, MAPE = 3.40410
Step 1 RMSE = 1.53817, MAE = 0.84067, MAPE = 1.61344
Step 2 RMSE = 2.19548, MAE = 1.10375, MAPE = 2.22807
Step 3 RMSE = 2.69185, MAE = 1.27840, MAPE = 2.68122
Step 4 RMSE = 3.07117, MAE = 1.40625, MAPE = 3.03877
Step 5 RMSE = 3.35965, MAE = 1.50392, MAPE = 3.32464
Step 6 RMSE = 3.58093, MAE = 1.58158, MAPE = 3.55627
Step 7 RMSE = 3.75647, MAE = 1.64472, MAPE = 3.74656
Step 8 RMSE = 3.89619, MAE = 1.69694, MAPE = 3.90438
Step 9 RMSE = 4.00964, MAE = 1.74122, MAPE = 4.03760
Step 10 RMSE = 4.10277, MAE = 1.77880, MAPE = 4.14597
Step 11 RMSE = 4.18329, MAE = 1.81357, MAPE = 4.24265
Step 12 RMSE = 4.25426, MAE = 1.84765, MAPE = 4.32966
Inference time: 17.95 s
