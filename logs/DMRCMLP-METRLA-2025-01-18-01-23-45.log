METRLA
--------- DMRCMLP ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0003,
    "milestones": [
        25,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": false,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 74418540,
    "gpu": [
        0
    ],
    "save": false,
    "model_args": {
        "num_nodes": 207,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.0,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        283,260
├─Linear: 1-1                                 [16, 12, 207, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 207, 48]         --
│    └─Embedding: 2-1                         [16, 12, 207, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 207, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 207, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 207, 144]        158,224
├─Predictor: 1-4                              [16, 12, 207, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 207, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 207, 144]        41,760
│    └─Linear: 2-6                            [16, 207, 12]             20,748
===============================================================================================
Total params: 1,027,552
Trainable params: 1,027,552
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.48
Forward/backward pass size (MB): 1813.92
Params size (MB): 2.98
Estimated Total Size (MB): 1817.37
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-METRLA-2025-01-18-01-23-45.pt
2025-01-18 01:25:02.645836 Epoch 1, Train Y Loss = 4.07017,  Train X Loss = 0.00000, Val Loss = 3.23912
2025-01-18 01:26:19.523969 Epoch 2, Train Y Loss = 3.33701,  Train X Loss = 0.00000, Val Loss = 3.08850
2025-01-18 01:27:36.340734 Epoch 3, Train Y Loss = 3.18695,  Train X Loss = 0.00000, Val Loss = 2.96130
2025-01-18 01:28:53.086441 Epoch 4, Train Y Loss = 3.10638,  Train X Loss = 0.00000, Val Loss = 2.94786
2025-01-18 01:30:09.867306 Epoch 5, Train Y Loss = 3.05995,  Train X Loss = 0.00000, Val Loss = 2.92908
2025-01-18 01:31:26.779469 Epoch 6, Train Y Loss = 3.01778,  Train X Loss = 0.00000, Val Loss = 2.91400
2025-01-18 01:32:43.700888 Epoch 7, Train Y Loss = 2.98856,  Train X Loss = 0.00000, Val Loss = 2.85079
2025-01-18 01:34:00.640551 Epoch 8, Train Y Loss = 2.95632,  Train X Loss = 0.00000, Val Loss = 2.90097
2025-01-18 01:35:17.672182 Epoch 9, Train Y Loss = 2.92499,  Train X Loss = 0.00000, Val Loss = 2.83155
2025-01-18 01:36:34.583634 Epoch 10, Train Y Loss = 2.90094,  Train X Loss = 0.00000, Val Loss = 2.82749
2025-01-18 01:37:51.612920 Epoch 11, Train Y Loss = 2.87816,  Train X Loss = 0.00000, Val Loss = 2.77294
2025-01-18 01:39:08.613986 Epoch 12, Train Y Loss = 2.85629,  Train X Loss = 0.00000, Val Loss = 2.78620
2025-01-18 01:40:25.624238 Epoch 13, Train Y Loss = 2.84176,  Train X Loss = 0.00000, Val Loss = 2.75014
2025-01-18 01:41:42.738509 Epoch 14, Train Y Loss = 2.82789,  Train X Loss = 0.00000, Val Loss = 2.74586
2025-01-18 01:42:59.802545 Epoch 15, Train Y Loss = 2.81417,  Train X Loss = 0.00000, Val Loss = 2.74365
2025-01-18 01:44:16.826485 Epoch 16, Train Y Loss = 2.80407,  Train X Loss = 0.00000, Val Loss = 2.77808
2025-01-18 01:45:33.871761 Epoch 17, Train Y Loss = 2.78961,  Train X Loss = 0.00000, Val Loss = 2.73268
2025-01-18 01:46:50.816951 Epoch 18, Train Y Loss = 2.78063,  Train X Loss = 0.00000, Val Loss = 2.74190
2025-01-18 01:48:07.508017 Epoch 19, Train Y Loss = 2.77350,  Train X Loss = 0.00000, Val Loss = 2.75462
2025-01-18 01:49:24.247310 Epoch 20, Train Y Loss = 2.75986,  Train X Loss = 0.00000, Val Loss = 2.73899
2025-01-18 01:50:40.984022 Epoch 21, Train Y Loss = 2.74778,  Train X Loss = 0.00000, Val Loss = 2.74885
2025-01-18 01:51:57.727931 Epoch 22, Train Y Loss = 2.73577,  Train X Loss = 0.00000, Val Loss = 2.76857
2025-01-18 01:53:14.569323 Epoch 23, Train Y Loss = 2.72050,  Train X Loss = 0.00000, Val Loss = 2.76197
2025-01-18 01:54:31.417136 Epoch 24, Train Y Loss = 2.70837,  Train X Loss = 0.00000, Val Loss = 2.79476
2025-01-18 01:55:48.263479 Epoch 25, Train Y Loss = 2.69691,  Train X Loss = 0.00000, Val Loss = 2.78118
2025-01-18 01:57:05.242796 Epoch 26, Train Y Loss = 2.60107,  Train X Loss = 0.00000, Val Loss = 2.76337
2025-01-18 01:58:22.194197 Epoch 27, Train Y Loss = 2.57863,  Train X Loss = 0.00000, Val Loss = 2.76584
2025-01-18 01:59:39.094447 Epoch 28, Train Y Loss = 2.56823,  Train X Loss = 0.00000, Val Loss = 2.77735
2025-01-18 02:00:56.119702 Epoch 29, Train Y Loss = 2.55921,  Train X Loss = 0.00000, Val Loss = 2.78044
2025-01-18 02:02:13.135544 Epoch 30, Train Y Loss = 2.55242,  Train X Loss = 0.00000, Val Loss = 2.78495
2025-01-18 02:03:30.147443 Epoch 31, Train Y Loss = 2.54651,  Train X Loss = 0.00000, Val Loss = 2.79728
2025-01-18 02:04:47.235354 Epoch 32, Train Y Loss = 2.54140,  Train X Loss = 0.00000, Val Loss = 2.80251
2025-01-18 02:06:04.323732 Epoch 33, Train Y Loss = 2.53658,  Train X Loss = 0.00000, Val Loss = 2.80775
2025-01-18 02:07:21.249362 Epoch 34, Train Y Loss = 2.53039,  Train X Loss = 0.00000, Val Loss = 2.80801
2025-01-18 02:08:38.155545 Epoch 35, Train Y Loss = 2.52602,  Train X Loss = 0.00000, Val Loss = 2.81501
2025-01-18 02:09:54.954542 Epoch 36, Train Y Loss = 2.51186,  Train X Loss = 0.00000, Val Loss = 2.81497
2025-01-18 02:11:11.685596 Epoch 37, Train Y Loss = 2.50924,  Train X Loss = 0.00000, Val Loss = 2.81595
2025-01-18 02:12:28.446850 Epoch 38, Train Y Loss = 2.50811,  Train X Loss = 0.00000, Val Loss = 2.81629
2025-01-18 02:13:45.244642 Epoch 39, Train Y Loss = 2.50666,  Train X Loss = 0.00000, Val Loss = 2.81783
2025-01-18 02:15:02.033523 Epoch 40, Train Y Loss = 2.50697,  Train X Loss = 0.00000, Val Loss = 2.81828
2025-01-18 02:16:18.959010 Epoch 41, Train Y Loss = 2.50615,  Train X Loss = 0.00000, Val Loss = 2.81616
2025-01-18 02:17:35.904686 Epoch 42, Train Y Loss = 2.50501,  Train X Loss = 0.00000, Val Loss = 2.81921
2025-01-18 02:18:52.898714 Epoch 43, Train Y Loss = 2.50488,  Train X Loss = 0.00000, Val Loss = 2.81819
2025-01-18 02:20:09.881696 Epoch 44, Train Y Loss = 2.50366,  Train X Loss = 0.00000, Val Loss = 2.82066
2025-01-18 02:21:26.874595 Epoch 45, Train Y Loss = 2.50276,  Train X Loss = 0.00000, Val Loss = 2.82099
2025-01-18 02:22:43.880360 Epoch 46, Train Y Loss = 2.50234,  Train X Loss = 0.00000, Val Loss = 2.82134
2025-01-18 02:24:00.940291 Epoch 47, Train Y Loss = 2.50185,  Train X Loss = 0.00000, Val Loss = 2.82158
Early stopping at epoch: 47
Best at epoch 17:
Train Loss = 2.78961
Train RMSE = 5.53901, MAE = 2.74210, MAPE = 7.28477
Val Loss = 2.73268
Val RMSE = 5.78147, MAE = 2.78700, MAPE = 7.71492
--------- Test ---------
All Steps RMSE = 6.14260, MAE = 3.00154, MAPE = 8.36960
Step 1 RMSE = 4.02982, MAE = 2.29641, MAPE = 5.67379
Step 2 RMSE = 4.78532, MAE = 2.55304, MAPE = 6.58038
Step 3 RMSE = 5.27775, MAE = 2.71736, MAPE = 7.14614
Step 4 RMSE = 5.63079, MAE = 2.84090, MAPE = 7.67988
Step 5 RMSE = 5.94251, MAE = 2.94672, MAPE = 8.11107
Step 6 RMSE = 6.19442, MAE = 3.03492, MAPE = 8.48308
Step 7 RMSE = 6.42191, MAE = 3.11691, MAPE = 8.88826
Step 8 RMSE = 6.63167, MAE = 3.18856, MAPE = 9.15993
Step 9 RMSE = 6.79492, MAE = 3.25491, MAPE = 9.32850
Step 10 RMSE = 6.91677, MAE = 3.30385, MAPE = 9.55237
Step 11 RMSE = 7.04675, MAE = 3.35250, MAPE = 9.78691
Step 12 RMSE = 7.17690, MAE = 3.41237, MAPE = 10.04514
Inference time: 7.38 s
