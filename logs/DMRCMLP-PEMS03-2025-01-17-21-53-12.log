PEMS03
--------- DMRCMLP ---------
{
    "num_nodes": 358,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0005,
    "milestones": [
        20,
        35,
        50
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 120,
    "early_stop": 20,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": true,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 51970489,
    "gpu": [
        3
    ],
    "save": false,
    "model_args": {
        "num_nodes": 358,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": false,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        434,604
├─Linear: 1-1                                 [16, 12, 358, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 358, 48]         --
│    └─Embedding: 2-1                         [16, 12, 358, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 358, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 358, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 358, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 358, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 358, 144]        158,224
├─Predictor: 1-4                              [16, 12, 358, 1]          --
│    └─Linear: 2-5                            [16, 12, 358, 144]        20,880
│    └─ModuleList: 2-6                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 358, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 358, 144]        41,760
│    └─Linear: 2-7                            [16, 358, 12]             20,748
===============================================================================================
Total params: 1,199,776
Trainable params: 1,199,776
Non-trainable params: 0
Total mult-adds (M): 12.24
===============================================================================================
Input size (MB): 0.82
Forward/backward pass size (MB): 3216.29
Params size (MB): 3.06
Estimated Total Size (MB): 3220.18
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMS03-2025-01-17-21-53-12.pt
2025-01-17 21:55:19.737567 Epoch 1, Train Y Loss = 21.68195,  Train X Loss = 0.00000, Val Loss = 16.49930
2025-01-17 21:57:27.733369 Epoch 2, Train Y Loss = 16.70917,  Train X Loss = 0.00000, Val Loss = 15.77276
2025-01-17 21:59:35.202590 Epoch 3, Train Y Loss = 15.58621,  Train X Loss = 0.00000, Val Loss = 15.03665
2025-01-17 22:01:42.127809 Epoch 4, Train Y Loss = 15.11779,  Train X Loss = 0.00000, Val Loss = 15.27310
2025-01-17 22:03:48.890717 Epoch 5, Train Y Loss = 14.64824,  Train X Loss = 0.00000, Val Loss = 14.56306
2025-01-17 22:05:55.421568 Epoch 6, Train Y Loss = 14.36897,  Train X Loss = 0.00000, Val Loss = 14.18585
2025-01-17 22:08:01.441214 Epoch 7, Train Y Loss = 14.05883,  Train X Loss = 0.00000, Val Loss = 13.95156
2025-01-17 22:10:08.636714 Epoch 8, Train Y Loss = 13.85737,  Train X Loss = 0.00000, Val Loss = 13.88217
2025-01-17 22:12:15.475961 Epoch 9, Train Y Loss = 13.67863,  Train X Loss = 0.00000, Val Loss = 13.72517
2025-01-17 22:14:22.431127 Epoch 10, Train Y Loss = 13.55269,  Train X Loss = 0.00000, Val Loss = 13.57541
2025-01-17 22:16:28.867580 Epoch 11, Train Y Loss = 13.36493,  Train X Loss = 0.00000, Val Loss = 13.62712
2025-01-17 22:18:35.639987 Epoch 12, Train Y Loss = 13.23164,  Train X Loss = 0.00000, Val Loss = 13.52932
2025-01-17 22:20:42.472906 Epoch 13, Train Y Loss = 13.13694,  Train X Loss = 0.00000, Val Loss = 13.65887
2025-01-17 22:22:49.510186 Epoch 14, Train Y Loss = 13.06954,  Train X Loss = 0.00000, Val Loss = 13.43904
2025-01-17 22:24:55.754925 Epoch 15, Train Y Loss = 12.92980,  Train X Loss = 0.00000, Val Loss = 13.43560
2025-01-17 22:27:02.738563 Epoch 16, Train Y Loss = 12.86998,  Train X Loss = 0.00000, Val Loss = 13.43935
2025-01-17 22:29:09.224078 Epoch 17, Train Y Loss = 12.81685,  Train X Loss = 0.00000, Val Loss = 13.44656
2025-01-17 22:31:15.943384 Epoch 18, Train Y Loss = 12.71908,  Train X Loss = 0.00000, Val Loss = 13.38141
2025-01-17 22:33:22.788946 Epoch 19, Train Y Loss = 12.68004,  Train X Loss = 0.00000, Val Loss = 13.44027
2025-01-17 22:35:30.039533 Epoch 20, Train Y Loss = 12.65982,  Train X Loss = 0.00000, Val Loss = 13.21620
2025-01-17 22:37:36.873063 Epoch 21, Train Y Loss = 12.13423,  Train X Loss = 0.00000, Val Loss = 13.07407
2025-01-17 22:39:44.184497 Epoch 22, Train Y Loss = 12.07323,  Train X Loss = 0.00000, Val Loss = 13.12752
2025-01-17 22:41:52.467049 Epoch 23, Train Y Loss = 12.04427,  Train X Loss = 0.00000, Val Loss = 13.09041
2025-01-17 22:43:59.346989 Epoch 24, Train Y Loss = 12.02190,  Train X Loss = 0.00000, Val Loss = 13.10811
2025-01-17 22:46:05.023565 Epoch 25, Train Y Loss = 12.00280,  Train X Loss = 0.00000, Val Loss = 13.08528
2025-01-17 22:48:11.570570 Epoch 26, Train Y Loss = 11.98373,  Train X Loss = 0.00000, Val Loss = 13.15672
2025-01-17 22:50:17.771221 Epoch 27, Train Y Loss = 11.96778,  Train X Loss = 0.00000, Val Loss = 13.12207
2025-01-17 22:52:25.181191 Epoch 28, Train Y Loss = 11.95147,  Train X Loss = 0.00000, Val Loss = 13.11324
2025-01-17 22:54:31.212794 Epoch 29, Train Y Loss = 11.93851,  Train X Loss = 0.00000, Val Loss = 13.11199
Change mask ratio: 0.075
2025-01-17 22:56:36.375025 Epoch 30, Train Y Loss = 11.87738,  Train X Loss = 0.00000, Val Loss = 13.03619
2025-01-17 22:58:41.780321 Epoch 31, Train Y Loss = 11.86412,  Train X Loss = 0.00000, Val Loss = 13.09722
2025-01-17 23:00:46.742934 Epoch 32, Train Y Loss = 11.84825,  Train X Loss = 0.00000, Val Loss = 13.09232
2025-01-17 23:02:51.039787 Epoch 33, Train Y Loss = 11.83640,  Train X Loss = 0.00000, Val Loss = 13.03140
2025-01-17 23:04:55.614132 Epoch 34, Train Y Loss = 11.82401,  Train X Loss = 0.00000, Val Loss = 13.02285
2025-01-17 23:07:00.454868 Epoch 35, Train Y Loss = 11.80969,  Train X Loss = 0.00000, Val Loss = 13.07293
2025-01-17 23:09:05.475826 Epoch 36, Train Y Loss = 11.74492,  Train X Loss = 0.00000, Val Loss = 13.02873
2025-01-17 23:11:10.255629 Epoch 37, Train Y Loss = 11.73612,  Train X Loss = 0.00000, Val Loss = 13.04405
2025-01-17 23:13:14.943541 Epoch 38, Train Y Loss = 11.73228,  Train X Loss = 0.00000, Val Loss = 13.04211
2025-01-17 23:15:19.382345 Epoch 39, Train Y Loss = 11.73010,  Train X Loss = 0.00000, Val Loss = 13.02035
2025-01-17 23:17:24.097675 Epoch 40, Train Y Loss = 11.72839,  Train X Loss = 0.00000, Val Loss = 13.03321
2025-01-17 23:19:29.175707 Epoch 41, Train Y Loss = 11.72622,  Train X Loss = 0.00000, Val Loss = 13.03001
2025-01-17 23:21:34.128016 Epoch 42, Train Y Loss = 11.72421,  Train X Loss = 0.00000, Val Loss = 13.04667
2025-01-17 23:23:39.288360 Epoch 43, Train Y Loss = 11.72143,  Train X Loss = 0.00000, Val Loss = 13.03497
2025-01-17 23:25:43.486439 Epoch 44, Train Y Loss = 11.71892,  Train X Loss = 0.00000, Val Loss = 13.07399
2025-01-17 23:27:48.201409 Epoch 45, Train Y Loss = 11.71832,  Train X Loss = 0.00000, Val Loss = 13.04505
2025-01-17 23:29:53.159716 Epoch 46, Train Y Loss = 11.71580,  Train X Loss = 0.00000, Val Loss = 13.06118
2025-01-17 23:31:57.417677 Epoch 47, Train Y Loss = 11.71383,  Train X Loss = 0.00000, Val Loss = 13.06778
Change mask ratio: 0.0375
2025-01-17 23:34:01.013099 Epoch 48, Train Y Loss = 11.68576,  Train X Loss = 0.00000, Val Loss = 13.00398
2025-01-17 23:36:05.269867 Epoch 49, Train Y Loss = 11.68185,  Train X Loss = 0.00000, Val Loss = 12.99201
2025-01-17 23:38:08.340210 Epoch 50, Train Y Loss = 11.68063,  Train X Loss = 0.00000, Val Loss = 13.01919
2025-01-17 23:40:11.595852 Epoch 51, Train Y Loss = 11.67298,  Train X Loss = 0.00000, Val Loss = 13.00698
2025-01-17 23:42:15.904631 Epoch 52, Train Y Loss = 11.67165,  Train X Loss = 0.00000, Val Loss = 13.00069
2025-01-17 23:44:19.808089 Epoch 53, Train Y Loss = 11.67106,  Train X Loss = 0.00000, Val Loss = 13.00320
2025-01-17 23:46:24.038248 Epoch 54, Train Y Loss = 11.67082,  Train X Loss = 0.00000, Val Loss = 13.00318
2025-01-17 23:48:27.528130 Epoch 55, Train Y Loss = 11.67078,  Train X Loss = 0.00000, Val Loss = 12.99909
2025-01-17 23:50:30.837336 Epoch 56, Train Y Loss = 11.66985,  Train X Loss = 0.00000, Val Loss = 13.00354
2025-01-17 23:52:34.637168 Epoch 57, Train Y Loss = 11.66981,  Train X Loss = 0.00000, Val Loss = 13.00588
Change mask ratio: 0.0
2025-01-17 23:54:23.095962 Epoch 58, Train Y Loss = 11.64845,  Train X Loss = 0.00000, Val Loss = 12.96549
2025-01-17 23:56:12.425362 Epoch 59, Train Y Loss = 11.64663,  Train X Loss = 0.00000, Val Loss = 12.96496
2025-01-17 23:58:01.896992 Epoch 60, Train Y Loss = 11.64571,  Train X Loss = 0.00000, Val Loss = 12.96154
2025-01-17 23:59:51.622251 Epoch 61, Train Y Loss = 11.64476,  Train X Loss = 0.00000, Val Loss = 12.96311
2025-01-18 00:01:41.047301 Epoch 62, Train Y Loss = 11.64373,  Train X Loss = 0.00000, Val Loss = 12.95500
2025-01-18 00:03:30.572947 Epoch 63, Train Y Loss = 11.64434,  Train X Loss = 0.00000, Val Loss = 12.96630
2025-01-18 00:05:22.603003 Epoch 64, Train Y Loss = 11.64325,  Train X Loss = 0.00000, Val Loss = 12.96577
2025-01-18 00:07:12.944154 Epoch 65, Train Y Loss = 11.64301,  Train X Loss = 0.00000, Val Loss = 12.96105
2025-01-18 00:09:02.465714 Epoch 66, Train Y Loss = 11.64207,  Train X Loss = 0.00000, Val Loss = 12.96469
2025-01-18 00:10:51.767196 Epoch 67, Train Y Loss = 11.64254,  Train X Loss = 0.00000, Val Loss = 12.96329
2025-01-18 00:12:40.859172 Epoch 68, Train Y Loss = 11.64202,  Train X Loss = 0.00000, Val Loss = 12.96573
2025-01-18 00:14:29.735716 Epoch 69, Train Y Loss = 11.64191,  Train X Loss = 0.00000, Val Loss = 12.96309
2025-01-18 00:16:18.863496 Epoch 70, Train Y Loss = 11.64184,  Train X Loss = 0.00000, Val Loss = 12.97161
Change mask ratio: 0.0
2025-01-18 00:18:07.684892 Epoch 71, Train Y Loss = 11.64134,  Train X Loss = 0.00000, Val Loss = 12.95984
2025-01-18 00:19:56.525261 Epoch 72, Train Y Loss = 11.64074,  Train X Loss = 0.00000, Val Loss = 12.96347
2025-01-18 00:21:45.465355 Epoch 73, Train Y Loss = 11.63979,  Train X Loss = 0.00000, Val Loss = 12.96326
2025-01-18 00:23:34.568705 Epoch 74, Train Y Loss = 11.64031,  Train X Loss = 0.00000, Val Loss = 12.96222
2025-01-18 00:25:23.608676 Epoch 75, Train Y Loss = 11.64022,  Train X Loss = 0.00000, Val Loss = 12.96075
2025-01-18 00:27:12.505663 Epoch 76, Train Y Loss = 11.64022,  Train X Loss = 0.00000, Val Loss = 12.96236
2025-01-18 00:29:01.427818 Epoch 77, Train Y Loss = 11.63975,  Train X Loss = 0.00000, Val Loss = 12.96713
2025-01-18 00:30:50.263831 Epoch 78, Train Y Loss = 11.63954,  Train X Loss = 0.00000, Val Loss = 12.96113
Change mask ratio: 0.0
2025-01-18 00:32:39.153388 Epoch 79, Train Y Loss = 11.63822,  Train X Loss = 0.00000, Val Loss = 12.96256
2025-01-18 00:34:28.380384 Epoch 80, Train Y Loss = 11.63848,  Train X Loss = 0.00000, Val Loss = 12.96442
2025-01-18 00:36:17.565371 Epoch 81, Train Y Loss = 11.63857,  Train X Loss = 0.00000, Val Loss = 12.96669
2025-01-18 00:38:06.810647 Epoch 82, Train Y Loss = 11.63792,  Train X Loss = 0.00000, Val Loss = 12.96626
Early stopping at epoch: 82
Best at epoch 62:
Train Loss = 11.64373
Train RMSE = 19.99709, MAE = 12.04110, MAPE = 11.12057
Val Loss = 12.95500
Val RMSE = 21.91982, MAE = 13.47517, MAPE = 12.66586
--------- Test ---------
All Steps RMSE = 26.60934, MAE = 15.30679, MAPE = 15.24936
Step 1 RMSE = 20.22511, MAE = 12.59925, MAPE = 13.08272
Step 2 RMSE = 22.36975, MAE = 13.39479, MAPE = 13.81215
Step 3 RMSE = 24.00303, MAE = 14.04312, MAPE = 14.31350
Step 4 RMSE = 25.31056, MAE = 14.57610, MAPE = 14.67088
Step 5 RMSE = 26.24084, MAE = 15.00471, MAPE = 14.97563
Step 6 RMSE = 26.95816, MAE = 15.37669, MAPE = 15.25873
Step 7 RMSE = 27.57282, MAE = 15.71902, MAPE = 15.52756
Step 8 RMSE = 28.08556, MAE = 16.03256, MAPE = 15.79160
Step 9 RMSE = 28.55194, MAE = 16.32227, MAPE = 16.02972
Step 10 RMSE = 28.97078, MAE = 16.59782, MAPE = 16.26766
Step 11 RMSE = 29.38267, MAE = 16.86883, MAPE = 16.50805
Step 12 RMSE = 29.80262, MAE = 17.14634, MAPE = 16.75412
Inference time: 11.38 s
