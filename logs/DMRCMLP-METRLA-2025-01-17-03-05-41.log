METRLA
--------- DMRCMLP ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0003,
    "milestones": [
        25,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "cl_step_size": 2500,
    "adaptive_mask": false,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 51970489,
    "gpu": [
        0
    ],
    "save": false,
    "model_args": {
        "num_nodes": 207,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        283,260
├─Linear: 1-1                                 [16, 12, 207, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 207, 48]         --
│    └─Embedding: 2-1                         [16, 12, 207, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 207, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 207, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 207, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 207, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 207, 144]        158,224
├─Predictor: 1-4                              [16, 12, 207, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 207, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 207, 144]        41,760
│    └─Linear: 2-6                            [16, 207, 12]             20,748
===============================================================================================
Total params: 1,027,552
Trainable params: 1,027,552
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.48
Forward/backward pass size (MB): 1813.92
Params size (MB): 2.98
Estimated Total Size (MB): 1817.37
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-METRLA-2025-01-17-03-05-41.pt
2025-01-17 03:07:28.074624 Epoch 1, Train Y Loss = 4.12071,  Train X Loss = 2.64824, Val Loss = 3.32680
2025-01-17 03:09:14.438154 Epoch 2, Train Y Loss = 3.42536,  Train X Loss = 2.26357, Val Loss = 3.13732
2025-01-17 03:10:48.395124 Epoch 3, Train Y Loss = 3.25867,  Train X Loss = 2.22089, Val Loss = 2.95512
2025-01-17 03:12:35.304927 Epoch 4, Train Y Loss = 3.14872,  Train X Loss = 2.19202, Val Loss = 2.93973
2025-01-17 03:14:22.322146 Epoch 5, Train Y Loss = 3.09162,  Train X Loss = 2.09331, Val Loss = 2.93160
2025-01-17 03:15:56.366442 Epoch 6, Train Y Loss = 3.03759,  Train X Loss = 2.00015, Val Loss = 2.86441
2025-01-17 03:17:43.059667 Epoch 7, Train Y Loss = 2.99537,  Train X Loss = 1.96704, Val Loss = 2.81179
2025-01-17 03:19:29.845694 Epoch 8, Train Y Loss = 2.96779,  Train X Loss = 1.94884, Val Loss = 2.82639
2025-01-17 03:21:04.842054 Epoch 9, Train Y Loss = 2.94415,  Train X Loss = 1.93522, Val Loss = 2.80348
2025-01-17 03:22:50.597769 Epoch 10, Train Y Loss = 2.92599,  Train X Loss = 1.92232, Val Loss = 2.77010
2025-01-17 03:24:23.546323 Epoch 11, Train Y Loss = 2.91196,  Train X Loss = 1.91533, Val Loss = 2.78295
2025-01-17 03:26:09.308698 Epoch 12, Train Y Loss = 2.89736,  Train X Loss = 1.90844, Val Loss = 2.74618
2025-01-17 03:27:42.935180 Epoch 13, Train Y Loss = 2.88902,  Train X Loss = 1.90416, Val Loss = 2.75772
2025-01-17 03:29:28.808867 Epoch 14, Train Y Loss = 2.87953,  Train X Loss = 1.89597, Val Loss = 2.73823
2025-01-17 03:31:15.157822 Epoch 15, Train Y Loss = 2.87220,  Train X Loss = 1.89311, Val Loss = 2.76560
2025-01-17 03:32:52.384663 Epoch 16, Train Y Loss = 2.86620,  Train X Loss = 1.88860, Val Loss = 2.72082
2025-01-17 03:34:34.744766 Epoch 17, Train Y Loss = 2.85988,  Train X Loss = 1.88446, Val Loss = 2.75556
2025-01-17 03:36:21.005562 Epoch 18, Train Y Loss = 2.85142,  Train X Loss = 1.87770, Val Loss = 2.73668
2025-01-17 03:38:03.497922 Epoch 19, Train Y Loss = 2.84835,  Train X Loss = 1.87718, Val Loss = 2.73276
2025-01-17 03:39:41.039792 Epoch 20, Train Y Loss = 2.84147,  Train X Loss = 1.87290, Val Loss = 2.72371
2025-01-17 03:41:26.642178 Epoch 21, Train Y Loss = 2.83759,  Train X Loss = 1.87073, Val Loss = 2.73554
2025-01-17 03:43:11.280847 Epoch 22, Train Y Loss = 2.83190,  Train X Loss = 1.86477, Val Loss = 2.73649
2025-01-17 03:44:46.680184 Epoch 23, Train Y Loss = 2.82695,  Train X Loss = 1.86472, Val Loss = 2.75946
2025-01-17 03:46:32.575784 Epoch 24, Train Y Loss = 2.82633,  Train X Loss = 1.86241, Val Loss = 2.73322
2025-01-17 03:48:18.585459 Epoch 25, Train Y Loss = 2.82372,  Train X Loss = 1.86144, Val Loss = 2.72612
2025-01-17 03:49:50.990575 Epoch 26, Train Y Loss = 2.74481,  Train X Loss = 1.82302, Val Loss = 2.66347
2025-01-17 03:51:24.469403 Epoch 27, Train Y Loss = 2.73179,  Train X Loss = 1.81758, Val Loss = 2.67428
2025-01-17 03:53:10.653442 Epoch 28, Train Y Loss = 2.72641,  Train X Loss = 1.81690, Val Loss = 2.66940
2025-01-17 03:54:57.226109 Epoch 29, Train Y Loss = 2.72226,  Train X Loss = 1.81475, Val Loss = 2.65847
2025-01-17 03:56:33.654913 Epoch 30, Train Y Loss = 2.71867,  Train X Loss = 1.81301, Val Loss = 2.66790
2025-01-17 03:58:16.860503 Epoch 31, Train Y Loss = 2.71542,  Train X Loss = 1.81108, Val Loss = 2.67129
2025-01-17 04:00:02.551133 Epoch 32, Train Y Loss = 2.71408,  Train X Loss = 1.80928, Val Loss = 2.67200
2025-01-17 04:01:42.254125 Epoch 33, Train Y Loss = 2.71093,  Train X Loss = 1.81040, Val Loss = 2.66963
2025-01-17 04:03:21.775991 Epoch 34, Train Y Loss = 2.70952,  Train X Loss = 1.81012, Val Loss = 2.66625
2025-01-17 04:05:08.130169 Epoch 35, Train Y Loss = 2.70641,  Train X Loss = 1.80787, Val Loss = 2.66216
2025-01-17 04:06:52.619430 Epoch 36, Train Y Loss = 2.69403,  Train X Loss = 1.80411, Val Loss = 2.66088
2025-01-17 04:08:27.629283 Epoch 37, Train Y Loss = 2.69299,  Train X Loss = 1.80424, Val Loss = 2.66026
2025-01-17 04:10:14.357021 Epoch 38, Train Y Loss = 2.69124,  Train X Loss = 1.80385, Val Loss = 2.65917
2025-01-17 04:11:59.989842 Epoch 39, Train Y Loss = 2.69239,  Train X Loss = 1.80288, Val Loss = 2.65938
2025-01-17 04:13:33.144338 Epoch 40, Train Y Loss = 2.69107,  Train X Loss = 1.80097, Val Loss = 2.66397
2025-01-17 04:15:18.760887 Epoch 41, Train Y Loss = 2.69094,  Train X Loss = 1.80362, Val Loss = 2.66029
2025-01-17 04:16:51.713989 Epoch 42, Train Y Loss = 2.69078,  Train X Loss = 1.80560, Val Loss = 2.65921
2025-01-17 04:18:37.403834 Epoch 43, Train Y Loss = 2.68948,  Train X Loss = 1.80220, Val Loss = 2.66183
2025-01-17 04:20:11.662892 Epoch 44, Train Y Loss = 2.68991,  Train X Loss = 1.80132, Val Loss = 2.66190
2025-01-17 04:21:57.224953 Epoch 45, Train Y Loss = 2.69046,  Train X Loss = 1.80220, Val Loss = 2.65925
2025-01-17 04:23:43.415428 Epoch 46, Train Y Loss = 2.68902,  Train X Loss = 1.80219, Val Loss = 2.66019
2025-01-17 04:25:21.286318 Epoch 47, Train Y Loss = 2.68872,  Train X Loss = 1.80209, Val Loss = 2.66105
2025-01-17 04:27:03.003010 Epoch 48, Train Y Loss = 2.68941,  Train X Loss = 1.80343, Val Loss = 2.66070
2025-01-17 04:28:48.850039 Epoch 49, Train Y Loss = 2.68744,  Train X Loss = 1.80249, Val Loss = 2.66043
2025-01-17 04:30:30.446336 Epoch 50, Train Y Loss = 2.68894,  Train X Loss = 1.80218, Val Loss = 2.66248
2025-01-17 04:32:09.052951 Epoch 51, Train Y Loss = 2.68717,  Train X Loss = 1.80065, Val Loss = 2.66255
2025-01-17 04:33:55.586515 Epoch 52, Train Y Loss = 2.68747,  Train X Loss = 1.80191, Val Loss = 2.66020
2025-01-17 04:35:39.896114 Epoch 53, Train Y Loss = 2.68710,  Train X Loss = 1.80344, Val Loss = 2.66053
2025-01-17 04:37:15.145238 Epoch 54, Train Y Loss = 2.68684,  Train X Loss = 1.80277, Val Loss = 2.66067
2025-01-17 04:39:01.376914 Epoch 55, Train Y Loss = 2.68582,  Train X Loss = 1.80063, Val Loss = 2.66217
2025-01-17 04:40:47.143187 Epoch 56, Train Y Loss = 2.68546,  Train X Loss = 1.80177, Val Loss = 2.66173
2025-01-17 04:42:20.067687 Epoch 57, Train Y Loss = 2.68549,  Train X Loss = 1.80446, Val Loss = 2.66030
2025-01-17 04:43:53.935700 Epoch 58, Train Y Loss = 2.68572,  Train X Loss = 1.80255, Val Loss = 2.65836
2025-01-17 04:45:40.216516 Epoch 59, Train Y Loss = 2.68490,  Train X Loss = 1.80281, Val Loss = 2.66058
2025-01-17 04:47:26.458900 Epoch 60, Train Y Loss = 2.68457,  Train X Loss = 1.80340, Val Loss = 2.66174
2025-01-17 04:49:00.259926 Epoch 61, Train Y Loss = 2.68390,  Train X Loss = 1.80210, Val Loss = 2.66237
2025-01-17 04:50:46.662337 Epoch 62, Train Y Loss = 2.68345,  Train X Loss = 1.80319, Val Loss = 2.66360
2025-01-17 04:52:32.777947 Epoch 63, Train Y Loss = 2.68454,  Train X Loss = 1.80082, Val Loss = 2.65944
2025-01-17 04:54:08.481177 Epoch 64, Train Y Loss = 2.68301,  Train X Loss = 1.80056, Val Loss = 2.66098
2025-01-17 04:55:52.804647 Epoch 65, Train Y Loss = 2.68352,  Train X Loss = 1.80126, Val Loss = 2.65971
2025-01-17 04:57:38.645557 Epoch 66, Train Y Loss = 2.68327,  Train X Loss = 1.80165, Val Loss = 2.66019
2025-01-17 04:59:18.245555 Epoch 67, Train Y Loss = 2.68229,  Train X Loss = 1.80137, Val Loss = 2.66192
2025-01-17 05:00:57.791767 Epoch 68, Train Y Loss = 2.68189,  Train X Loss = 1.79923, Val Loss = 2.66224
2025-01-17 05:02:43.626591 Epoch 69, Train Y Loss = 2.68185,  Train X Loss = 1.80080, Val Loss = 2.66137
2025-01-17 05:04:26.442191 Epoch 70, Train Y Loss = 2.68108,  Train X Loss = 1.79999, Val Loss = 2.66163
2025-01-17 05:06:04.126621 Epoch 71, Train Y Loss = 2.68103,  Train X Loss = 1.80112, Val Loss = 2.66073
2025-01-17 05:07:49.799730 Epoch 72, Train Y Loss = 2.68043,  Train X Loss = 1.80038, Val Loss = 2.66138
2025-01-17 05:09:22.807138 Epoch 73, Train Y Loss = 2.67968,  Train X Loss = 1.79992, Val Loss = 2.66321
2025-01-17 05:11:05.508875 Epoch 74, Train Y Loss = 2.67959,  Train X Loss = 1.79972, Val Loss = 2.66211
2025-01-17 05:12:42.826479 Epoch 75, Train Y Loss = 2.67963,  Train X Loss = 1.79986, Val Loss = 2.66586
2025-01-17 05:14:28.680807 Epoch 76, Train Y Loss = 2.67844,  Train X Loss = 1.80178, Val Loss = 2.66307
2025-01-17 05:16:14.821753 Epoch 77, Train Y Loss = 2.67895,  Train X Loss = 1.79960, Val Loss = 2.66330
2025-01-17 05:17:48.042680 Epoch 78, Train Y Loss = 2.67852,  Train X Loss = 1.80006, Val Loss = 2.66364
2025-01-17 05:19:33.465958 Epoch 79, Train Y Loss = 2.67742,  Train X Loss = 1.79969, Val Loss = 2.66152
2025-01-17 05:21:19.243682 Epoch 80, Train Y Loss = 2.67785,  Train X Loss = 1.79872, Val Loss = 2.66614
2025-01-17 05:22:53.315216 Epoch 81, Train Y Loss = 2.67798,  Train X Loss = 1.79865, Val Loss = 2.66208
2025-01-17 05:24:39.178995 Epoch 82, Train Y Loss = 2.67739,  Train X Loss = 1.79937, Val Loss = 2.66342
2025-01-17 05:26:25.285445 Epoch 83, Train Y Loss = 2.67722,  Train X Loss = 1.79863, Val Loss = 2.66235
2025-01-17 05:28:02.806280 Epoch 84, Train Y Loss = 2.67699,  Train X Loss = 1.79965, Val Loss = 2.66155
2025-01-17 05:29:45.227254 Epoch 85, Train Y Loss = 2.67565,  Train X Loss = 1.79964, Val Loss = 2.66019
2025-01-17 05:31:32.073418 Epoch 86, Train Y Loss = 2.67574,  Train X Loss = 1.80067, Val Loss = 2.66397
2025-01-17 05:33:13.525546 Epoch 87, Train Y Loss = 2.67485,  Train X Loss = 1.79797, Val Loss = 2.66336
2025-01-17 05:34:51.183190 Epoch 88, Train Y Loss = 2.67508,  Train X Loss = 1.79842, Val Loss = 2.66324
Early stopping at epoch: 88
Best at epoch 58:
Train Loss = 2.68572
Train RMSE = 5.28988, MAE = 2.63527, MAPE = 6.89992
Val Loss = 2.65836
Val RMSE = 5.59925, MAE = 2.70917, MAPE = 7.39345
--------- Test ---------
All Steps RMSE = 5.90589, MAE = 2.90255, MAPE = 7.90903
Step 1 RMSE = 3.70227, MAE = 2.14160, MAPE = 5.02132
Step 2 RMSE = 4.49099, MAE = 2.43677, MAPE = 6.02742
Step 3 RMSE = 4.99574, MAE = 2.61587, MAPE = 6.69931
Step 4 RMSE = 5.37950, MAE = 2.74869, MAPE = 7.22711
Step 5 RMSE = 5.69197, MAE = 2.85710, MAPE = 7.68181
Step 6 RMSE = 5.96212, MAE = 2.94736, MAPE = 8.05366
Step 7 RMSE = 6.19382, MAE = 3.02586, MAPE = 8.38274
Step 8 RMSE = 6.38886, MAE = 3.09519, MAPE = 8.67751
Step 9 RMSE = 6.56219, MAE = 3.15996, MAPE = 8.94591
Step 10 RMSE = 6.71541, MAE = 3.21678, MAPE = 9.18291
Step 11 RMSE = 6.84677, MAE = 3.26646, MAPE = 9.39938
Step 12 RMSE = 6.97287, MAE = 3.31898, MAPE = 9.60963
Inference time: 7.59 s
