PEMSBAY
--------- DMRCMLP ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        15,
        35
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 16,
    "max_epochs": 100,
    "early_stop": 30,
    "use_cl": false,
    "adaptive_mask": false,
    "change_mask_ratio": 8,
    "ratio_decay": 0.5,
    "ratio_threshold": 0.02,
    "seed": 51970489,
    "gpu": [
        6
    ],
    "save": false,
    "model_args": {
        "num_nodes": 325,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 24,
        "temporal_embedding_dim": 48,
        "spatial_embedding_dim": 0,
        "adaptive_embedding_dim": 72,
        "add_norm": false,
        "mask_ratio": 0.15,
        "use_recon": true,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_shared_layers": 2,
        "num_branch_layers": 2,
        "dropout": 0.1
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
DMRCMLP                                       --                        385,212
├─Linear: 1-1                                 [16, 12, 325, 24]         48
├─TimeEmbedding: 1-2                          [16, 12, 325, 48]         --
│    └─Embedding: 2-1                         [16, 12, 325, 24]         6,912
│    └─Embedding: 2-2                         [16, 12, 325, 24]         168
├─ModuleList: 1-3                             --                        --
│    └─STAttnBlock: 2-3                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-1           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-2           [16, 12, 325, 144]        158,224
│    └─STAttnBlock: 2-4                       [16, 12, 325, 144]        --
│    │    └─SelfAttentionLayer: 3-3           [16, 12, 325, 144]        158,224
│    │    └─SelfAttentionLayer: 3-4           [16, 12, 325, 144]        158,224
├─Predictor: 1-4                              [16, 12, 325, 1]          --
│    └─ModuleList: 2-5                        --                        --
│    │    └─MultiLayerPerceptron: 3-5         [16, 12, 325, 144]        41,760
│    │    └─MultiLayerPerceptron: 3-6         [16, 12, 325, 144]        41,760
│    └─Linear: 2-6                            [16, 325, 12]             20,748
===============================================================================================
Total params: 1,129,504
Trainable params: 1,129,504
Non-trainable params: 0
Total mult-adds (M): 11.91
===============================================================================================
Input size (MB): 0.75
Forward/backward pass size (MB): 2847.94
Params size (MB): 2.98
Estimated Total Size (MB): 2851.66
===============================================================================================
Loss: LossFusion
Saved Model: saved_models/DMRCMLP-PEMSBAY-2025-01-19-20-21-10.pt
2025-01-19 20:24:46.259293 Epoch 1, Train Y Loss = 2.06203,  Train X Loss = 1.01912, Val Loss = 2.01662
2025-01-19 20:28:22.268916 Epoch 2, Train Y Loss = 1.72616,  Train X Loss = 0.81075, Val Loss = 1.82184
2025-01-19 20:31:59.057565 Epoch 3, Train Y Loss = 1.62841,  Train X Loss = 0.78185, Val Loss = 1.84281
2025-01-19 20:35:35.437313 Epoch 4, Train Y Loss = 1.59221,  Train X Loss = 0.75766, Val Loss = 1.73779
2025-01-19 20:39:11.900957 Epoch 5, Train Y Loss = 1.56004,  Train X Loss = 0.69904, Val Loss = 1.81973
2025-01-19 20:42:48.068898 Epoch 6, Train Y Loss = 1.53324,  Train X Loss = 0.67567, Val Loss = 1.71871
2025-01-19 20:46:24.133523 Epoch 7, Train Y Loss = 1.51546,  Train X Loss = 0.66437, Val Loss = 1.64168
2025-01-19 20:50:00.567940 Epoch 8, Train Y Loss = 1.50076,  Train X Loss = 0.65697, Val Loss = 1.62794
2025-01-19 20:53:37.047535 Epoch 9, Train Y Loss = 1.49286,  Train X Loss = 0.65321, Val Loss = 1.65676
2025-01-19 20:57:13.237896 Epoch 10, Train Y Loss = 1.48348,  Train X Loss = 0.64844, Val Loss = 1.61845
2025-01-19 21:00:49.681888 Epoch 11, Train Y Loss = 1.47460,  Train X Loss = 0.64570, Val Loss = 1.61139
2025-01-19 21:04:26.456471 Epoch 12, Train Y Loss = 1.46916,  Train X Loss = 0.64341, Val Loss = 1.59629
2025-01-19 21:08:03.100999 Epoch 13, Train Y Loss = 1.46368,  Train X Loss = 0.64171, Val Loss = 1.62309
2025-01-19 21:11:39.411951 Epoch 14, Train Y Loss = 1.45925,  Train X Loss = 0.64089, Val Loss = 1.59654
2025-01-19 21:15:15.685111 Epoch 15, Train Y Loss = 1.45477,  Train X Loss = 0.63872, Val Loss = 1.59273
2025-01-19 21:18:52.047738 Epoch 16, Train Y Loss = 1.40381,  Train X Loss = 0.62010, Val Loss = 1.54246
2025-01-19 21:22:28.076113 Epoch 17, Train Y Loss = 1.39458,  Train X Loss = 0.61764, Val Loss = 1.54338
2025-01-19 21:26:04.219598 Epoch 18, Train Y Loss = 1.39154,  Train X Loss = 0.61704, Val Loss = 1.53853
2025-01-19 21:29:41.095794 Epoch 19, Train Y Loss = 1.38710,  Train X Loss = 0.61589, Val Loss = 1.53468
2025-01-19 21:33:18.721530 Epoch 20, Train Y Loss = 1.38424,  Train X Loss = 0.61549, Val Loss = 1.53171
2025-01-19 21:36:55.550601 Epoch 21, Train Y Loss = 1.38239,  Train X Loss = 0.61548, Val Loss = 1.53430
2025-01-19 21:40:32.504103 Epoch 22, Train Y Loss = 1.38012,  Train X Loss = 0.61473, Val Loss = 1.53326
2025-01-19 21:44:09.692372 Epoch 23, Train Y Loss = 1.37865,  Train X Loss = 0.61461, Val Loss = 1.53809
2025-01-19 21:47:46.541733 Epoch 24, Train Y Loss = 1.37617,  Train X Loss = 0.61437, Val Loss = 1.53085
2025-01-19 21:51:23.425049 Epoch 25, Train Y Loss = 1.37411,  Train X Loss = 0.61413, Val Loss = 1.53533
2025-01-19 21:55:00.013591 Epoch 26, Train Y Loss = 1.37240,  Train X Loss = 0.61398, Val Loss = 1.53257
2025-01-19 21:58:37.201556 Epoch 27, Train Y Loss = 1.37073,  Train X Loss = 0.61367, Val Loss = 1.52980
2025-01-19 22:02:14.519705 Epoch 28, Train Y Loss = 1.36948,  Train X Loss = 0.61347, Val Loss = 1.53146
2025-01-19 22:05:50.722145 Epoch 29, Train Y Loss = 1.36772,  Train X Loss = 0.61337, Val Loss = 1.53308
2025-01-19 22:09:27.697037 Epoch 30, Train Y Loss = 1.36627,  Train X Loss = 0.61284, Val Loss = 1.53207
2025-01-19 22:13:03.875398 Epoch 31, Train Y Loss = 1.36429,  Train X Loss = 0.61247, Val Loss = 1.52837
2025-01-19 22:16:41.606968 Epoch 32, Train Y Loss = 1.36353,  Train X Loss = 0.61253, Val Loss = 1.52898
2025-01-19 22:20:19.190224 Epoch 33, Train Y Loss = 1.36203,  Train X Loss = 0.61274, Val Loss = 1.54192
2025-01-19 22:23:57.146793 Epoch 34, Train Y Loss = 1.36118,  Train X Loss = 0.61221, Val Loss = 1.53188
2025-01-19 22:27:34.364483 Epoch 35, Train Y Loss = 1.36027,  Train X Loss = 0.61188, Val Loss = 1.53135
2025-01-19 22:31:11.510217 Epoch 36, Train Y Loss = 1.35034,  Train X Loss = 0.61006, Val Loss = 1.52379
2025-01-19 22:34:48.763903 Epoch 37, Train Y Loss = 1.34995,  Train X Loss = 0.61013, Val Loss = 1.52145
2025-01-19 22:38:25.772529 Epoch 38, Train Y Loss = 1.34845,  Train X Loss = 0.60982, Val Loss = 1.52153
2025-01-19 22:42:02.663112 Epoch 39, Train Y Loss = 1.34775,  Train X Loss = 0.60950, Val Loss = 1.52432
2025-01-19 22:45:41.138557 Epoch 40, Train Y Loss = 1.34842,  Train X Loss = 0.61014, Val Loss = 1.52625
2025-01-19 22:49:20.967304 Epoch 41, Train Y Loss = 1.34845,  Train X Loss = 0.60978, Val Loss = 1.52464
2025-01-19 22:52:59.887779 Epoch 42, Train Y Loss = 1.34743,  Train X Loss = 0.61019, Val Loss = 1.52553
2025-01-19 22:56:37.968637 Epoch 43, Train Y Loss = 1.34702,  Train X Loss = 0.61005, Val Loss = 1.52416
2025-01-19 23:00:14.878693 Epoch 44, Train Y Loss = 1.34683,  Train X Loss = 0.60992, Val Loss = 1.52506
2025-01-19 23:03:52.089820 Epoch 45, Train Y Loss = 1.34643,  Train X Loss = 0.60978, Val Loss = 1.52443
2025-01-19 23:07:30.605266 Epoch 46, Train Y Loss = 1.34653,  Train X Loss = 0.61005, Val Loss = 1.52927
2025-01-19 23:11:08.676873 Epoch 47, Train Y Loss = 1.34676,  Train X Loss = 0.60976, Val Loss = 1.52714
2025-01-19 23:14:45.861496 Epoch 48, Train Y Loss = 1.34547,  Train X Loss = 0.60976, Val Loss = 1.52654
2025-01-19 23:18:22.036637 Epoch 49, Train Y Loss = 1.34544,  Train X Loss = 0.60993, Val Loss = 1.52772
2025-01-19 23:21:58.934702 Epoch 50, Train Y Loss = 1.34511,  Train X Loss = 0.60934, Val Loss = 1.52461
2025-01-19 23:25:35.733385 Epoch 51, Train Y Loss = 1.34504,  Train X Loss = 0.60994, Val Loss = 1.52841
2025-01-19 23:29:12.974711 Epoch 52, Train Y Loss = 1.34454,  Train X Loss = 0.60942, Val Loss = 1.52467
2025-01-19 23:32:50.436889 Epoch 53, Train Y Loss = 1.34549,  Train X Loss = 0.60943, Val Loss = 1.52685
2025-01-19 23:36:27.404849 Epoch 54, Train Y Loss = 1.34444,  Train X Loss = 0.60947, Val Loss = 1.52983
2025-01-19 23:40:04.259043 Epoch 55, Train Y Loss = 1.34507,  Train X Loss = 0.60941, Val Loss = 1.52676
2025-01-19 23:43:40.956289 Epoch 56, Train Y Loss = 1.34473,  Train X Loss = 0.60961, Val Loss = 1.52621
2025-01-19 23:47:18.295662 Epoch 57, Train Y Loss = 1.34369,  Train X Loss = 0.60943, Val Loss = 1.52830
2025-01-19 23:50:56.447694 Epoch 58, Train Y Loss = 1.34390,  Train X Loss = 0.60954, Val Loss = 1.52784
2025-01-19 23:54:36.420348 Epoch 59, Train Y Loss = 1.34383,  Train X Loss = 0.60952, Val Loss = 1.52684
2025-01-19 23:58:14.759964 Epoch 60, Train Y Loss = 1.34327,  Train X Loss = 0.60970, Val Loss = 1.52769
2025-01-20 00:01:53.998162 Epoch 61, Train Y Loss = 1.34396,  Train X Loss = 0.60929, Val Loss = 1.52773
2025-01-20 00:05:33.659994 Epoch 62, Train Y Loss = 1.34270,  Train X Loss = 0.60907, Val Loss = 1.52655
2025-01-20 00:09:13.687396 Epoch 63, Train Y Loss = 1.34271,  Train X Loss = 0.60927, Val Loss = 1.52734
2025-01-20 00:12:53.315946 Epoch 64, Train Y Loss = 1.34260,  Train X Loss = 0.60908, Val Loss = 1.52788
2025-01-20 00:16:31.892882 Epoch 65, Train Y Loss = 1.34197,  Train X Loss = 0.60921, Val Loss = 1.52729
2025-01-20 00:20:10.654508 Epoch 66, Train Y Loss = 1.34227,  Train X Loss = 0.60901, Val Loss = 1.52680
2025-01-20 00:23:49.127506 Epoch 67, Train Y Loss = 1.34162,  Train X Loss = 0.60917, Val Loss = 1.52831
Early stopping at epoch: 67
Best at epoch 37:
Train Loss = 1.34995
Train RMSE = 2.99601, MAE = 1.32958, MAPE = 2.88751
Val Loss = 1.52145
Val RMSE = 3.51026, MAE = 1.51981, MAPE = 3.48483
--------- Test ---------
All Steps RMSE = 3.50663, MAE = 1.52513, MAPE = 3.47537
Step 1 RMSE = 1.55531, MAE = 0.84534, MAPE = 1.63147
Step 2 RMSE = 2.21486, MAE = 1.11076, MAPE = 2.26106
Step 3 RMSE = 2.70909, MAE = 1.28552, MAPE = 2.72353
Step 4 RMSE = 3.08505, MAE = 1.41246, MAPE = 3.08913
Step 5 RMSE = 3.37018, MAE = 1.50907, MAPE = 3.38211
Step 6 RMSE = 3.59278, MAE = 1.58638, MAPE = 3.62403
Step 7 RMSE = 3.77218, MAE = 1.64847, MAPE = 3.82368
Step 8 RMSE = 3.91503, MAE = 1.69969, MAPE = 3.98631
Step 9 RMSE = 4.03213, MAE = 1.74476, MAPE = 4.12773
Step 10 RMSE = 4.13071, MAE = 1.78386, MAPE = 4.24873
Step 11 RMSE = 4.21621, MAE = 1.81942, MAPE = 4.35323
Step 12 RMSE = 4.29602, MAE = 1.85578, MAPE = 4.45336
Inference time: 18.02 s
